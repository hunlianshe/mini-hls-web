"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
let Cryptos = {};
(function () {
    var base64map = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    var util = Cryptos.util = {
        rotl: function (n, b) {
            return (n << b) | (n >>> (32 - b));
        },
        rotr: function (n, b) {
            return (n << (32 - b)) | (n >>> b);
        },
        endian: function (n) {
            if (n.constructor == Number) {
                return util.rotl(n, 8) & 0x00FF00FF |
                    util.rotl(n, 24) & 0xFF00FF00;
            }
            for (var i = 0; i < n.length; i++)
                n[i] = util.endian(n[i]);
            return n;
        },
        randomBytes: function (n) {
            for (var bytes = []; n > 0; n--)
                bytes.push(Math.floor(Math.random() * 256));
            return bytes;
        },
        stringToBytes: function (str) {
            var bytes = [];
            for (var i = 0; i < str.length; i++)
                bytes.push(str.charCodeAt(i));
            return bytes;
        },
        bytesToString: function (bytes) {
            var str = [];
            for (var i = 0; i < bytes.length; i++)
                str.push(String.fromCharCode(bytes[i]));
            return str.join("");
        },
        stringToWords: function (str) {
            var words = [];
            for (var c = 0, b = 0; c < str.length; c++, b += 8)
                words[b >>> 5] |= str.charCodeAt(c) << (24 - b % 32);
            return words;
        },
        bytesToWords: function (bytes) {
            var words = [];
            for (var i = 0, b = 0; i < bytes.length; i++, b += 8)
                words[b >>> 5] |= bytes[i] << (24 - b % 32);
            return words;
        },
        wordsToBytes: function (words) {
            var bytes = [];
            for (var b = 0; b < words.length * 32; b += 8)
                bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);
            return bytes;
        },
        bytesToHex: function (bytes) {
            var hex = [];
            for (var i = 0; i < bytes.length; i++) {
                hex.push((bytes[i] >>> 4).toString(16));
                hex.push((bytes[i] & 0xF).toString(16));
            }
            return hex.join("");
        },
        hexToBytes: function (hex) {
            var bytes = [];
            for (var c = 0; c < hex.length; c += 2)
                bytes.push(parseInt(hex.substr(c, 2), 16));
            return bytes;
        },
        bytesToBase64: function (bytes) {
            if (typeof btoa == "function")
                return btoa(util.bytesToString(bytes));
            var base64 = [], overflow;
            for (var i = 0; i < bytes.length; i++) {
                switch (i % 3) {
                    case 0:
                        base64.push(base64map.charAt(bytes[i] >>> 2));
                        overflow = (bytes[i] & 0x3) << 4;
                        break;
                    case 1:
                        base64.push(base64map.charAt(overflow | (bytes[i] >>> 4)));
                        overflow = (bytes[i] & 0xF) << 2;
                        break;
                    case 2:
                        base64.push(base64map.charAt(overflow | (bytes[i] >>> 6)));
                        base64.push(base64map.charAt(bytes[i] & 0x3F));
                        overflow = -1;
                }
            }
            if (overflow != undefined && overflow != -1)
                base64.push(base64map.charAt(overflow));
            while (base64.length % 4 != 0)
                base64.push("=");
            return base64.join("");
        },
        base64ToBytes: function (base64) {
            if (typeof atob == "function")
                return util.stringToBytes(atob(base64));
            base64 = base64.replace(/[^A-Z0-9+\/]/ig, "");
            var bytes = [];
            for (var i = 0; i < base64.length; i++) {
                switch (i % 4) {
                    case 1:
                        bytes.push((base64map.indexOf(base64.charAt(i - 1)) << 2) |
                            (base64map.indexOf(base64.charAt(i)) >>> 4));
                        break;
                    case 2:
                        bytes.push(((base64map.indexOf(base64.charAt(i - 1)) & 0xF) << 4) |
                            (base64map.indexOf(base64.charAt(i)) >>> 2));
                        break;
                    case 3:
                        bytes.push(((base64map.indexOf(base64.charAt(i - 1)) & 0x3) << 6) |
                            (base64map.indexOf(base64.charAt(i))));
                        break;
                }
            }
            return bytes;
        }
    };
    Cryptos.mode = {};
})();
var util = Cryptos.util;
Cryptos.HMAC = function (hasher, message, key, options) {
    key = key.length > hasher._blocksize * 4 ?
        hasher(key, { asBytes: true }) :
        util.stringToBytes(key);
    var okey = key, ikey = key.slice(0);
    for (var i = 0; i < hasher._blocksize * 4; i++) {
        okey[i] ^= 0x5C;
        ikey[i] ^= 0x36;
    }
    var hmacbytes = hasher(util.bytesToString(okey) +
        hasher(util.bytesToString(ikey) + message, { asString: true }), { asBytes: true });
    return options && options.asBytes ? hmacbytes :
        options && options.asString ? util.bytesToString(hmacbytes) :
            util.bytesToHex(hmacbytes);
};
var util = Cryptos.util;
var SHA1 = Cryptos.SHA1 = function (message, options) {
    var digestbytes = util.wordsToBytes(SHA1._sha1(message));
    return options && options.asBytes ? digestbytes :
        options && options.asString ? util.bytesToString(digestbytes) :
            util.bytesToHex(digestbytes);
};
SHA1._sha1 = function (message) {
    var m = util.stringToWords(message), l = message.length * 8, w = [], H0 = 1732584193, H1 = -271733879, H2 = -1732584194, H3 = 271733878, H4 = -1009589776;
    m[l >> 5] |= 0x80 << (24 - l % 32);
    m[((l + 64 >>> 9) << 4) + 15] = l;
    for (var i = 0; i < m.length; i += 16) {
        var a = H0, b = H1, c = H2, d = H3, e = H4;
        for (var j = 0; j < 80; j++) {
            if (j < 16)
                w[j] = m[i + j];
            else {
                var n = w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16];
                w[j] = (n << 1) | (n >>> 31);
            }
            var t = ((H0 << 5) | (H0 >>> 27)) + H4 + (w[j] >>> 0) + (j < 20 ? (H1 & H2 | ~H1 & H3) + 1518500249 :
                j < 40 ? (H1 ^ H2 ^ H3) + 1859775393 :
                    j < 60 ? (H1 & H2 | H1 & H3 | H2 & H3) - 1894007588 :
                        (H1 ^ H2 ^ H3) - 899497514);
            H4 = H3;
            H3 = H2;
            H2 = (H1 << 30) | (H1 >>> 2);
            H1 = H0;
            H0 = t;
        }
        H0 += a;
        H1 += b;
        H2 += c;
        H3 += d;
        H4 += e;
    }
    return [H0, H1, H2, H3, H4];
};
SHA1._blocksize = 16;
exports.default = Cryptos;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3J5cHRvLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3J5cHRvLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsSUFBSSxPQUFPLEdBQU8sRUFBRSxDQUFDO0FBRXJCLENBQUM7SUFFQyxJQUFJLFNBQVMsR0FBRyxrRUFBa0UsQ0FBQztJQUluRixJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxHQUFHO1FBR3hCLElBQUksRUFBRSxVQUFVLENBQU0sRUFBRSxDQUFNO1lBQzVCLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNyQyxDQUFDO1FBR0QsSUFBSSxFQUFFLFVBQVUsQ0FBTSxFQUFFLENBQU07WUFDNUIsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3JDLENBQUM7UUFHRCxNQUFNLEVBQUUsVUFBVSxDQUFNO1lBR3RCLElBQUksQ0FBQyxDQUFDLFdBQVcsSUFBSSxNQUFNLEVBQUU7Z0JBQzNCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsVUFBVTtvQkFDakMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEdBQUcsVUFBVSxDQUFDO2FBQ2pDO1lBR0QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFO2dCQUMvQixDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMzQixPQUFPLENBQUMsQ0FBQztRQUVYLENBQUM7UUFHRCxXQUFXLEVBQUUsVUFBVSxDQUFNO1lBQzNC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Y3Rpb24gKCkge1xyXG5cclxuICB2YXIgYmFzZTY0bWFwID0gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvXCI7XHJcblxyXG5cclxuICAvLyBDcnlwdG9zIHV0aWxpdGllc1xyXG4gIHZhciB1dGlsID0gQ3J5cHRvcy51dGlsID0ge1xyXG5cclxuICAgIC8vIEJpdC13aXNlIHJvdGF0ZSBsZWZ0XHJcbiAgICByb3RsOiBmdW5jdGlvbiAobjogYW55LCBiOiBhbnkpIHtcclxuICAgICAgcmV0dXJuIChuIDw8IGIpIHwgKG4gPj4+ICgzMiAtIGIpKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQml0LXdpc2Ugcm90YXRlIHJpZ2h0XHJcbiAgICByb3RyOiBmdW5jdGlvbiAobjogYW55LCBiOiBhbnkpIHtcclxuICAgICAgcmV0dXJuIChuIDw8ICgzMiAtIGIpKSB8IChuID4+PiBiKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gU3dhcCBiaWctZW5kaWFuIHRvIGxpdHRsZS1lbmRpYW4gYW5kIHZpY2UgdmVyc2FcclxuICAgIGVuZGlhbjogZnVuY3Rpb24gKG46IGFueSkge1xyXG5cclxuICAgICAgLy8gSWYgbnVtYmVyIGdpdmVuLCBzd2FwIGVuZGlhblxyXG4gICAgICBpZiAobi5jb25zdHJ1Y3RvciA9PSBOdW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gdXRpbC5yb3RsKG4sIDgpICYgMHgwMEZGMDBGRiB8XHJcbiAgICAgICAgICB1dGlsLnJvdGwobiwgMjQpICYgMHhGRjAwRkYwMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRWxzZSwgYXNzdW1lIGFycmF5IGFuZCBzd2FwIGFsbCBpdGVtc1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG4ubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgbltpXSA9IHV0aWwuZW5kaWFuKG5baV0pO1xyXG4gICAgICByZXR1cm4gbjtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGFuIGFycmF5IG9mIGFueSBsZW5ndGggb2YgcmFuZG9tIGJ5dGVzXHJcbiAgICByYW5kb21CeXRlczogZnVuY3Rpb24gKG46IGFueSkge1xyXG4gICAgICBmb3IgKHZhciBieXRlcyA9IFtdOyBuID4gMDsgbi0tKVxyXG4gICAgICAgIGJ5dGVzLnB1c2goTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjU2KSk7XHJcbiAgICAgIHJldHVybiBieXRlcztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ29udmVydCBhIHN0cmluZyB0byBhIGJ5dGUgYXJyYXlcclxuICAgIHN0cmluZ1RvQnl0ZXM6IGZ1bmN0aW9uIChzdHI6IGFueSkge1xyXG4gICAgICB2YXIgYnl0ZXMgPSBbXTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYnl0ZXMucHVzaChzdHIuY2hhckNvZGVBdChpKSk7XHJcbiAgICAgIHJldHVybiBieXRlcztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ29udmVydCBhIGJ5dGUgYXJyYXkgdG8gYSBzdHJpbmdcclxuICAgIGJ5dGVzVG9TdHJpbmc6IGZ1bmN0aW9uIChieXRlczogYW55KSB7XHJcbiAgICAgIHZhciBzdHIgPSBbXTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkrKylcclxuICAgICAgICBzdHIucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzW2ldKSk7XHJcbiAgICAgIHJldHVybiBzdHIuam9pbihcIlwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ29udmVydCBhIHN0cmluZyB0byBiaWctZW5kaWFuIDMyLWJpdCB3b3Jkc1xyXG4gICAgc3RyaW5nVG9Xb3JkczogZnVuY3Rpb24gKHN0cjogYW55KTogYW55W10ge1xyXG4gICAgICB2YXIgd29yZHM6IGFueVtdID0gW107XHJcbiAgICAgIGZvciAodmFyIGMgPSAwLCBiID0gMDsgYyA8IHN0ci5sZW5ndGg7IGMrKyAsIGIgKz0gOClcclxuICAgICAgICB3b3Jkc1tiID4+PiA1XSB8PSBzdHIuY2hhckNvZGVBdChjKSA8PCAoMjQgLSBiICUgMzIpO1xyXG4gICAgICByZXR1cm4gd29yZHM7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIENvbnZlcnQgYSBieXRlIGFycmF5IHRvIGJpZy1lbmRpYW4gMzItYml0cyB3b3Jkc1xyXG4gICAgYnl0ZXNUb1dvcmRzOiBmdW5jdGlvbiAoYnl0ZXM6IGFueSkge1xyXG4gICAgICB2YXIgd29yZHM6IGFueVtdID0gW107XHJcbiAgICAgIGZvciAodmFyIGkgPSAwLCBiID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSsrICwgYiArPSA4KVxyXG4gICAgICAgIHdvcmRzW2IgPj4+IDVdIHw9IGJ5dGVzW2ldIDw8ICgyNCAtIGIgJSAzMik7XHJcbiAgICAgIHJldHVybiB3b3JkcztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ29udmVydCBiaWctZW5kaWFuIDMyLWJpdCB3b3JkcyB0byBhIGJ5dGUgYXJyYXlcclxuICAgIHdvcmRzVG9CeXRlczogZnVuY3Rpb24gKHdvcmRzOiBhbnkpIHtcclxuICAgICAgdmFyIGJ5dGVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICBmb3IgKHZhciBiID0gMDsgYiA8IHdvcmRzLmxlbmd0aCAqIDMyOyBiICs9IDgpXHJcbiAgICAgICAgYnl0ZXMucHVzaCgod29yZHNbYiA+Pj4gNV0gPj4+ICgyNCAtIGIgJSAzMikpICYgMHhGRik7XHJcbiAgICAgIHJldHVybiBieXRlcztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ29udmVydCBhIGJ5dGUgYXJyYXkgdG8gYSBoZXggc3RyaW5nXHJcbiAgICBieXRlc1RvSGV4OiBmdW5jdGlvbiAoYnl0ZXM6IGFueSkge1xyXG4gICAgICB2YXIgaGV4ID0gW107XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBoZXgucHVzaCgoYnl0ZXNbaV0gPj4+IDQpLnRvU3RyaW5nKDE2KSk7XHJcbiAgICAgICAgaGV4LnB1c2goKGJ5dGVzW2ldICYgMHhGKS50b1N0cmluZygxNikpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBoZXguam9pbihcIlwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gQ29udmVydCBhIGhleCBzdHJpbmcgdG8gYSBieXRlIGFycmF5XHJcbiAgICBoZXhUb0J5dGVzOiBmdW5jdGlvbiAoaGV4OiBhbnkpIHtcclxuICAgICAgdmFyIGJ5dGVzID0gW107XHJcbiAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgaGV4Lmxlbmd0aDsgYyArPSAyKVxyXG4gICAgICAgIGJ5dGVzLnB1c2gocGFyc2VJbnQoaGV4LnN1YnN0cihjLCAyKSwgMTYpKTtcclxuICAgICAgcmV0dXJuIGJ5dGVzO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBDb252ZXJ0IGEgYnl0ZSBhcnJheSB0byBhIGJhc2UtNjQgc3RyaW5nXHJcbiAgICBieXRlc1RvQmFzZTY0OiBmdW5jdGlvbiAoYnl0ZXM6IGFueSkge1xyXG5cclxuICAgICAgLy8gVXNlIGJyb3dzZXItbmF0aXZlIGZ1bmN0aW9uIGlmIGl0IGV4aXN0c1xyXG4gICAgICBpZiAodHlwZW9mIGJ0b2EgPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gYnRvYSh1dGlsLmJ5dGVzVG9TdHJpbmcoYnl0ZXMpKTtcclxuXHJcbiAgICAgIHZhciBiYXNlNjQgPSBbXSxcclxuICAgICAgICBvdmVyZmxvdzogYW55O1xyXG5cclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHN3aXRjaCAoaSAlIDMpIHtcclxuICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgYmFzZTY0LnB1c2goYmFzZTY0bWFwLmNoYXJBdChieXRlc1tpXSA+Pj4gMikpO1xyXG4gICAgICAgICAgICBvdmVyZmxvdyA9IChieXRlc1tpXSAmIDB4MykgPDwgNDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIGJhc2U2NC5wdXNoKGJhc2U2NG1hcC5jaGFyQXQob3ZlcmZsb3cgfCAoYnl0ZXNbaV0gPj4+IDQpKSk7XHJcbiAgICAgICAgICAgIG92ZXJmbG93ID0gKGJ5dGVzW2ldICYgMHhGKSA8PCAyO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgYmFzZTY0LnB1c2goYmFzZTY0bWFwLmNoYXJBdChvdmVyZmxvdyB8IChieXRlc1tpXSA+Pj4gNikpKTtcclxuICAgICAgICAgICAgYmFzZTY0LnB1c2goYmFzZTY0bWFwLmNoYXJBdChieXRlc1tpXSAmIDB4M0YpKTtcclxuICAgICAgICAgICAgb3ZlcmZsb3cgPSAtMTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEVuY29kZSBvdmVyZmxvdyBiaXRzLCBpZiB0aGVyZSBhcmUgYW55XHJcbiAgICAgIGlmIChvdmVyZmxvdyAhPSB1bmRlZmluZWQgJiYgb3ZlcmZsb3cgIT0gLTEpXHJcbiAgICAgICAgYmFzZTY0LnB1c2goYmFzZTY0bWFwLmNoYXJBdChvdmVyZmxvdykpO1xyXG5cclxuICAgICAgLy8gQWRkIHBhZGRpbmdcclxuICAgICAgd2hpbGUgKGJhc2U2NC5sZW5ndGggJSA0ICE9IDApIGJhc2U2NC5wdXNoKFwiPVwiKTtcclxuXHJcbiAgICAgIHJldHVybiBiYXNlNjQuam9pbihcIlwiKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIENvbnZlcnQgYSBiYXNlLTY0IHN0cmluZyB0byBhIGJ5dGUgYXJyYXlcclxuICAgIGJhc2U2NFRvQnl0ZXM6IGZ1bmN0aW9uIChiYXNlNjQ6IGFueSkge1xyXG5cclxuICAgICAgLy8gVXNlIGJyb3dzZXItbmF0aXZlIGZ1bmN0aW9uIGlmIGl0IGV4aXN0c1xyXG4gICAgICBpZiAodHlwZW9mIGF0b2IgPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdXRpbC5zdHJpbmdUb0J5dGVzKGF0b2IoYmFzZTY0KSk7XHJcblxyXG4gICAgICAvLyBSZW1vdmUgbm9uLWJhc2UtNjQgY2hhcmFjdGVyc1xyXG4gICAgICBiYXNlNjQgPSBiYXNlNjQucmVwbGFjZSgvW15BLVowLTkrXFwvXS9pZywgXCJcIik7XHJcblxyXG4gICAgICB2YXIgYnl0ZXMgPSBbXTtcclxuXHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYmFzZTY0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgc3dpdGNoIChpICUgNCkge1xyXG4gICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICBieXRlcy5wdXNoKChiYXNlNjRtYXAuaW5kZXhPZihiYXNlNjQuY2hhckF0KGkgLSAxKSkgPDwgMikgfFxyXG4gICAgICAgICAgICAgIChiYXNlNjRtYXAuaW5kZXhPZihiYXNlNjQuY2hhckF0KGkpKSA+Pj4gNCkpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgYnl0ZXMucHVzaCgoKGJhc2U2NG1hcC5pbmRleE9mKGJhc2U2NC5jaGFyQXQoaSAtIDEpKSAmIDB4RikgPDwgNCkgfFxyXG4gICAgICAgICAgICAgIChiYXNlNjRtYXAuaW5kZXhPZihiYXNlNjQuY2hhckF0KGkpKSA+Pj4gMikpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgYnl0ZXMucHVzaCgoKGJhc2U2NG1hcC5pbmRleE9mKGJhc2U2NC5jaGFyQXQoaSAtIDEpKSAmIDB4MykgPDwgNikgfFxyXG4gICAgICAgICAgICAgIChiYXNlNjRtYXAuaW5kZXhPZihiYXNlNjQuY2hhckF0KGkpKSkpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBieXRlcztcclxuXHJcbiAgICB9XHJcblxyXG4gIH07XHJcblxyXG5cclxuICAvLyBDcnlwdG9zIG1vZGUgbmFtZXNwYWNlXHJcbiAgQ3J5cHRvcy5tb2RlID0ge307XHJcblxyXG59KSgpO1xyXG5cclxuXHJcbi8vIFNob3J0Y3V0XHJcbnZhciB1dGlsID0gQ3J5cHRvcy51dGlsO1xyXG5cclxuQ3J5cHRvcy5ITUFDID0gZnVuY3Rpb24gKGhhc2hlcjogYW55LCBtZXNzYWdlOiBhbnksIGtleTogYW55LCBvcHRpb25zOiBhbnkpIHtcclxuICAvLyBBbGxvdyBhcmJpdHJhcnkgbGVuZ3RoIGtleXNcclxuICBrZXkgPSBrZXkubGVuZ3RoID4gaGFzaGVyLl9ibG9ja3NpemUgKiA0ID9cclxuICAgIGhhc2hlcihrZXksIHsgYXNCeXRlczogdHJ1ZSB9KSA6XHJcbiAgICB1dGlsLnN0cmluZ1RvQnl0ZXMoa2V5KTtcclxuXHJcbiAgLy8gWE9SIGtleXMgd2l0aCBwYWQgY29uc3RhbnRzXHJcbiAgdmFyIG9rZXkgPSBrZXksXHJcbiAgICBpa2V5ID0ga2V5LnNsaWNlKDApO1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgaGFzaGVyLl9ibG9ja3NpemUgKiA0OyBpKyspIHtcclxuICAgIG9rZXlbaV0gXj0gMHg1QztcclxuICAgIGlrZXlbaV0gXj0gMHgzNjtcclxuICB9XHJcblxyXG4gIHZhciBobWFjYnl0ZXMgPSBoYXNoZXIodXRpbC5ieXRlc1RvU3RyaW5nKG9rZXkpICtcclxuICAgIGhhc2hlcih1dGlsLmJ5dGVzVG9TdHJpbmcoaWtleSkgKyBtZXNzYWdlLCB7IGFzU3RyaW5nOiB0cnVlIH0pLFxyXG4gICAgeyBhc0J5dGVzOiB0cnVlIH0pO1xyXG4gIHJldHVybiBvcHRpb25zICYmIG9wdGlvbnMuYXNCeXRlcyA/IGhtYWNieXRlcyA6XHJcbiAgICBvcHRpb25zICYmIG9wdGlvbnMuYXNTdHJpbmcgPyB1dGlsLmJ5dGVzVG9TdHJpbmcoaG1hY2J5dGVzKSA6XHJcbiAgICAgIHV0aWwuYnl0ZXNUb0hleChobWFjYnl0ZXMpO1xyXG5cclxufTtcclxuXHJcbi8vIFNob3J0Y3V0XHJcbnZhciB1dGlsID0gQ3J5cHRvcy51dGlsO1xyXG5cclxuLy8gUHVibGljIEFQSVxyXG52YXIgU0hBMTphbnkgPSBDcnlwdG9zLlNIQTEgPSBmdW5jdGlvbiAobWVzc2FnZTogYW55LCBvcHRpb25zOiBhbnkpIHtcclxuICB2YXIgZGlnZXN0Ynl0ZXM6YW55ID0gdXRpbC53b3Jkc1RvQnl0ZXMoU0hBMS5fc2hhMShtZXNzYWdlKSk7XHJcbiAgcmV0dXJuIG9wdGlvbnMgJiYgb3B0aW9ucy5hc0J5dGVzID8gZGlnZXN0Ynl0ZXMgOlxyXG4gICAgb3B0aW9ucyAmJiBvcHRpb25zLmFzU3RyaW5nID8gdXRpbC5ieXRlc1RvU3RyaW5nKGRpZ2VzdGJ5dGVzKSA6XHJcbiAgICAgIHV0aWwuYnl0ZXNUb0hleChkaWdlc3RieXRlcyk7XHJcbn07XHJcblxyXG4vLyBUaGUgY29yZVxyXG5TSEExLl9zaGExID0gZnVuY3Rpb24gKG1lc3NhZ2U6YW55KSB7XHJcblxyXG4gIHZhciBtID0gdXRpbC5zdHJpbmdUb1dvcmRzKG1lc3NhZ2UpLFxyXG4gICAgbCA9IG1lc3NhZ2UubGVuZ3RoICogOCxcclxuICAgIHcgPSBbXSxcclxuICAgIEgwID0gMTczMjU4NDE5MyxcclxuICAgIEgxID0gLTI3MTczMzg3OSxcclxuICAgIEgyID0gLTE3MzI1ODQxOTQsXHJcbiAgICBIMyA9IDI3MTczMzg3OCxcclxuICAgIEg0ID0gLTEwMDk1ODk3NzY7XHJcblxyXG4gIC8vIFBhZGRpbmdcclxuICBtW2wgPj4gNV0gfD0gMHg4MCA8PCAoMjQgLSBsICUgMzIpO1xyXG4gIG1bKChsICsgNjQgPj4+IDkpIDw8IDQpICsgMTVdID0gbDtcclxuXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBtLmxlbmd0aDsgaSArPSAxNikge1xyXG5cclxuICAgIHZhciBhID0gSDAsXHJcbiAgICAgIGIgPSBIMSxcclxuICAgICAgYyA9IEgyLFxyXG4gICAgICBkID0gSDMsXHJcbiAgICAgIGUgPSBINDtcclxuXHJcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDgwOyBqKyspIHtcclxuXHJcbiAgICAgIGlmIChqIDwgMTYpIHdbal0gPSBtW2kgKyBqXTtcclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdmFyIG46YW55ID0gd1tqIC0gM10gXiB3W2ogLSA4XSBeIHdbaiAtIDE0XSBeIHdbaiAtIDE2XTtcclxuICAgICAgICB3W2pdID0gKG4gPDwgMSkgfCAobiA+Pj4gMzEpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgdCA9ICgoSDAgPDwgNSkgfCAoSDAgPj4+IDI3KSkgKyBINCArICh3W2pdID4+PiAwKSArIChcclxuICAgICAgICBqIDwgMjAgPyAoSDEgJiBIMiB8IH5IMSAmIEgzKSArIDE1MTg1MDAyNDkgOlxyXG4gICAgICAgICAgaiA8IDQwID8gKEgxIF4gSDIgXiBIMykgKyAxODU5Nzc1MzkzIDpcclxuICAgICAgICAgICAgaiA8IDYwID8gKEgxICYgSDIgfCBIMSAmIEgzIHwgSDIgJiBIMykgLSAxODk0MDA3NTg4IDpcclxuICAgICAgICAgICAgICAoSDEgXiBIMiBeIEgzKSAtIDg5OTQ5NzUxNCk7XHJcblxyXG4gICAgICBINCA9IEgzO1xyXG4gICAgICBIMyA9IEgyO1xyXG4gICAgICBIMiA9IChIMSA8PCAzMCkgfCAoSDEgPj4+IDIpO1xyXG4gICAgICBIMSA9IEgwO1xyXG4gICAgICBIMCA9IHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIEgwICs9IGE7XHJcbiAgICBIMSArPSBiO1xyXG4gICAgSDIgKz0gYztcclxuICAgIEgzICs9IGQ7XHJcbiAgICBINCArPSBlO1xyXG5cclxuICB9XHJcblxyXG4gIHJldHVybiBbSDAsIEgxLCBIMiwgSDMsIEg0XTtcclxuXHJcbn07XHJcblxyXG4vLyBQYWNrYWdlIHByaXZhdGUgYmxvY2tzaXplXHJcblNIQTEuX2Jsb2Nrc2l6ZSA9IDE2O1xyXG5cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBDcnlwdG9zOyJdfQ==