"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const showModal = (title, content) => {
    const model = {
        title: title ? title : '网络异常',
    };
    if (content) {
        model.content = content;
    }
    wx.showModal(model);
};
exports.showModal = showModal;
const showModelAction = (title, success) => {
    const model = {
        title: title ? title : '网络异常',
        success: function (_) {
            success();
        }
    };
    wx.showModal(model);
};
exports.showModelAction = showModelAction;
const cityReplace = (val) => {
    return val.replace(/市$/, '');
};
exports.cityReplace = cityReplace;
const validateEmpty = (value, desc) => {
    if (!value) {
        wx.showToast({
            title: desc,
            icon: 'none',
        });
        return false;
    }
    else {
        return true;
    }
};
exports.validateEmpty = validateEmpty;
const validateImages = (images, desc) => {
    if (images.length <= 0) {
        wx.showToast({
            title: desc,
            icon: 'none',
        });
        return false;
    }
    else {
        return true;
    }
};
exports.validateImages = validateImages;
const validatePhone = (phone, desc) => {
    const myreg = /^[1][3,4,5,7,8][0-9]{9}$/;
    if (!myreg.test(phone)) {
        wx.showToast({
            title: desc,
            icon: 'none',
        });
        return false;
    }
    else {
        return true;
    }
};
exports.validatePhone = validatePhone;
const phoneCall = (e) => {
    const phone = e.currentTarget.dataset.phone;
    wx.makePhoneCall({
        phoneNumber: phone,
    });
};
exports.phoneCall = phoneCall;
const getDate = (dateStr) => {
    const date = new Date(dateStr);
    const year = date.getFullYear();
    let month = date.getMonth() + 1;
    month = month <= 9 ? `0${month}` : month;
    let day = date.getDate();
    day = day <= 9 ? `0${day}` : day;
    return `${year}年${month}月${day}日`;
};
exports.getDate = getDate;
const getTime = (dateStr) => {
    const date = new Date(dateStr);
    let hours = date.getHours();
    hours = hours <= 9 ? `0${hours}` : hours;
    let minutes = date.getMinutes();
    minutes = minutes <= 9 ? `0${minutes}` : minutes;
    return `${minutes}:${minutes}`;
};
exports.getTime = getTime;
function formatTime(date) {
    const year = date.getFullYear();
    const month = date.getMonth() + 1;
    const day = date.getDate();
    const hour = date.getHours();
    const minute = date.getMinutes();
    const second = date.getSeconds();
    return [year, month, day].map(formatNumber).join('/') + ' ' + [hour, minute, second].map(formatNumber).join(':');
}
exports.formatTime = formatTime;
const formatNumber = (n) => {
    const str = n.toString();
    return str[1] ? str : '0' + str;
};
const dealRightIntercept = (vipType, rightType) => {
    let needIntercept = false;
    let times = 0;
    let timesNow = wx.getStorageSync(rightType);
    let rightConfig = wx.getStorageSync('rightConfig');
    switch (vipType) {
        case '':
            times = rightConfig[0][rightType] || 99;
            needIntercept = timesNow >= times;
            break;
        case 'bronze':
            times = rightConfig[1][rightType] || 99;
            needIntercept = timesNow >= times;
            break;
        case 'platinum':
            times = rightConfig[2][rightType] || 99;
            needIntercept = timesNow >= times;
            break;
        default:
            needIntercept = false;
            break;
    }
    return needIntercept;
};
exports.dealRightIntercept = dealRightIntercept;
const setRightStorage = (rightType) => {
    let times = 0;
    let rightData = wx.getStorageSync(rightType);
    let dateNow = new Date();
    if (rightData.updateTime.toDateString() == dateNow.toDateString()) {
        times = rightData.times + 1;
    }
    wx.setStorage({
        key: rightType,
        data: {
            times,
            dateNow,
        }
    });
};
exports.setRightStorage = setRightStorage;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLE1BQU0sU0FBUyxHQUFHLENBQUMsS0FBVyxFQUFFLE9BQWEsRUFBRSxFQUFFO0lBQy9DLE1BQU0sS0FBSyxHQUFRO1FBQ2pCLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTTtLQUM5QixDQUFBO0lBQ0QsSUFBSSxPQUFPLEVBQUU7UUFDWCxLQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQTtLQUN4QjtJQUNELEVBQUUsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDckIsQ0FBQyxDQUFBO0FBaUpDLDhCQUFTO0FBL0lYLE1BQU0sZUFBZSxHQUFHLENBQUMsS0FBVSxFQUFFLE9BQWlCLEVBQUUsRUFBRTtJQUN4RCxNQUFNLEtBQUssR0FBUTtRQUNqQixLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE1BQU07UUFDN0IsT0FBTyxFQUFFLFVBQVMsQ0FBTTtZQUN0QixPQUFPLEVBQUUsQ0FBQTtRQUNYLENBQUM7S0FDRixDQUFBO0lBQ0QsRUFBRSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUNyQixDQUFDLENBQUE7QUF3SUMsMENBQWU7QUF0SWpCLE1BQU0sV0FBVyxHQUFHLENBQUMsR0FBUSxFQUFFLEVBQUU7SUFDL0IsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQztBQUMvQixDQUFDLENBQUE7QUFxSUMsa0NBQVc7QUFsSWIsTUFBTSxhQUFhLEdBQUcsQ0FBQyxLQUFVLEVBQUUsSUFBUSxFQUFFLEVBQUU7SUFDN0MsSUFBSSxDQUFDLEtBQUssRUFBRTtRQUNWLEVBQUUsQ0FBQyxTQUFTLENBQUM7WUFDWCxLQUFLLEVBQUUsSUFBSTtZQUNYLElBQUksRUFBRSxN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QyxDQUFDO0FBQ0wsQ0FBQyxDQUFBO0FBY0MsMENBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJcbmNvbnN0IHNob3dNb2RhbCA9ICh0aXRsZT86IGFueSwgY29udGVudD86IGFueSkgPT4ge1xuICBjb25zdCBtb2RlbDogYW55ID0ge1xuICAgIHRpdGxlOiB0aXRsZSA/IHRpdGxlIDogJ+e9kee7nOW8guW4uCcsXG4gIH1cbiAgaWYgKGNvbnRlbnQpIHtcbiAgICBtb2RlbC5jb250ZW50ID0gY29udGVudFxuICB9XG4gIHd4LnNob3dNb2RhbChtb2RlbClcbn1cblxuY29uc3Qgc2hvd01vZGVsQWN0aW9uID0gKHRpdGxlOiBhbnksIHN1Y2Nlc3M6IEZ1bmN0aW9uKSA9PiB7XG4gIGNvbnN0IG1vZGVsOiBhbnkgPSB7XG4gICAgdGl0bGU6IHRpdGxlID8gdGl0bGUgOiAn572R57uc5byC5bi4JyxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihfOiBhbnkpIHtcbiAgICAgIHN1Y2Nlc3MoKVxuICAgIH1cbiAgfVxuICB3eC5zaG93TW9kYWwobW9kZWwpXG59XG5cbmNvbnN0IGNpdHlSZXBsYWNlID0gKHZhbDogYW55KSA9PiB7XG4gIHJldHVybiB2YWwucmVwbGFjZSgv5biCJC8sICcnKTtcbn1cblxuLyoqIOagoemqjOWtl+auteS4jeiDveS4uuepuiAqL1xuY29uc3QgdmFsaWRhdGVFbXB0eSA9ICh2YWx1ZTogYW55LCBkZXNjOmFueSkgPT4ge1xuICBpZiAoIXZhbHVlKSB7XG4gICAgd3guc2hvd1RvYXN0KHtcbiAgICAgIHRpdGxlOiBkZXNjLFxuICAgICAgaWNvbjogJ25vbmUnLFxuICAgIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuXG4vKiog5qCh6aqM5LiK5Lyg5Zu+54mHICovXG5jb25zdCB2YWxpZGF0ZUltYWdlcyA9IChpbWFnZXM6YW55LCBkZXNjOmFueSkgPT4ge1xuICBpZiAoaW1hZ2VzLmxlbmd0aCA8PSAwKSB7XG4gICAgd3guc2hvd1RvYXN0KHtcbiAgICAgIHRpdGxlOiBkZXNjLFxuICAgICAgaWNvbjogJ25vbmUnLFxuICAgIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuXG4vKiog5qCh6aqM5omL5py65Y+356CB5qC85byPICovXG5jb25zdCB2YWxpZGF0ZVBob25lID0gKHBob25lOmFueSwgZGVzYzphbnkpID0+IHtcbiAgY29uc3QgbXlyZWcgPSAvXlsxXVszLDQsNSw3LDhdWzAtOV17OX0kLztcbiAgaWYgKCFteXJlZy50ZXN0KHBob25lKSkge1xuICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICB0aXRsZTogZGVzYyxcbiAgICAgIGljb246ICdub25lJyxcbiAgICB9KTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cblxuY29uc3QgcGhvbmVDYWxsID0gKGU6IGFueSkgPT4ge1xuICBjb25zdCBwaG9uZSA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LnBob25lXG4gIHd4Lm1ha2VQaG9uZUNhbGwoe1xuICAgIHBob25lTnVtYmVyOiBwaG9uZSxcbiAgfSlcbn1cblxuLyoqIDIwMjDlubQwM+aciDA55pelICovXG5jb25zdCBnZXREYXRlID0gKGRhdGVTdHI6IHN0cmluZykgPT4ge1xuICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cik7XG4gIGNvbnN0IHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG4gIGxldCBtb250aDogbnVtYmVyIHwgc3RyaW5nID0gZGF0ZS5nZXRNb250aCgpICsgMTtcbiAgbW9udGggPSBtb250aCA8PSA5ID8gYDAke21vbnRofWAgOiBtb250aDtcbiAgbGV0IGRheTogbnVtYmVyIHwgc3RyaW5nID0gZGF0ZS5nZXREYXRlKCk7XG4gIGRheSA9IGRheSA8PSA5ID8gYDAke2RheX1gIDogZGF5O1xuICByZXR1cm4gYCR7eWVhcn3lubQke21vbnRofeaciCR7ZGF5feaXpWA7XG59O1xuXG4vKiogMDk6MjMgKi9cbmNvbnN0IGdldFRpbWUgPSAoZGF0ZVN0cjogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyKTtcbiAgbGV0IGhvdXJzOiBudW1iZXIgfCBzdHJpbmcgPSBkYXRlLmdldEhvdXJzKCk7XG4gIGhvdXJzID0gaG91cnMgPD0gOSA/IGAwJHtob3Vyc31gIDogaG91cnM7XG4gIGxldCBtaW51dGVzOiBudW1iZXIgfCBzdHJpbmcgPSBkYXRlLmdldE1pbnV0ZXMoKTtcbiAgbWludXRlcyA9IG1pbnV0ZXMgPD0gOSA/IGAwJHttaW51dGVzfWAgOiBtaW51dGVzO1xuICByZXR1cm4gYCR7bWludXRlc306JHttaW51dGVzfWA7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdFRpbWUoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gIGNvbnN0IHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKClcbiAgY29uc3QgbW9udGggPSBkYXRlLmdldE1vbnRoKCkgKyAxXG4gIGNvbnN0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpXG4gIGNvbnN0IGhvdXIgPSBkYXRlLmdldEhvdXJzKClcbiAgY29uc3QgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKClcbiAgY29uc3Qgc2Vjb25kID0gZGF0ZS5nZXRTZWNvbmRzKClcblxuICByZXR1cm4gW3llYXIsIG1vbnRoLCBkYXldLm1hcChmb3JtYXROdW1iZXIpLmpvaW4oJy8nKSArICcgJyArIFtob3VyLCBtaW51dGUsIHNlY29uZF0ubWFwKGZvcm1hdE51bWJlcikuam9pbignOicpXG59XG5cbmNvbnN0IGZvcm1hdE51bWJlciA9IChuOiBudW1iZXIpID0+IHtcbiAgY29uc3Qgc3RyID0gbi50b1N0cmluZygpXG4gIHJldHVybiBzdHJbMV0gPyBzdHIgOiAnMCcgKyBzdHJcbn1cblxuLyoqIOWkhOeQhuadg+ebiuaLpuaIqiAqL1xuY29uc3QgZGVhbFJpZ2h0SW50ZXJjZXB0ID0gKHZpcFR5cGU6IHN0cmluZywgcmlnaHRUeXBlOiBzdHJpbmcgKSA9PiB7XG4gIFxuICBsZXQgbmVlZEludGVyY2VwdCA9IGZhbHNlOyAvLyDmmK/lkKbpnIDopoHmi6bmiKpcbiAgbGV0IHRpbWVzID0gMDtcbiAgbGV0IHRpbWVzTm93ID0gd3guZ2V0U3RvcmFnZVN5bmMocmlnaHRUeXBlKTsgLy8g5LuO57yT5a2Y5Lit6I635Y+W5p2D55uK5L2/55So5oOF5Ya1XG4gIGxldCByaWdodENvbmZpZzogYW55ID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3JpZ2h0Q29uZmlnJyk7IC8vIOS7jue8k+WtmOS4reivu+WPlummlumhteS4rXNldOeahOadg+ebiumFjee9rlxuICBzd2l0Y2ggKHZpcFR5cGUpIHtcbiAgICBjYXNlICcnOiAvLyDmma7pgJpcbiAgICAgIHRpbWVzID0gcmlnaHRDb25maWdbMF1bcmlnaHRUeXBlXSB8fCA5OTtcbiAgICAgIG5lZWRJbnRlcmNlcHQgPSB0aW1lc05vdyA+PSB0aW1lcztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2Jyb256ZSc6IC8vIOm7hOmTnFxuICAgICAgdGltZXMgPSByaWdodENvbmZpZ1sxXVtyaWdodFR5cGVdIHx8IDk5O1xuICAgICAgbmVlZEludGVyY2VwdCA9IHRpbWVzTm93ID49IHRpbWVzO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncGxhdGludW0nOiAvLyDnmb3ph5FcbiAgICAgIHRpbWVzID0gcmlnaHRDb25maWdbMl1bcmlnaHRUeXBlXSB8fCA5OTtcbiAgICAgIG5lZWRJbnRlcmNlcHQgPSB0aW1lc05vdyA+PSB0aW1lcztcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBuZWVkSW50ZXJjZXB0ID0gZmFsc2U7XG4gICAgICBicmVhaztcbiAgfVxuICByZXR1cm4gbmVlZEludGVyY2VwdDtcbn1cblxuY29uc3Qgc2V0UmlnaHRTdG9yYWdlID0gKHJpZ2h0VHlwZTogc3RyaW5nKSA9PiB7XG4gIGxldCB0aW1lcyA9IDA7XG4gIGxldCByaWdodERhdGEgPSB3eC5nZXRTdG9yYWdlU3luYyhyaWdodFR5cGUpO1xuICBsZXQgZGF0ZU5vdyA9IG5ldyBEYXRlKCk7XG4gIC8vIOWIpOaWreaYr+WQpuaYr+WQjOS4gOWkqVxuICBpZiAocmlnaHREYXRhLnVwZGF0ZVRpbWUudG9EYXRlU3RyaW5nKCkgPT0gZGF0ZU5vdy50b0RhdGVTdHJpbmcoKSkge1xuICAgIHRpbWVzID0gcmlnaHREYXRhLnRpbWVzICsgMTtcbiAgfVxuICB3eC5zZXRTdG9yYWdlKHtcbiAgICBrZXk6IHJpZ2h0VHlwZSxcbiAgICBkYXRhOiB7XG4gICAgICB0aW1lcyxcbiAgICAgIGRhdGVOb3csXG4gICAgfSBcbiAgfSk7XG59XG5cbmV4cG9ydCB7XG4gIHNob3dNb2RhbCxcbiAgc2hvd01vZGVsQWN0aW9uLFxuICBjaXR5UmVwbGFjZSxcbiAgdmFsaWRhdGVFbXB0eSxcbiAgdmFsaWRhdGVJbWFnZXMsXG4gIHZhbGlkYXRlUGhvbmUsXG4gIHBob25lQ2FsbCxcbiAgZ2V0RGF0ZSxcbiAgZ2V0VGltZSxcbiAgZm9ybWF0VGltZSxcbiAgZGVhbFJpZ2h0SW50ZXJjZXB0LFxuICBzZXRSaWdodFN0b3JhZ2UsXG59Il19