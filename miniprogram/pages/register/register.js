"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const apiServicePro = require("../../service/api.service");
const oss_1 = require("../../utils/oss");
const config_1 = require("../../config");
const utils = require("../../utils/utils");
Page({
    data: {
        user: { openid: '' },
        nickName: '',
        gender: '',
        birth: '',
        height: '',
        salary: '',
        region: [],
        isMarriage: '未婚',
        education: '',
        hasChild: '',
        wantChild: '',
        job: '',
        haveHouse: '',
        genderIndex: 0,
        salaryIndex: 0,
        note: '',
        leftLenth: 300,
        indexImage: '',
        uploadIndexPath: '',
        oldImages: [],
        uploadImgs: [],
        count: 9,
        city: '',
        selectValue: '',
        cityList: [],
        hotCityList: [],
        popHidden: true,
        brandList: [],
        hotBrandList: [],
        dateNow: '',
        popHiddenBrand: true,
        submitDisable: false,
        isMarriageArray: ['未婚', '离异'],
        genderArray: ['男', '女'],
        salaryArray: [
            '5千以下', '5千～1万', '1万～2万', '2万～5万', '5万以上'
        ],
        educationArray: [
            '小学', '初中', '高中', '大专', '大学本科', '硕士', '博士'
        ],
        hasChildArray: ['是', '否'],
        wantChildArray: ['是', '否'],
        haveHouseArray: ['已买', '未买'],
    },
    onLoad: function () {
        let _this = this;
        wx.getStorage({
            key: 'user',
            success: function (res) {
                _this.setData({
                    user: res.data
                });
            },
        });
        this.setData({
            dateNow: this.getYMD(new Date())
        });
    },
    getCarDetail(id) {
        apiServicePro.getUserDetail(id).then((result) => {
            if (result) {
                this.setData({
                    brand: result.data.brand,
                    brandDetail: result.data.brandDetail,
                    city: result.data.city,
                    price: result.data.price,
                    birth: this.getYMD(result.data.birth),
                    height: result.data.height,
                    isMarriage: result.data.isMarriage,
                    education: result.data.education,
                    gender: result.data.gender,
                    note: result.data.note,
                    indexImage: result.data.indexImage,
                    oldImages: result.data.images,
                });
            }
        });
    },
    getYMD(dateStr) {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        let month = date.getMonth() + 1;
        let monthStr = month <= 9 ? `0${month}` : month;
        let day = date.getDate();
        let dayStr = day <= 9 ? `0${day}` : day;
        return `${year}-${monthStr}-${dayStr}`;
    },
    onSubmit(e) {
        let that = this;
        const value = e.detail.value;
        const openid = this.data.user.openid;
        const aliyunServerURL = config_1.default.uploadImageUrl;
        if (!utils.validateEmpty(value.nickName, '请输入昵称') ||
            !utils.validateEmpty(value.birth, '请选择生日') ||
            !utils.validateEmpty(value.height, '请输入身高') ||
            !utils.validateEmpty(value.city, '请输选择牌照所在地') ||
            !utils.validateEmpty(value.price, '请输入价格') ||
            !utils.validateEmpty(value.gender, '请选择车况') ||
            !utils.validateEmpty(this.data.indexImage, '请上传汽车首页照片')) {
            return false;
        }
        let indexImage = this.data.indexImage;
        let uploadIndexPath = this.data.uploadIndexPath;
        if (uploadIndexPath !== '') {
            oss_1.default({
                filePath: indexImage,
                dir: `images/shop/${openid}/` + indexImage.replace('http://tmp/', ''),
                success: function (res) {
                    indexImage = `${aliyunServerURL}/${res}`;
                    that.uploadAndSubmit();
                },
                fail: function () {
                    that.uploadAndSubmit();
                }
            });
        }
        else {
            that.uploadAndSubmit();
        }
    },
    uploadAndSubmit() {
        const openid = this.data.user.openid;
        const aliyunServerURL = config_1.default.uploadImageUrl;
        let count = 0;
        let images = [];
        const uploadImgs = this.data.uploadImgs;
        wx.showLoading({
            title: '',
        });
        if (uploadImgs.length > 0) {
            for (let i = 0; i < uploadImgs.length; i++) {
                let filePath = uploadImgs[i];
                oss_1.default({
                    filePath: filePath,
                    dir: `images/shop/${openid}/` + filePath.replace('http://tmp/', ''),
                    success: function (res) {
                        count++;
                        images.push(`${aliyunServerURL}/${res}`);
                        if (count === uploadImgs.length) {
                        }
                        else {
                        }
                    },
                    fail: function () {
                        wx.hideLoading();
                    }
                });
            }
        }
        else {
            wx.hideLoading();
        }
    },
    doSubmit(e, indexImage, images) {
        const params = e.detail.value;
        this.setData({
            submitDisable: true
        });
        apiServicePro.register(Object.assign({ images, indexImage }, params)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                wx.navigateTo({
                    url: `../carDetail/carDetail?id=${result.data.id}&from=creatCarPage`,
                });
            }
            else if (result.code === 1202) {
                utils.showModal('信息校验不通过，请核对汽车信息');
            }
            else {
                utils.showModal();
            }
        });
    },
    updateCar(e, indexImage, images, carId) {
        const value = e.detail.value;
        const params = Object.assign(value, { 'id': carId });
        this.setData({
            submitDisable: true
        });
        apiServicePro.updateUser(Object.assign({ images, indexImage }, params)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                wx.navigateTo({
                    url: `../carDetail/carDetail?id=${result.data.id}&from=creatCarPage`,
                });
            }
            else if (result.code === 1202) {
                utils.showModal('信息校验不通过，请核对汽车信息');
            }
            else {
                utils.showModal();
            }
        });
    },
    delImage(e) {
        const array = e.currentTarget.dataset.array;
        const index = e.currentTarget.dataset.index;
        if (array === 'oldImages') {
            const oldImages = this.data.oldImages;
            oldImages.splice(index, 1);
            this.setData({
                oldImages
            });
        }
        else {
            const uploadImgs = this.data.uploadImgs;
            uploadImgs.splice(index, 1);
            this.setData({
                uploadImgs
            });
        }
    },
    chooseIndexImage() {
        this.chooseImage(1, 'one');
    },
    chooseOtherImage(e) {
        const selectPictureNum = e.target.dataset.num;
        let count = 99 - selectPictureNum;
        this.chooseImage(count, 'multi');
    },
    chooseImage(count, type) {
        const that = this;
        wx.chooseImage({
            count: count,
            sizeType: ['original', 'compressed'],
            sourceType: ['album', 'camera'],
            success: function (res) {
                let uploadImgs = that.data.uploadImgs;
                if (type === 'multi') {
                    that.setData({
                        uploadImgs: uploadImgs.concat(res.tempFilePaths),
                    });
                }
                else {
                    that.setData({
                        uploadIndexPath: res.tempFilePaths[0],
                        indexImage: res.tempFilePaths[0],
                    });
                }
            },
        });
    },
    popPicker() {
        let popHidden = this.data.popHidden;
        this.setData({
            popHidden: !popHidden,
        });
    },
    doSelect(e) {
        if (e.detail.name) {
            this.setData({
                popHidden: true,
                city: e.detail.name,
            });
            wx.setStorage({
                key: 'city',
                data: e.detail.name,
            });
        }
        else {
            this.setData({
                popHidden: true,
            });
        }
    },
    popBrand() {
        let popHiddenBrand = this.data.popHiddenBrand;
        this.setData({
            popHiddenBrand: !popHiddenBrand,
        });
    },
    doSelectBrand(e) {
        if (e.detail.brand) {
            this.setData({
                popHiddenBrand: true,
                brand: e.detail.brand,
                brandDetail: e.detail.brandDetail,
            });
            wx.setStorage({
                key: 'brand',
                data: e.detail.brand,
            });
        }
        else {
            this.setData({
                popHiddenBrand: true,
            });
        }
    },
    bindBirthChange(e) {
        this.setData({
            birth: e.detail.value
        });
    },
    bindEducationChange(e) {
        const { educationArray } = this.data;
        this.setData({
            education: educationArray[e.detail.value]
        });
    },
    bindMarriageChange(e) {
        const { isMarriageArray } = this.data;
        this.setData({
            isMarriage: isMarriageArray[e.detail.value]
        });
    },
    bindHasChildChange(e) {
        const { hasChildArray } = this.data;
        this.setData({
            hasChild: hasChildArray[e.detail.value]
        });
    },
    bindWantChildChange(e) {
        const { wantChildArray } = this.data;
        this.setData({
            wantChild: wantChildArray[e.detail.value]
        });
    },
    bindHaveHouseChange(e) {
        const { haveHouseArray } = this.data;
        this.setData({
            haveHouse: haveHouseArray[e.detail.value]
        });
    },
    bindGenderChange(e) {
        const { genderArray } = this.data;
        this.setData({
            gender: genderArray[e.detail.value]
        });
    },
    bindSalaryChange(e) {
        const { salaryArray } = this.data;
        this.setData({
            salary: salaryArray[e.detail.value]
        });
    },
    bindRegionChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            region: e.detail.value,
        });
    },
    inputNote(e) {
        const leftLenth = (300 - e.detail.value.length);
        this.setData({
            leftLenth: leftLenth > 0 ? leftLenth : 0
        });
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDJEQUEyRDtBQUMzRCx5Q0FBMkM7QUFDM0MseUNBQStCO0FBQy9CLDJDQUEyQztBQUUzQyxJQUFJLENBQUM7SUFDSCxJQUFJLEVBQUU7UUFDSixJQUFJLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ3BCLFFBQVEsRUFBRSxFQUFFO1FBQ1osTUFBTSxFQUFFLEVBQUU7UUFDVixLQUFLLEVBQUUsRUFBRTtRQUNULE1BQU0sRUFBRSxFQUFFO1FBQ1YsTUFBTSxFQUFFLEVBQUU7UUFDVixNQUFNLEVBQUUsRUFBRTtRQUNWLFVBQVUsRUFBRSxJQUFJO1FBQ2hCLFNBQVMsRUFBRSxFQUFFO1FBQ2IsUUFBUSxFQUFFLEVBQUU7UUFDWixTQUFTLEVBQUUsRUFBRTtRQUNiLEdBQUcsRUFBRSxFQUFFO1FBQ1AsU0FBUyxFQUFFLEVBQUU7UUFDYixXQUFXLEVBQUUsQ0FBQztRQUNkLFdBQVcsRUFBRSxDQUFDO1FBQ2QsSUFBSSxFQUFFLEVBQUU7UUFDUixTQUFTLEVBQUUsR0FBRztRQUNkLFVBQVUsRUFBRSxFQUFFO1FBQ2QsZUFBZSxFQUFFLEVBQUU7UUFDbkIsU0FBUyxFQUFFLEVBQUU7UUFDYixVQUFVLEVBQUUsRUFBRTtRQUNkLEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxFQUFFLEVBQUU7UUFDUixXQUFXLEVBQUUsRUFBRTtRQUNmLFFBQVEsRUFBRSxFQUFFO1FBQ1osV0FBVyxFQUFFLEVBQUU7UUFDZixTQUFTLEVBQUUsSUFBSTtRQUNmLFNBQVMsRUFBRSxFQUFFO1FBQ2IsWUFBWSxFQUFFLEVBQUU7UUFDaEIsT0FBTyxFQUFFLEVBQUU7UUFDWCxjQUFjLEVBQUUsSUFBSTtRQUNwQixhQUFhLEVBQUUsS0FBSztRQUNwQixlQUFlLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQzdCLFdBQVcs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USxDQUFDO1lBQ1osTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUNwQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsZ0JBQWdCLEVBQUUsVUFBVSxDQUFLO1FBQy9CLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUNoRCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osTUFBTSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSztTQUN2QixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsU0FBUyxDQUFDLENBQU07UUFDZCxNQUFNLFNBQVMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNoRCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osU0FBUyxFQUFFLFNBQVMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN6QyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBS0QsT0FBTyxFQUFFO0lBRVQsQ0FBQztJQUtELE1BQU0sRUFBRTtJQUNSLENBQUM7SUFLRCxNQUFNLEVBQUU7SUFFUixDQUFDO0lBS0QsUUFBUSxFQUFFO0lBRVYsQ0FBQztJQUtELGlCQUFpQixFQUFFO0lBRW5CLENBQUM7SUFLRCxhQUFhLEVBQUU7SUFFZixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvY3JlYXRlQ2FyL2NyZWF0ZUNhci5qc1xuaW1wb3J0ICogYXMgYXBpU2VydmljZVBybyBmcm9tICcuLi8uLi9zZXJ2aWNlL2FwaS5zZXJ2aWNlJztcbmltcG9ydCB1cGxvYWRJbWFnZSAgZnJvbSAnLi4vLi4vdXRpbHMvb3NzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICB1c2VyOiB7IG9wZW5pZDogJycgfSxcbiAgICBuaWNrTmFtZTogJycsXG4gICAgZ2VuZGVyOiAnJywgXG4gICAgYmlydGg6ICcnLCAgICAgICAgICAgIC8vIOeUn+aXpVxuICAgIGhlaWdodDogJycsICAgICAgICAgICAvLyDouqvpq5hcbiAgICBzYWxhcnk6ICcnLCBcbiAgICByZWdpb246IFtdLCBcbiAgICBpc01hcnJpYWdlOiAn5pyq5amaJyxcbiAgICBlZHVjYXRpb246ICcnLCBcbiAgICBoYXNDaGlsZDogJycsIFxuICAgIHdhbnRDaGlsZDogJycsIFxuICAgIGpvYjogJycsXG4gICAgaGF2ZUhvdXNlOiAnJywgICBcbiAgICBnZW5kZXJJbmRleDogMCxcbiAgICBzYWxhcnlJbmRleDogMCxcbiAgICBub3RlOiAnJyxcbiAgICBsZWZ0TGVudGg6IDMwMCxcbiAgICBpbmRleEltYWdlOiAnJyxcbiAgICB1cGxvYWRJbmRleFBhdGg6ICcnLFxuICAgIG9sZEltYWdlczogW10sICAgICAgICAvLyDmm7TmlrDmsb3ovablm77niYdcbiAgICB1cGxvYWRJbWdzOiBbXSwgICAgICAgLy8g5Zu+54mHXG4gICAgY291bnQ6IDksXG4gICAgY2l0eTogJycsICAgICAgICAgICAgIC8vIOS4iueJjOWcsOeCuVxuICAgIHNlbGVjdFZhbHVlOiAnJyxcbiAgICBjaXR5TGlzdDogW10sXG4gICAgaG90Q2l0eUxpc3Q6IFtdLFxuICAgIHBvcEhpZGRlbjogdHJ1ZSxcbiAgICBicmFuZExpc3Q6IFtdLFxuICAgIGhvdEJyYW5kTGlzdDogW10sXG4gICAgZGF0ZU5vdzogJycsXG4gICAgcG9wSGlkZGVuQnJhbmQ6IHRydWUsXG4gICAgc3VibWl0RGlzYWJsZTogZmFsc2UsXG4gICAgaXNNYXJyaWFnZUFycmF5OiBbJ+acquWpmicsICfnprvlvIInXSxcbiAgICBnZW5kZXJBcnJheTogWyfnlLcnLCflpbMnXSxcbiAgICBzYWxhcnlBcnJheTogW1xuICAgICAgJzXljYPku6XkuIsnLCAnNeWNg++9njHkuIcnLCAnMeS4h++9njLkuIcnLCAnMuS4h++9njXkuIcnLCAnNeS4h+S7peS4iidcbiAgICBdLFxuICAgIGVkdWNhdGlvbkFycmF5OiBbXG4gICAgICAn5bCP5a2mJywgJ+WIneS4rScsICfpq5jkuK0nLCAn5aSn5LiTJywgJ+Wkp+WtpuacrOenkScsICfnoZXlo6snLCAn5Y2a5aOrJ1xuICAgIF0sXG4gICAgaGFzQ2hpbGRBcnJheTogWyfmmK8nLCAn5ZCmJ10sXG4gICAgd2FudENoaWxkQXJyYXk6IFsn5pivJywgJ+WQpiddLFxuICAgIGhhdmVIb3VzZUFycmF5OiBbJ+W3suS5sCcsICfmnKrkubAnXSxcbiAgfSxcblxuICAvKipcbiAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWKoOi9vVxuICAqL1xuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHd4LmdldFN0b3JhZ2Uoe1xuICAgICAga2V5OiAndXNlcicsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIF90aGlzLnNldERhdGEhKHtcbiAgICAgICAgICB1c2VyOiByZXMuZGF0YVxuICAgICAgICB9KVxuICAgICAgfSxcbiAgICB9KTsgIFxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgZGF0ZU5vdzogdGhpcy5nZXRZTUQobmV3IERhdGUoKSlcbiAgICB9KTtcbiAgfSxcblxuICAvKiog5rG96L2m6K+m5oOFICovXG4gIGdldENhckRldGFpbChpZDogYW55KSB7XG4gICAgYXBpU2VydmljZVByby5nZXRVc2VyRGV0YWlsKGlkKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgICBicmFuZDogcmVzdWx0LmRhdGEuYnJhbmQsXG4gICAgICAgICAgYnJhbmREZXRhaWw6IHJlc3VsdC5kYXRhLmJyYW5kRGV0YWlsLCAgICAgICAgIC8vIOS6jOe6p+i9puezu1xuICAgICAgICAgIGNpdHk6IHJlc3VsdC5kYXRhLmNpdHksXG4gICAgICAgICAgcHJpY2U6IHJlc3VsdC5kYXRhLnByaWNlLCAgICAgICAgICAgICAgICAgICAgIC8vIOS7t+agvFxuICAgICAgICAgIGJpcnRoOiB0aGlzLmdldFlNRChyZXN1bHQuZGF0YS5iaXJ0aCksICAgICAgICAvLyDnlJ/ml6VcbiAgICAgICAgICBoZWlnaHQ6IHJlc3VsdC5kYXRhLmhlaWdodCwgICAgICAgICAgICAgICAgICAgLy8g6Lqr6auYXG4gICAgICAgICAgaXNNYXJyaWFnZTogcmVzdWx0LmRhdGEuaXNNYXJyaWFnZSwgICAgICAgICAgIC8vIOWpmuWnu+eKtuWGtVxuICAgICAgICAgIGVkdWNhdGlvbjogcmVzdWx0LmRhdGEuZWR1Y2F0aW9uLCAgICAgICAgICAgICAvLyDmlZnogrJcbiAgICAgICAgICBnZW5kZXI6IHJlc3VsdC5kYXRhLmdlbmRlciwgICAgICAgICAgICAgICAgICAgLy8g5oCn5YirXG4gICAgICAgICAgbm90ZTogcmVzdWx0LmRhdGEubm90ZSwgICAgICAgICAgICAgICAgICAgICAgIC8vIOihpeWFhVxuICAgICAgICAgIGluZGV4SW1hZ2U6IHJlc3VsdC5kYXRhLmluZGV4SW1hZ2UsXG4gICAgICAgICAgb2xkSW1hZ2VzOiByZXN1bHQuZGF0YS5pbWFnZXMsICAgICAgICAgICAgICAgIC8vIOWbvueJh1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH0sXG5cbiAgZ2V0WU1EKGRhdGVTdHI6IGFueSkge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyKTtcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGxldCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgbGV0IG1vbnRoU3RyID0gbW9udGggPD0gOSA/IGAwJHttb250aH1gIDogbW9udGg7XG4gICAgbGV0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIGxldCBkYXlTdHIgPSBkYXkgPD0gOSA/IGAwJHtkYXl9YCA6IGRheTtcbiAgICByZXR1cm4gYCR7eWVhcn0tJHttb250aFN0cn0tJHtkYXlTdHJ9YFxuICB9LFxuXG4gIC8qKiDlh4blpIfmj5DkuqQgKi9cbiAgb25TdWJtaXQoZTogYW55KTogYW55IHtcbiAgICBsZXQgdGhhdCA9IHRoaXM7XG4gICAgY29uc3QgdmFsdWUgPSBlLmRldGFpbC52YWx1ZTtcbiAgICBjb25zdCBvcGVuaWQgPSB0aGlzLmRhdGEudXNlci5vcGVuaWQ7XG4gICAgY29uc3QgYWxpeXVuU2VydmVyVVJMID0gZW52LnVwbG9hZEltYWdlVXJsO1xuXG4gICAgaWYgKCF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLm5pY2tOYW1lLCAn6K+36L6T5YWl5pi156ewJykgfHxcbiAgICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuYmlydGgsICfor7fpgInmi6nnlJ/ml6UnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5oZWlnaHQsICfor7fovpPlhaXouqvpq5gnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5jaXR5LCAn6K+36L6T6YCJ5oup54mM54Wn5omA5Zyo5ZywJykgfHxcbiAgICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUucHJpY2UsICfor7fovpPlhaXku7fmoLwnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5nZW5kZXIsICfor7fpgInmi6novablhrUnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuaW5kZXhJbWFnZSwgJ+ivt+S4iuS8oOaxvei9pummlumhteeFp+eJhycpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGluZGV4SW1hZ2UgPSB0aGlzLmRhdGEuaW5kZXhJbWFnZTtcbiAgICBsZXQgdXBsb2FkSW5kZXhQYXRoID0gdGhpcy5kYXRhLnVwbG9hZEluZGV4UGF0aDtcbiAgICBpZiAodXBsb2FkSW5kZXhQYXRoICE9PSAnJykge1xuICAgICAgdXBsb2FkSW1hZ2Uoe1xuICAgICAgICBmaWxlUGF0aDogaW5kZXhJbWFnZSxcbiAgICAgICAgZGlyOiBgaW1hZ2VzL3Nob3AvJHtvcGVuaWR9L2AgKyBpbmRleEltYWdlLnJlcGxhY2UoJ2h0dHA6Ly90bXAvJywgJycpLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzOiBhbnkpIHtcbiAgICAgICAgICBpbmRleEltYWdlID0gYCR7YWxpeXVuU2VydmVyVVJMfS8ke3Jlc31gO1xuICAgICAgICAgIHRoYXQudXBsb2FkQW5kU3VibWl0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGZhaWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGF0LnVwbG9hZEFuZFN1Ym1pdCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhhdC51cGxvYWRBbmRTdWJtaXQoKTtcbiAgICB9XG4gIH0sXG5cbiAgdXBsb2FkQW5kU3VibWl0KCkge1xuICAgIGNvbnN0IG9wZW5pZCA9IHRoaXMuZGF0YS51c2VyLm9wZW5pZDtcbiAgICBjb25zdCBhbGl5dW5TZXJ2ZXJVUkwgPSBlbnYudXBsb2FkSW1hZ2VVcmw7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBsZXQgaW1hZ2VzOiBhbnlbXSA9IFtdO1xuICAgIGNvbnN0IHVwbG9hZEltZ3MgPSB0aGlzLmRhdGEudXBsb2FkSW1ncztcbiAgICB3eC5zaG93TG9hZGluZyh7XG4gICAgICB0aXRsZTogJycsXG4gICAgfSlcbiAgICBpZiAodXBsb2FkSW1ncy5sZW5ndGggPiAwKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVwbG9hZEltZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGZpbGVQYXRoOiBhbnkgPSB1cGxvYWRJbWdzW2ldO1xuICAgICAgICB1cGxvYWRJbWFnZSh7XG4gICAgICAgICAgZmlsZVBhdGg6IGZpbGVQYXRoLFxuICAgICAgICAgIGRpcjogYGltYWdlcy9zaG9wLyR7b3BlbmlkfS9gICsgZmlsZVBhdGgucmVwbGFjZSgnaHR0cDovL3RtcC8nLCAnJyksXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlczogYW55KSB7XG4gICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgaW1hZ2VzLnB1c2goYCR7YWxpeXVuU2VydmVyVVJMfS8ke3Jlc31gKTtcbiAgICAgICAgICAgIGlmIChjb3VudCA9PT0gdXBsb2FkSW1ncy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgLy8gaWYgKHRoYXQuZGF0YS5jYXJJZCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgLy8gICBpbWFnZXMgPSBpbWFnZXMuY29uY2F0KHRoYXQuZGF0YS5vbGRJbWFnZXMpO1xuICAgICAgICAgICAgICAvLyAgIHRoYXQudXBkYXRlQ2FyKGUsIGluZGV4SW1hZ2UsIGltYWdlcywgdGhhdC5kYXRhLmNhcklkKTtcbiAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gICB0aGF0LmRvU3VibWl0KGUsIGluZGV4SW1hZ2UsIGltYWdlcyk7XG4gICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmYWlsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3eC5oaWRlTG9hZGluZygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGlmICh0aGF0LmRhdGEuY2FySWQgIT09ICcnKSB7XG4gICAgICAvLyAgIGltYWdlcyA9IGltYWdlcy5jb25jYXQodGhhdC5kYXRhLm9sZEltYWdlcyk7ICAvLyDlkIjlubbnvJbovpHkuYvliY3nmoTmsb3ovablm77niYdcbiAgICAgIC8vICAgdGhhdC51cGRhdGVDYXIoZSwgaW5kZXhJbWFnZSwgaW1hZ2VzLCB0aGF0LmRhdGEuY2FySWQpO1xuICAgICAgLy8gfSBlbHNlIHtcbiAgICAgIC8vICAgdGhhdC5kb1N1Ym1pdChlLCBpbmRleEltYWdlLCBpbWFnZXMpO1xuICAgICAgLy8gfVxuICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqIOWIm+W7uuaxvei9piAqL1xuICBkb1N1Ym1pdChlOiBhbnksIGluZGV4SW1hZ2U6IGFueSwgaW1hZ2VzOiBhbnkpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBlLmRldGFpbC52YWx1ZTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHN1Ym1pdERpc2FibGU6IHRydWVcbiAgICB9KTtcbiAgICBhcGlTZXJ2aWNlUHJvLnJlZ2lzdGVyKE9iamVjdC5hc3NpZ24oeyBpbWFnZXMsIGluZGV4SW1hZ2UgfSwgcGFyYW1zKSkudGhlbigocmVzdWx0OiBhbnkpID0+IHtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7IFxuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIHN1Ym1pdERpc2FibGU6IHRydWVcbiAgICAgIH0pOyAgICAgXG4gICAgICBpZiAocmVzdWx0LmNvZGUgPT09IDIwMCkge1xuICAgICAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgICAgICB1cmw6IGAuLi9jYXJEZXRhaWwvY2FyRGV0YWlsP2lkPSR7cmVzdWx0LmRhdGEuaWR9JmZyb209Y3JlYXRDYXJQYWdlYCxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHJlc3VsdC5jb2RlID09PSAxMjAyKSB7XG4gICAgICAgIHV0aWxzLnNob3dNb2RhbCgn5L+h5oGv5qCh6aqM5LiN6YCa6L+H77yM6K+35qC45a+55rG96L2m5L+h5oGvJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1dGlscy5zaG93TW9kYWwoKTtcbiAgICAgIH1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDmm7TmlrDmsb3ovaYgKi9cbiAgdXBkYXRlQ2FyKGU6IGFueSwgaW5kZXhJbWFnZTogYW55LCBpbWFnZXM6IGFueSwgY2FySWQ6IGFueSkge1xuICAgIGNvbnN0IHZhbHVlID0gZS5kZXRhaWwudmFsdWU7XG4gICAgY29uc3QgcGFyYW1zID0gT2JqZWN0LmFzc2lnbih2YWx1ZSwgeydpZCc6IGNhcklkfSk7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBzdWJtaXREaXNhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgYXBpU2VydmljZVByby51cGRhdGVVc2VyKE9iamVjdC5hc3NpZ24oeyBpbWFnZXMsIGluZGV4SW1hZ2UgfSwgcGFyYW1zKSkudGhlbigocmVzdWx0OmFueSkgPT4ge1xuICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBzdWJtaXREaXNhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgICAgIHVybDogYC4uL2NhckRldGFpbC9jYXJEZXRhaWw/aWQ9JHtyZXN1bHQuZGF0YS5pZH0mZnJvbT1jcmVhdENhclBhZ2VgLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmNvZGUgPT09IDEyMDIpIHtcbiAgICAgICAgdXRpbHMuc2hvd01vZGFsKCfkv6Hmga/moKHpqozkuI3pgJrov4fvvIzor7fmoLjlr7nmsb3ovabkv6Hmga8nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHV0aWxzLnNob3dNb2RhbCgpO1xuICAgICAgfVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOWIoOmZpOS4iuS8oOeFp+eJhyAqL1xuICBkZWxJbWFnZShlOiBhbnkpIHtcbiAgICBjb25zdCBhcnJheSA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmFycmF5O1xuICAgIGNvbnN0IGluZGV4ID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXg7XG4gICAgaWYgKGFycmF5ID09PSAnb2xkSW1hZ2VzJykge1xuICAgICAgY29uc3Qgb2xkSW1hZ2VzID0gdGhpcy5kYXRhLm9sZEltYWdlcztcbiAgICAgIG9sZEltYWdlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIG9sZEltYWdlc1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHVwbG9hZEltZ3MgPSB0aGlzLmRhdGEudXBsb2FkSW1ncztcbiAgICAgIHVwbG9hZEltZ3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICB1cGxvYWRJbWdzXG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgY2hvb3NlSW5kZXhJbWFnZSgpIHtcbiAgICB0aGlzLmNob29zZUltYWdlKDEsICdvbmUnKTtcbiAgfSxcblxuICBjaG9vc2VPdGhlckltYWdlKGU6IGFueSkge1xuICAgIGNvbnN0IHNlbGVjdFBpY3R1cmVOdW0gPSBlLnRhcmdldC5kYXRhc2V0Lm51bTtcbiAgICBsZXQgY291bnQgPSA5OSAtIHNlbGVjdFBpY3R1cmVOdW1cbiAgICB0aGlzLmNob29zZUltYWdlKGNvdW50LCAnbXVsdGknKTtcbiAgfSxcblxuICAvKiog6YCJ5oup5Zu+54mHXG4gICAqICBAdHlwZSBtdWx0aS3lpJrlvKDlm77niYcgb25lLeS4gOW8oOWbvueJh1xuICAgKi9cbiAgY2hvb3NlSW1hZ2UoY291bnQ6IGFueSwgdHlwZTogYW55KSB7XG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XG4gICAgd3guY2hvb3NlSW1hZ2Uoe1xuICAgICAgY291bnQ6IGNvdW50LFxuICAgICAgc2l6ZVR5cGU6IFsnb3JpZ2luYWwnLCAnY29tcHJlc3NlZCddLCAvLyDlj6/ku6XmjIflrprmmK/ljp/lm77ov5jmmK/ljovnvKnlm77vvIzpu5jorqTkuozogIXpg73mnIlcbiAgICAgIHNvdXJjZVR5cGU6IFsnYWxidW0nLCAnY2FtZXJhJ10sIC8vIOWPr+S7peaMh+Wumuadpea6kOaYr+ebuOWGjOi/mOaYr+ebuOacuu+8jOm7mOiupOS6jOiAhemDveaciVxuICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlczogYW55KSB7XG4gICAgICAgIGxldCB1cGxvYWRJbWdzID0gdGhhdC5kYXRhLnVwbG9hZEltZ3M7XG4gICAgICAgIGlmICh0eXBlID09PSAnbXVsdGknKSB7XG4gICAgICAgICAgdGhhdC5zZXREYXRhISh7XG4gICAgICAgICAgICB1cGxvYWRJbWdzOiB1cGxvYWRJbWdzLmNvbmNhdChyZXMudGVtcEZpbGVQYXRocyksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhhdC5zZXREYXRhISh7XG4gICAgICAgICAgICB1cGxvYWRJbmRleFBhdGg6IHJlcy50ZW1wRmlsZVBhdGhzWzBdLFxuICAgICAgICAgICAgaW5kZXhJbWFnZTogcmVzLnRlbXBGaWxlUGF0aHNbMF0sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSlcbiAgfSxcblxuICAvKiog5o6n5Yi2cGlja2VyQ2l0eSAqL1xuICBwb3BQaWNrZXIoKSB7XG4gICAgbGV0IHBvcEhpZGRlbiA9IHRoaXMuZGF0YS5wb3BIaWRkZW47XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBwb3BIaWRkZW46ICFwb3BIaWRkZW4sXG4gICAgfSlcbiAgfSxcblxuICAvKiog6YCJ5oup5Z+O5biCICovXG4gIGRvU2VsZWN0KGU6IGFueSkge1xuICAgIGlmIChlLmRldGFpbC5uYW1lKSB7XG4gICAgICAvLyBjb25zdCBjaXR5SWQgPSB0aGlzLmdldENpdHlJZChlLmRldGFpbC5uYW1lKTtcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBwb3BIaWRkZW46IHRydWUsXG4gICAgICAgIGNpdHk6IGUuZGV0YWlsLm5hbWUsXG4gICAgICAgIC8vIGNpdHlJZCxcbiAgICAgIH0pXG4gICAgICB3eC5zZXRTdG9yYWdlKHtcbiAgICAgICAga2V5OiAnY2l0eScsXG4gICAgICAgIGRhdGE6IGUuZGV0YWlsLm5hbWUsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgeyAgLy8g5Y+W5raI5oyJ6ZKuXG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgcG9wSGlkZGVuOiB0cnVlLFxuICAgICAgfSlcbiAgICB9XG4gIH0sXG5cblxuICAvKiog5o6n5Yi2cGlja0JyYW5kICovXG4gIHBvcEJyYW5kKCkge1xuICAgIGxldCBwb3BIaWRkZW5CcmFuZCA9IHRoaXMuZGF0YS5wb3BIaWRkZW5CcmFuZDtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHBvcEhpZGRlbkJyYW5kOiAhcG9wSGlkZGVuQnJhbmQsXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqIOmAieaLqeWfjuW4giAqL1xuICBkb1NlbGVjdEJyYW5kKGU6IGFueSkge1xuICAgIGlmIChlLmRldGFpbC5icmFuZCkge1xuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIHBvcEhpZGRlbkJyYW5kOiB0cnVlLFxuICAgICAgICBicmFuZDogZS5kZXRhaWwuYnJhbmQsXG4gICAgICAgIGJyYW5kRGV0YWlsOiBlLmRldGFpbC5icmFuZERldGFpbCxcbiAgICAgIH0pO1xuICAgICAgd3guc2V0U3RvcmFnZSh7XG4gICAgICAgIGtleTogJ2JyYW5kJyxcbiAgICAgICAgZGF0YTogZS5kZXRhaWwuYnJhbmQsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgeyAgLy8g5Y+W5raI5oyJ6ZKuXG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgcG9wSGlkZGVuQnJhbmQ6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqIOeUn+aXpSAqL1xuICBiaW5kQmlydGhDaGFuZ2UoZTogYW55KSB7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBiaXJ0aDogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuXG4gIGJpbmRFZHVjYXRpb25DaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBlZHVjYXRpb25BcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBlZHVjYXRpb246IGVkdWNhdGlvbkFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOWpmuWnuyAqL1xuICBiaW5kTWFycmlhZ2VDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBpc01hcnJpYWdlQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgaXNNYXJyaWFnZTogaXNNYXJyaWFnZUFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZEhhc0NoaWxkQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgaGFzQ2hpbGRBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBoYXNDaGlsZDogaGFzQ2hpbGRBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIGJpbmRXYW50Q2hpbGRDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyB3YW50Q2hpbGRBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICB3YW50Q2hpbGQ6IHdhbnRDaGlsZEFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZEhhdmVIb3VzZUNoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGhhdmVIb3VzZUFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGhhdmVIb3VzZTogaGF2ZUhvdXNlQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICAvKiog5oCn5YirICovXG4gIGJpbmRHZW5kZXJDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBnZW5kZXJBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBnZW5kZXI6IGdlbmRlckFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOaciOaUtuWFpSAqL1xuICBiaW5kU2FsYXJ5Q2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgc2FsYXJ5QXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgc2FsYXJ5OiBzYWxhcnlBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KTtcbiAgfSxcblxuICBiaW5kUmVnaW9uQ2hhbmdlOiBmdW5jdGlvbiAoZTphbnkpIHtcbiAgICBjb25zb2xlLmxvZygncGlja2Vy5Y+R6YCB6YCJ5oup5pS55Y+Y77yM5pC65bim5YC85Li6JywgZS5kZXRhaWwudmFsdWUpXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICByZWdpb246IGUuZGV0YWlsLnZhbHVlLFxuICAgIH0pO1xuICB9LFxuXG4gIGlucHV0Tm90ZShlOiBhbnkpIHtcbiAgICBjb25zdCBsZWZ0TGVudGggPSAoMzAwIC0gZS5kZXRhaWwudmFsdWUubGVuZ3RoKTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGxlZnRMZW50aDogbGVmdExlbnRoID4gMCA/IGxlZnRMZW50aCA6IDBcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliJ3mrKHmuLLmn5PlrozmiJBcbiAgICovXG4gIG9uUmVhZHk6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouaYvuekulxuICAgKi9cbiAgb25TaG93OiBmdW5jdGlvbiAoKSB7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i6ZqQ6JePXG4gICAqL1xuICBvbkhpZGU6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWNuOi9vVxuICAgKi9cbiAgb25VbmxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLnm7jlhbPkuovku7blpITnkIblh73mlbAtLeebkeWQrOeUqOaIt+S4i+aLieWKqOS9nFxuICAgKi9cbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcbiAgICovXG4gIG9uUmVhY2hCb3R0b206IGZ1bmN0aW9uICgpIHtcblxuICB9LFxufSkiXX0=