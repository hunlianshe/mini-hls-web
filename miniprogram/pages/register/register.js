"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Api = require("../../service/api.service");
const utils = require("../../utils/utils");
const jobJson_1 = require("../../public/json/jobJson");
const app = getApp();
Page({
    data: {
        userInfo: { openid: '' },
        nickName: '',
        weChatId: '',
        gender: '',
        birth: '',
        height: '',
        salary: '',
        region: [],
        workCity: '',
        workProvince: '',
        workRegion: '',
        isMarriage: '',
        education: '',
        hasChild: '',
        wantChild: '',
        jobGeneral: '',
        jobDetail: '',
        haveHouse: '',
        genderIndex: 0,
        salaryIndex: 0,
        dateNow: '',
        submitDisable: false,
        isMarriageArray: ['未婚', '离婚'],
        genderArray: ['男', '女'],
        salaryArray: [
            '5千以下', '5千～1万', '1万～2万', '2万～5万', '5万以上'
        ],
        educationArray: [
            '小学', '初中', '高中', '大专', '大学本科', '硕士', '博士'
        ],
        hasChildArray: ['否', '是'],
        wantChildArray: ['是', '否'],
        haveHouseArray: ['已买房', '未买房'],
        multiIndex: [,],
        multiArray: [[], []],
        jobJson: jobJson_1.default,
    },
    onLoad: function () {
        const multiArray = [[], []];
        jobJson_1.default.data.forEach((item) => {
            multiArray[0].push(item.name);
        });
        jobJson_1.default.data[0].data.forEach((item) => {
            multiArray[1].push(item.name);
        });
        this.setData({
            multiArray,
            dateNow: this.getYMD(new Date())
        });
        this.getUserInfo();
    },
    getUserInfo() {
        const openid = app.globalData.userInfo.openid;
        Api.getUserInfo(openid || '').then((result) => {
            if (result) {
                this.setData({
                    userInfo: result.data,
                    nickName: result.data.nickName,
                    weChatId: result.data.weChatId,
                    gender: result.data.gender,
                    birth: result.data.birth ? this.getYMD(result.data.birth) : '',
                    height: result.data.height,
                    salary: result.data.salary,
                    workProvince: result.data.workProvince,
                    workCity: result.data.workCity,
                    workRegion: result.data.workRegion,
                    isMarriage: result.data.isMarriage,
                    education: result.data.education,
                    hasChild: result.data.hasChild,
                    wantChild: result.data.wantChild,
                    jobGeneral: result.data.jobGeneral,
                    jobDetail: result.data.jobDetail,
                    haveHouse: result.data.haveHouse,
                });
            }
        });
    },
    getYMD(dateStr) {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        let month = date.getMonth() + 1;
        let monthStr = month <= 9 ? `0${month}` : month;
        let day = date.getDate();
        let dayStr = day <= 9 ? `0${day}` : day;
        return `${year}-${monthStr}-${dayStr}`;
    },
    onSubmit(e) {
        let that = this;
        const value = e.detail.value;
        if (!utils.validateEmpty(value.nickName, '请输入昵称') ||
            (!utils.validateEmpty(value.weChatId, '请输入微信号') ||
                !utils.validateEmpty(value.gender, '请选择性别') ||
                !utils.validateEmpty(value.birth, '请选择生日') ||
                !utils.validateEmpty(value.height, '请输入身高') ||
                !utils.validateEmpty(value.salary, '请选择收入') ||
                !utils.validateEmpty(this.data.workProvince, '请选择工作所在地') ||
                !utils.validateEmpty(this.data.education, '请选择学历') ||
                !utils.validateEmpty(this.data.isMarriage, '请选择婚姻状况') ||
                !utils.validateEmpty(this.data.hasChild, '请选择是否有孩子') ||
                !utils.validateEmpty(this.data.wantChild, '请选择是否想要孩子') ||
                !utils.validateEmpty(this.data.haveHouse, '请选择买房情况'))) {
            return false;
        }
        that.doSubmit(e);
    },
    doSubmit(e) {
        const params = e.detail.value;
        const { userInfo } = this.data;
        const dataParams = {
            workProvince: this.data.workProvince,
            workCity: this.data.workCity,
            workRegion: this.data.workRegion,
            jobGeneral: this.data.jobGeneral,
            jobDetail: this.data.jobDetail,
        };
        this.setData({
            submitDisable: true
        });
        Api.updateUser(Object.assign(userInfo, params, dataParams)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                wx.showToast({
                    title: '更新成功',
                    icon: 'success',
                    duration: 1000,
                    mask: true
                });
                setTimeout(() => {
                    wx.switchTab({
                        url: `../myHome/myHome`,
                    });
                }, 1000);
            }
            else {
                utils.showModal('系统异常，请稍后再试');
            }
        });
    },
    bindBirthChange(e) {
        this.setData({
            birth: e.detail.value
        });
    },
    bindEducationChange(e) {
        const { educationArray } = this.data;
        this.setData({
            education: educationArray[e.detail.value]
        });
    },
    bindMarriageChange(e) {
        const { isMarriageArray } = this.data;
        this.setData({
            isMarriage: isMarriageArray[e.detail.value]
        });
    },
    bindHasChildChange(e) {
        const { hasChildArray } = this.data;
        this.setData({
            hasChild: hasChildArray[e.detail.value]
        });
    },
    bindWantChildChange(e) {
        const { wantChildArray } = this.data;
        this.setData({
            wantChild: wantChildArray[e.detail.value]
        });
    },
    bindHaveHouseChange(e) {
        const { haveHouseArray } = this.data;
        this.setData({
            haveHouse: haveHouseArray[e.detail.value]
        });
    },
    bindGenderChange(e) {
        this.setData({
            gender: parseInt(e.detail.value) + 1
        });
    },
    bindSalaryChange(e) {
        const { salaryArray } = this.data;
        this.setData({
            salary: salaryArray[e.detail.value]
        });
    },
    bindRegionChange: function (e) {
        let region = e.detail.value;
        this.setData({
            region,
            workProvince: region[0],
            workCity: region[1],
            workRegion: region[2],
        });
    },
    bindMultiPickerChange: function (e) {
        const { multiArray } = this.data;
        let multiIndex = e.detail.value;
        this.setData({
            multiIndex,
            jobGeneral: multiArray[0][multiIndex[0]],
            jobDetail: multiArray[1][multiIndex[1]],
        });
    },
    bindMultiPickerColumnChange: function (e) {
        const { multiArray, multiIndex } = this.data;
        multiIndex[e.detail.column] = e.detail.value;
        if (e.detail.column === 0) {
            multiArray[1] = [];
            jobJson_1.default.data[multiIndex[0] || 0].data.forEach((item) => {
                multiArray[1].push(item.name);
            });
        }
        this.setData({
            multiArray,
        });
    },
    bindDateChange: function (e) {
        this.setData({
            date: e.detail.value
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLGlEQUFpRDtBQUNqRCwyQ0FBMkM7QUFDM0MsdURBQWdEO0FBRWhELE1BQU0sR0FBRyxHQUFHLE1BQU0sRUFBVSxDQUFDO0FBRTdCLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7UUFDeEIsUUFBUSxFQUFFLEVBQUU7UUFDWixRQUFRLEVBQUUsRUFBRTtRQUNaLE1BQU0sRUFBRSxFQUFFO1FBQ1YsS0FBSyxFQUFFLEVBQUU7UUFDVCxNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxFQUFFO1FBQ1YsTUFBTSxFQUFFLEVBQUU7UUFDVixRQUFRLEVBQUUsRUFBRTtRQUNaLFlBQVksRUFBRSxFQUFFO1FBQ2hCLFVBQVUsRUFBRSxFQUFFO1FBQ2QsVUFBVSxFQUFFLEVBQUU7UUFDZCxTQUFTLEVBQUUsRUFBRTtRQUNiLFFBQVEsRUFBRSxFQUFFO1FBQ1osU0FBUyxFQUFFLEVBQUU7UUFDYixVQUFVLEVBQUUsRUFBRTtRQUNkLFNBQVMsRUFBRSxFQUFFO1FBQ2IsU0FBUyxFQUFFLEVBQUU7UUFDYixXQUFXLEVBQUUsQ0FBQztRQUNkLFdBQVcsRUFBRSxDQUFDO1FBQ2QsT0FBTyxFQUFFLEVBQUU7UUFDWCxhQUFhLEVBQUUsS0FBSztRQUNwQixlQUFlLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQzdCLFdBQVcsRUFBRSxDQUFDLEdBQUcsRUFBQyxHQUFHLENBQUM7UUFDdEIsV0FBVyxFQUFFO1lBQ1gsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU07U0FDMUM7UUFDRCxjQUFjLEVBQUU7WUFDZCxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFB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Q0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDN0MsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDekIsVUFBVSxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUNuQixpQkFBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQVMsRUFBRSxFQUFFO2dCQUMxRCxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNoQyxDQUFDLENBQUMsQ0FBQztTQUNKO1FBQ0QsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLFVBQVU7U0FFWCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0QsY0FBYyxFQUFFLFVBQVUsQ0FBSztRQUM3QixJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSztTQUNyQixDQUFDLENBQUE7SUFDSixDQUFDO0NBRUYsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgKiBhcyBBcGkgZnJvbSAnLi4vLi4vc2VydmljZS9hcGkuc2VydmljZSc7XG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgam9iSnNvbiBmcm9tICcuLi8uLi9wdWJsaWMvanNvbi9qb2JKc29uJztcbmltcG9ydCB7IElNeUFwcCB9IGZyb20gJy4uLy4uL2FwcCc7XG5jb25zdCBhcHAgPSBnZXRBcHA8SU15QXBwPigpO1xuXG5QYWdlKHtcbiAgZGF0YToge1xuICAgIHVzZXJJbmZvOiB7IG9wZW5pZDogJycgfSxcbiAgICBuaWNrTmFtZTogJycsXG4gICAgd2VDaGF0SWQ6ICcnLCAvLyDlvq7kv6Hlj7dcbiAgICBnZW5kZXI6ICcnLCBcbiAgICBiaXJ0aDogJycsICAgIC8vIOeUn+aXpVxuICAgIGhlaWdodDogJycsICAgLy8g6Lqr6auYXG4gICAgc2FsYXJ5OiAnJywgXG4gICAgcmVnaW9uOiBbXSxcbiAgICB3b3JrQ2l0eTogJycsXG4gICAgd29ya1Byb3ZpbmNlOiAnJyxcbiAgICB3b3JrUmVnaW9uOiAnJyxcbiAgICBpc01hcnJpYWdlOiAnJyxcbiAgICBlZHVjYXRpb246ICcnLCBcbiAgICBoYXNDaGlsZDogJycsIFxuICAgIHdhbnRDaGlsZDogJycsIFxuICAgIGpvYkdlbmVyYWw6ICcnLFxuICAgIGpvYkRldGFpbDogJycsXG4gICAgaGF2ZUhvdXNlOiAnJywgICBcbiAgICBnZW5kZXJJbmRleDogMCxcbiAgICBzYWxhcnlJbmRleDogMCxcbiAgICBkYXRlTm93OiAnJyxcbiAgICBzdWJtaXREaXNhYmxlOiBmYWxzZSxcbiAgICBpc01hcnJpYWdlQXJyYXk6IFsn5pyq5amaJywgJ+emu+WpmiddLFxuICAgIGdlbmRlckFycmF5OiBbJ+eUtycsJ+WlsyddLFxuICAgIHNhbGFyeUFycmF5OiBbXG4gICAgICAnNeWNg+S7peS4iycsICc15Y2D772eMeS4hycsICcx5LiH772eMuS4hycsICcy5LiH772eNeS4hycsICc15LiH5Lul5LiKJ1xuICAgIF0sXG4gICAgZWR1Y2F0aW9uQXJyYXk6IFtcbiAgICAgICflsI/lraYnLCAn5Yid5LitJywgJ+mrmOS4rScsICflpKfkuJMnLCAn5aSn5a2m5pys56eRJywgJ+ehleWjqycsICfljZrlo6snXG4gICAgXSxcbiAgICBoYXNDaGlsZEFycmF5OiBbJ+WQpicsICfmmK8nXSxcbiAgICB3YW50Q2hpbGRBcnJheTogWyfmmK8nLCAn5ZCmJ10sXG4gICAgaGF2ZUhvdXNlQXJyYXk6IFsn5bey5Lmw5oi/JywgJ+acquS5sOaIvyddLFxuICAgIG11bHRpSW5kZXg6IFssIF0sXG4gICAgbXVsdGlBcnJheTogW1tdLFtdXSBhcyBhbnksXG4gICAgam9iSnNvbjogam9iSnNvbixcbiAgfSxcblxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBtdWx0aUFycmF5ID0gW1tdLCBbXV0gYXMgYW55O1xuICAgIGpvYkpzb24uZGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcbiAgICAgIG11bHRpQXJyYXlbMF0ucHVzaChpdGVtLm5hbWUpO1xuICAgIH0pO1xuICAgIGpvYkpzb24uZGF0YVswXS5kYXRhLmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xuICAgICAgbXVsdGlBcnJheVsxXS5wdXNoKGl0ZW0ubmFtZSk7XG4gICAgfSk7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBtdWx0aUFycmF5LFxuICAgICAgZGF0ZU5vdzogdGhpcy5nZXRZTUQobmV3IERhdGUoKSlcbiAgICB9KTtcbiAgICB0aGlzLmdldFVzZXJJbmZvKCk7XG4gIH0sXG5cbiAgLyoqIOeUqOaIt+ivpuaDhSAqL1xuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCBvcGVuaWQgPSBhcHAuZ2xvYmFsRGF0YS51c2VySW5mby5vcGVuaWQ7XG4gICAgQXBpLmdldFVzZXJJbmZvKG9wZW5pZCB8fCAnJykudGhlbigocmVzdWx0OiBhbnkpID0+IHtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgICAgdXNlckluZm86IHJlc3VsdC5kYXRhLFxuICAgICAgICAgIG5pY2tOYW1lOiByZXN1bHQuZGF0YS5uaWNrTmFtZSxcbiAgICAgICAgICB3ZUNoYXRJZDogcmVzdWx0LmRhdGEud2VDaGF0SWQsXG4gICAgICAgICAgZ2VuZGVyOiByZXN1bHQuZGF0YS5nZW5kZXIsXG4gICAgICAgICAgYmlydGg6IHJlc3VsdC5kYXRhLmJpcnRoP3RoaXMuZ2V0WU1EKHJlc3VsdC5kYXRhLmJpcnRoKTonJywgICAgICAgIC8vIOeUn+aXpVxuICAgICAgICAgIGhlaWdodDogcmVzdWx0LmRhdGEuaGVpZ2h0LCAgICAgICAgICAgICAgICAgICAvLyDouqvpq5hcbiAgICAgICAgICBzYWxhcnk6IHJlc3VsdC5kYXRhLnNhbGFyeSxcbiAgICAgICAgICB3b3JrUHJvdmluY2U6IHJlc3VsdC5kYXRhLndvcmtQcm92aW5jZSxcbiAgICAgICAgICB3b3JrQ2l0eTogcmVzdWx0LmRhdGEud29ya0NpdHksXG4gICAgICAgICAgd29ya1JlZ2lvbjogcmVzdWx0LmRhdGEud29ya1JlZ2lvbiwgICAgICAgIFxuICAgICAgICAgIGlzTWFycmlhZ2U6IHJlc3VsdC5kYXRhLmlzTWFycmlhZ2UsICAgICAgICAgICAvLyDlqZrlp7vnirblhrVcbiAgICAgICAgICBlZHVjYXRpb246IHJlc3VsdC5kYXRhLmVkdWNhdGlvbiwgICAgICAgICAgICAgLy8g5pWZ6IKyXG4gICAgICAgICAgaGFzQ2hpbGQ6IHJlc3VsdC5kYXRhLmhhc0NoaWxkLFxuICAgICAgICAgIHdhbnRDaGlsZDogcmVzdWx0LmRhdGEud2FudENoaWxkLFxuICAgICAgICAgIGpvYkdlbmVyYWw6IHJlc3VsdC5kYXRhLmpvYkdlbmVyYWwsXG4gICAgICAgICAgam9iRGV0YWlsOiByZXN1bHQuZGF0YS5qb2JEZXRhaWwsXG4gICAgICAgICAgaGF2ZUhvdXNlOiByZXN1bHQuZGF0YS5oYXZlSG91c2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pXG4gIH0sXG5cbiAgZ2V0WU1EKGRhdGVTdHI6IGFueSkge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyKTtcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGxldCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgbGV0IG1vbnRoU3RyID0gbW9udGggPD0gOSA/IGAwJHttb250aH1gIDogbW9udGg7XG4gICAgbGV0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIGxldCBkYXlTdHIgPSBkYXkgPD0gOSA/IGAwJHtkYXl9YCA6IGRheTtcbiAgICByZXR1cm4gYCR7eWVhcn0tJHttb250aFN0cn0tJHtkYXlTdHJ9YFxuICB9LFxuXG4gIC8qKiDlh4blpIfmj5DkuqQgKi9cbiAgb25TdWJtaXQoZTogYW55KTogYW55IHtcbiAgICBsZXQgdGhhdCA9IHRoaXM7XG4gICAgY29uc3QgdmFsdWUgPSBlLmRldGFpbC52YWx1ZTtcblxuICAgIGlmICghdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5uaWNrTmFtZSwgJ+ivt+i+k+WFpeaYteensCcpIHx8XG4gICAgICAoIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUud2VDaGF0SWQsICfor7fovpPlhaXlvq7kv6Hlj7cnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuZ2VuZGVyLCAn6K+36YCJ5oup5oCn5YirJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLmJpcnRoLCAn6K+36YCJ5oup55Sf5pelJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLmhlaWdodCwgJ+ivt+i+k+WFpei6q+mrmCcpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5zYWxhcnksICfor7fpgInmi6nmlLblhaUnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLndvcmtQcm92aW5jZSwgJ+ivt+mAieaLqeW3peS9nOaJgOWcqOWcsCcpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuZWR1Y2F0aW9uLCAn6K+36YCJ5oup5a2m5Y6GJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5pc01hcnJpYWdlLCAn6K+36YCJ5oup5ama5ae754q25Ya1JykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5oYXNDaGlsZCwgJ+ivt+mAieaLqeaYr+WQpuacieWtqeWtkCcpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEud2FudENoaWxkLCAn6K+36YCJ5oup5piv5ZCm5oOz6KaB5a2p5a2QJykgfHxcbiAgICAgIC8vICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5qb2JHZW5lcmFsLCAn6K+36YCJ5oup6IGM5LiaJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5oYXZlSG91c2UsICfor7fpgInmi6nkubDmiL/mg4XlhrUnKSkpIHtcblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRoYXQuZG9TdWJtaXQoZSk7XG4gIH0sXG5cbiAgLyoqIHVwZGF0ZSAqL1xuICBkb1N1Ym1pdChlOiBhbnkpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBlLmRldGFpbC52YWx1ZTtcbiAgICBjb25zdCB7IHVzZXJJbmZvIH0gPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgZGF0YVBhcmFtcyA9IHtcbiAgICAgIHdvcmtQcm92aW5jZTogdGhpcy5kYXRhLndvcmtQcm92aW5jZSxcbiAgICAgIHdvcmtDaXR5OiB0aGlzLmRhdGEud29ya0NpdHksXG4gICAgICB3b3JrUmVnaW9uOiB0aGlzLmRhdGEud29ya1JlZ2lvbixcbiAgICAgIGpvYkdlbmVyYWw6IHRoaXMuZGF0YS5qb2JHZW5lcmFsLFxuICAgICAgam9iRGV0YWlsOiB0aGlzLmRhdGEuam9iRGV0YWlsLFxuICAgIH1cbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHN1Ym1pdERpc2FibGU6IHRydWVcbiAgICB9KTtcbiAgICBBcGkudXBkYXRlVXNlcihPYmplY3QuYXNzaWduKHVzZXJJbmZvLCBwYXJhbXMsIGRhdGFQYXJhbXMpKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgd3guaGlkZUxvYWRpbmcoKTsgXG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgc3VibWl0RGlzYWJsZTogdHJ1ZVxuICAgICAgfSk7ICAgICBcbiAgICAgIGlmIChyZXN1bHQuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgICAgdGl0bGU6ICfmm7TmlrDmiJDlip8nLFxuICAgICAgICAgIGljb246ICdzdWNjZXNzJyxcbiAgICAgICAgICBkdXJhdGlvbjogMTAwMCxcbiAgICAgICAgICBtYXNrOiB0cnVlXG4gICAgICAgIH0pXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHd4LnN3aXRjaFRhYih7XG4gICAgICAgICAgICB1cmw6IGAuLi9teUhvbWUvbXlIb21lYCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSwgMTAwMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1dGlscy5zaG93TW9kYWwoJ+ezu+e7n+W8guW4uO+8jOivt+eojeWQjuWGjeivlScpO1xuICAgICAgfVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOeUn+aXpSAqL1xuICBiaW5kQmlydGhDaGFuZ2UoZTogYW55KSB7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBiaXJ0aDogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuXG4gIGJpbmRFZHVjYXRpb25DaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBlZHVjYXRpb25BcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBlZHVjYXRpb246IGVkdWNhdGlvbkFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOWpmuWnuyAqL1xuICBiaW5kTWFycmlhZ2VDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBpc01hcnJpYWdlQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgaXNNYXJyaWFnZTogaXNNYXJyaWFnZUFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZEhhc0NoaWxkQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgaGFzQ2hpbGRBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBoYXNDaGlsZDogaGFzQ2hpbGRBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIGJpbmRXYW50Q2hpbGRDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyB3YW50Q2hpbGRBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICB3YW50Q2hpbGQ6IHdhbnRDaGlsZEFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOS5sOaIvyAqL1xuICBiaW5kSGF2ZUhvdXNlQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgaGF2ZUhvdXNlQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgaGF2ZUhvdXNlOiBoYXZlSG91c2VBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDmgKfliKsgKi9cbiAgYmluZEdlbmRlckNoYW5nZShlOiBhbnkpIHtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGdlbmRlcjogcGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpICsgMVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKiDmnIjmlLblhaUgKi9cbiAgYmluZFNhbGFyeUNoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IHNhbGFyeUFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHNhbGFyeTogc2FsYXJ5QXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqIOW3peS9nOWcsOWMuiAqL1xuICBiaW5kUmVnaW9uQ2hhbmdlOiBmdW5jdGlvbiAoZTphbnkpIHtcbiAgICBsZXQgcmVnaW9uID0gZS5kZXRhaWwudmFsdWU7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICByZWdpb24sXG4gICAgICB3b3JrUHJvdmluY2U6IHJlZ2lvblswXSxcbiAgICAgIHdvcmtDaXR5OiByZWdpb25bMV0sXG4gICAgICB3b3JrUmVnaW9uOiByZWdpb25bMl0sXG4gICAgfSk7XG4gIH0sXG5cbiAgYmluZE11bHRpUGlja2VyQ2hhbmdlOiBmdW5jdGlvbiAoZTogYW55KSB7XG4gICAgY29uc3QgeyBtdWx0aUFycmF5IH0gPSB0aGlzLmRhdGE7XG4gICAgbGV0IG11bHRpSW5kZXggPSBlLmRldGFpbC52YWx1ZTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIG11bHRpSW5kZXgsXG4gICAgICBqb2JHZW5lcmFsOiBtdWx0aUFycmF5WzBdW211bHRpSW5kZXhbMF1dLFxuICAgICAgam9iRGV0YWlsOiBtdWx0aUFycmF5WzFdW211bHRpSW5kZXhbMV1dLFxuICAgIH0pXG4gIH0sXG5cbiAgYmluZE11bHRpUGlja2VyQ29sdW1uQ2hhbmdlOiBmdW5jdGlvbiAoZTogYW55KSB7XG4gICAgY29uc3QgeyBtdWx0aUFycmF5LCBtdWx0aUluZGV4IH0gPSB0aGlzLmRhdGE7XG4gICAgbXVsdGlJbmRleFtlLmRldGFpbC5jb2x1bW5dID0gZS5kZXRhaWwudmFsdWU7XG4gICAgaWYgKGUuZGV0YWlsLmNvbHVtbiA9PT0gMCkge1xuICAgICAgbXVsdGlBcnJheVsxXSA9IFtdO1xuICAgICAgam9iSnNvbi5kYXRhW211bHRpSW5kZXhbMF0gfHwgMF0uZGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgbXVsdGlBcnJheVsxXS5wdXNoKGl0ZW0ubmFtZSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBtdWx0aUFycmF5LFxuICAgICAgLy8gbXVsdGlJbmRleCxcbiAgICB9KTtcbiAgfSxcbiAgYmluZERhdGVDaGFuZ2U6IGZ1bmN0aW9uIChlOmFueSkge1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgZGF0ZTogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuIFxufSkiXX0=