"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Api = require("../../service/api.service");
const utils = require("../../utils/utils");
const jobJson_1 = require("../../public/json/jobJson");
const app = getApp();
Page({
    data: {
        user: { openid: '' },
        nickName: '',
        gender: '',
        birth: '',
        height: '',
        salary: '',
        region: [],
        isMarriage: '',
        education: '',
        hasChild: '',
        wantChild: '',
        jobGeneral: '',
        haveHouse: '',
        genderIndex: 0,
        salaryIndex: 0,
        dateNow: '',
        submitDisable: false,
        isMarriageArray: ['未婚', '离婚'],
        genderArray: ['男', '女'],
        salaryArray: [
            '5千以下', '5千～1万', '1万～2万', '2万～5万', '5万以上'
        ],
        educationArray: [
            '小学', '初中', '高中', '大专', '大学本科', '硕士', '博士'
        ],
        hasChildArray: ['是', '否'],
        wantChildArray: ['是', '否'],
        haveHouseArray: ['已买房', '未买房'],
        multiIndex: [,],
        multiArray: [[], []],
        jobJson: jobJson_1.default,
    },
    onLoad: function () {
        let _this = this;
        wx.getStorage({
            key: 'user',
            success: function (res) {
                _this.setData({
                    user: res.data
                });
            },
        });
        const multiArray = [[], []];
        jobJson_1.default.data.forEach((item) => {
            multiArray[0].push(item.name);
        });
        jobJson_1.default.data[0].data.forEach((item) => {
            multiArray[1].push(item.name);
        });
        console.log(multiArray);
        this.setData({
            multiArray,
            dateNow: this.getYMD(new Date())
        });
        this.getUserInfo();
    },
    getUserInfo() {
        const openid = app.globalData.userInfo.openid;
        Api.getUserInfo(openid || '').then((result) => {
            if (result) {
                this.setData({
                    nickName: result.data.nickName,
                    gender: result.data.gender,
                    birth: this.getYMD(result.data.birth),
                    height: result.data.height,
                    salary: result.data.salary,
                    workProvince: result.data.region && result.data.region[0] ? result.data.region[0] : '',
                    workCity: result.data.region && result.data.region[0] ? result.data.region[0] : '',
                    workRegion: result.data.region && result.data.region[0] ? result.data.region[0] : '',
                    isMarriage: result.data.isMarriage,
                    education: result.data.education,
                    hasChild: result.data.hasChild,
                    wantChild: result.data.wantChild,
                    jobGeneral: result.data.jobGeneral,
                    jobDetail: result.data.jobDetail,
                    haveHouse: result.data.haveHouse,
                });
                console.log('data', this.data);
            }
        });
    },
    getYMD(dateStr) {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        let month = date.getMonth() + 1;
        let monthStr = month <= 9 ? `0${month}` : month;
        let day = date.getDate();
        let dayStr = day <= 9 ? `0${day}` : day;
        return `${year}-${monthStr}-${dayStr}`;
    },
    onSubmit(e) {
        let that = this;
        const value = e.detail.value;
        if (!utils.validateEmpty(value.nickName, '请输入昵称') ||
            !utils.validateEmpty(value.gender, '请选择性别') ||
            !utils.validateEmpty(value.birth, '请选择生日') ||
            !utils.validateEmpty(value.height, '请输入身高') ||
            !utils.validateEmpty(value.salary, '请选择收入') ||
            !utils.validateEmpty(this.data.region[0], '请选择工作所在地') ||
            !utils.validateEmpty(this.data.education, '请选择学历') ||
            !utils.validateEmpty(this.data.isMarriage, '请选择婚姻状况') ||
            !utils.validateEmpty(this.data.hasChild, '请选择是否有孩子') ||
            !utils.validateEmpty(this.data.wantChild, '请选择是否想要孩子') ||
            !utils.validateEmpty(this.data.haveHouse, '请选择买房情况')) {
            return false;
        }
        that.doSubmit(e);
    },
    doSubmit(e) {
        const params = e.detail.value;
        const { openid } = this.data.user;
        const origin = {
            workProvince: this.data.region[0],
            workCity: this.data.region[1],
            workRegion: this.data.region[2],
        };
        const job = {};
        this.setData({
            submitDisable: true
        });
        Api.updateUser(Object.assign({ openid }, params, origin, job)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                utils.showModal('更新成功');
                setTimeout(() => {
                    wx.switchTab({
                        url: `../myHome/myHome`,
                    });
                }, 1000);
            }
            else {
                utils.showModal('系统异常，请稍后再试');
            }
        });
    },
    bindBirthChange(e) {
        this.setData({
            birth: e.detail.value
        });
    },
    bindEducationChange(e) {
        const { educationArray } = this.data;
        this.setData({
            education: educationArray[e.detail.value]
        });
    },
    bindMarriageChange(e) {
        const { isMarriageArray } = this.data;
        this.setData({
            isMarriage: isMarriageArray[e.detail.value]
        });
    },
    bindHasChildChange(e) {
        const { hasChildArray } = this.data;
        this.setData({
            hasChild: hasChildArray[e.detail.value]
        });
    },
    bindWantChildChange(e) {
        const { wantChildArray } = this.data;
        this.setData({
            wantChild: wantChildArray[e.detail.value]
        });
    },
    bindHaveHouseChange(e) {
        const { haveHouseArray } = this.data;
        this.setData({
            haveHouse: haveHouseArray[e.detail.value]
        });
    },
    bindGenderChange(e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            gender: parseInt(e.detail.value) + 1
        });
        console.log('parseInt(e.detail.value)', (parseInt(e.detail.value) + 1));
    },
    bindSalaryChange(e) {
        const { salaryArray } = this.data;
        this.setData({
            salary: salaryArray[e.detail.value]
        });
    },
    bindRegionChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            region: e.detail.value,
        });
    },
    bindMultiPickerChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            multiIndex: e.detail.value
        });
    },
    bindMultiPickerColumnChange: function (e) {
        console.log('修改的列为', e.detail.column, '，值为', e.detail.value);
        const { multiArray, multiIndex } = this.data;
        multiIndex[e.detail.column] = e.detail.value;
        if (e.detail.column === 0) {
            multiArray[1] = [];
            console.log(jobJson_1.default.data[multiIndex[0] || 0].data);
            jobJson_1.default.data[multiIndex[0] || 0].data.forEach((item) => {
                multiArray[1].push(item.name);
                console.log(multiArray[1]);
            });
        }
        console.log(multiIndex);
        console.log(multiArray);
        this.setData({
            multiArray,
            multiIndex,
        });
    },
    bindDateChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            date: e.detail.value
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLGlEQUFpRDtBQUNqRCwyQ0FBMkM7QUFDM0MsdURBQWdEO0FBRWhELE1BQU0sR0FBRyxHQUFHLE1BQU0sRUFBVSxDQUFDO0FBRTdCLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7UUFDcEIsUUFBUSxFQUFFLEVBQUU7UUFDWixNQUFNLEVBQUUsRUFBRTtRQUNWLEtBQUssRUFBRSxFQUFFO1FBQ1QsTUFBTSxFQUFFLEVBQUU7UUFDVixNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxFQUFFO1FBQ1YsVUFBVSxFQUFFLEVBQUU7UUFDZCxTQUFTLEVBQUUsRUFBRTtRQUNiLFFBQVEsRUFBRSxFQUFFO1FBQ1osU0FBUyxFQUFFLEVBQUU7UUFDYixVQUFVLEVBQUUsRUFBRTtRQUNkLFNBQVMsRUFBRSxFQUFFO1FBQ2IsV0FBVyxFQUFFLENBQUM7UUFDZCxXQUFXLEVBQUUsQ0FBQztRQUNkLE9BQU8sRUFBRSxFQUFFO1FBQ1gsYUFBYSxFQUFFLEtBQUs7UUFDcEIsZUFBZSxFQUFFLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUM3QixXQUFXLEVBQUUsQ0FBQyxHQUFHLEVBQUMsR0FBRyxDQUFDO1FBQ3RCLFdBQVcsRUFBRTtZQUNYLE1BQU0sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNO1NBQzFDO1FBQ0QsY0FBYyxFQUFFO1lBQ2QsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSTtTQUMzQztRQUNELGFBQWEsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDekIsY0FBYyxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUMxQixjQUFjLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDO1FBQzlCLFVBQVUsRUFBRSxDQUFDLEVBQUc7UUFDaEIsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFDLEVBQUUsQ0FBUTtRQUMxQixPQUFPLEVBQUUsaUJBQU87S0FDakI7SUFFRCxNQUFNLEVBQUU7UUFDTixJQUFJLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDakIsRUFBRSxDQUFDLFVBQVUsQ0FBQztZQUNaLEdBQUcsRUFBRSxNQUFNO1lBQ1gsT0FBTyxFQUFFLFVBQVUsR0FBRztnQkFDcEIsS0FBSyxDQUFDLE9BQVEsQ0FBQztvQkFDYixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUk7aUJBQ2YsQ0FBQyxDQUFBO1lBQ0osQ0FBQztTQUNGLENBQUMsQ0FBQztRQUNILE1BQU0sVUFBVSxHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBUSxDQUFDO1FBQ25DLGlCQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQVMsRUFBRSxFQUFFO1lBQ2pDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO1FBQ0gsaUJBQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQVMsRUFBRSxFQUFFO1lBQ3pDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osVUFBVTtZQUNWLE9BQU8sRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUM7U0FDakMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JCLENBQUM7SUFHRCxXQUFXO1FBQ1QsTUFBTSxNQUFNLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBQzlDLEdBQUcsQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQVcsRUFBRSxFQUFFO1lBQ2pELElBQUksTUFBTSxFQUFFO2dCQUNWLElBQUksQ0FBQyxPQUFRLENBQUM7b0JBQ1osUUFBUSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUTtvQkFDOUIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTTtvQkFDMUIsS0FBSyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7b0JBQ3JDLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU07b0JBQzFCLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU07b0JBQzFCLFlBQVksRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ3RGLFFBQVEsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ2xGLFVBQVUsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FB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QUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3hCLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDeEIsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLFVBQVU7WUFDVixVQUFVO1NBQ1gsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNELGNBQWMsRUFBRSxVQUFVLENBQUs7UUFDN0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ2hELElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ3JCLENBQUMsQ0FBQTtJQUNKLENBQUM7Q0FFRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCAqIGFzIEFwaSBmcm9tICcuLi8uLi9zZXJ2aWNlL2FwaS5zZXJ2aWNlJztcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCBqb2JKc29uIGZyb20gJy4uLy4uL3B1YmxpYy9qc29uL2pvYkpzb24nO1xuaW1wb3J0IHsgSU15QXBwIH0gZnJvbSAnLi4vLi4vYXBwJztcbmNvbnN0IGFwcCA9IGdldEFwcDxJTXlBcHA+KCk7XG5cblBhZ2Uoe1xuICBkYXRhOiB7XG4gICAgdXNlcjogeyBvcGVuaWQ6ICcnIH0sXG4gICAgbmlja05hbWU6ICcnLFxuICAgIGdlbmRlcjogJycsIFxuICAgIGJpcnRoOiAnJywgICAgICAgICAgICAvLyDnlJ/ml6VcbiAgICBoZWlnaHQ6ICcnLCAgICAgICAgICAgLy8g6Lqr6auYXG4gICAgc2FsYXJ5OiAnJywgXG4gICAgcmVnaW9uOiBbXSwgXG4gICAgaXNNYXJyaWFnZTogJycsXG4gICAgZWR1Y2F0aW9uOiAnJywgXG4gICAgaGFzQ2hpbGQ6ICcnLCBcbiAgICB3YW50Q2hpbGQ6ICcnLCBcbiAgICBqb2JHZW5lcmFsOiAnJyxcbiAgICBoYXZlSG91c2U6ICcnLCAgIFxuICAgIGdlbmRlckluZGV4OiAwLFxuICAgIHNhbGFyeUluZGV4OiAwLFxuICAgIGRhdGVOb3c6ICcnLFxuICAgIHN1Ym1pdERpc2FibGU6IGZhbHNlLFxuICAgIGlzTWFycmlhZ2VBcnJheTogWyfmnKrlqZonLCAn56a75amaJ10sXG4gICAgZ2VuZGVyQXJyYXk6IFsn55S3Jywn5aWzJ10sXG4gICAgc2FsYXJ5QXJyYXk6IFtcbiAgICAgICc15Y2D5Lul5LiLJywgJzXljYPvvZ4x5LiHJywgJzHkuIfvvZ4y5LiHJywgJzLkuIfvvZ415LiHJywgJzXkuIfku6XkuIonXG4gICAgXSxcbiAgICBlZHVjYXRpb25BcnJheTogW1xuICAgICAgJ+Wwj+WtpicsICfliJ3kuK0nLCAn6auY5LitJywgJ+Wkp+S4kycsICflpKflrabmnKznp5EnLCAn56GV5aOrJywgJ+WNmuWjqydcbiAgICBdLFxuICAgIGhhc0NoaWxkQXJyYXk6IFsn5pivJywgJ+WQpiddLFxuICAgIHdhbnRDaGlsZEFycmF5OiBbJ+aYrycsICflkKYnXSxcbiAgICBoYXZlSG91c2VBcnJheTogWyflt7LkubDmiL8nLCAn5pyq5Lmw5oi/J10sXG4gICAgbXVsdGlJbmRleDogWywgXSxcbiAgICBtdWx0aUFycmF5OiBbW10sW11dIGFzIGFueSxcbiAgICBqb2JKc29uOiBqb2JKc29uLFxuICB9LFxuXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgd3guZ2V0U3RvcmFnZSh7XG4gICAgICBrZXk6ICd1c2VyJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgX3RoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIHVzZXI6IHJlcy5kYXRhXG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgIH0pOyAgXG4gICAgY29uc3QgbXVsdGlBcnJheSA9IFtbXSwgW11dIGFzIGFueTtcbiAgICBqb2JKc29uLmRhdGEuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XG4gICAgICBtdWx0aUFycmF5WzBdLnB1c2goaXRlbS5uYW1lKTtcbiAgICB9KTtcbiAgICBqb2JKc29uLmRhdGFbMF0uZGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcbiAgICAgIG11bHRpQXJyYXlbMV0ucHVzaChpdGVtLm5hbWUpO1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKG11bHRpQXJyYXkpO1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgbXVsdGlBcnJheSxcbiAgICAgIGRhdGVOb3c6IHRoaXMuZ2V0WU1EKG5ldyBEYXRlKCkpXG4gICAgfSk7XG4gICAgdGhpcy5nZXRVc2VySW5mbygpO1xuICB9LFxuXG4gIC8qKiDnlKjmiLfor6bmg4UgKi9cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3Qgb3BlbmlkID0gYXBwLmdsb2JhbERhdGEudXNlckluZm8ub3BlbmlkO1xuICAgIEFwaS5nZXRVc2VySW5mbyhvcGVuaWQgfHwgJycpLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIG5pY2tOYW1lOiByZXN1bHQuZGF0YS5uaWNrTmFtZSxcbiAgICAgICAgICBnZW5kZXI6IHJlc3VsdC5kYXRhLmdlbmRlcixcbiAgICAgICAgICBiaXJ0aDogdGhpcy5nZXRZTUQocmVzdWx0LmRhdGEuYmlydGgpLCAgICAgICAgLy8g55Sf5pelXG4gICAgICAgICAgaGVpZ2h0OiByZXN1bHQuZGF0YS5oZWlnaHQsICAgICAgICAgICAgICAgICAgIC8vIOi6q+mrmFxuICAgICAgICAgIHNhbGFyeTogcmVzdWx0LmRhdGEuc2FsYXJ5LFxuICAgICAgICAgIHdvcmtQcm92aW5jZTogcmVzdWx0LmRhdGEucmVnaW9uICYmIHJlc3VsdC5kYXRhLnJlZ2lvblswXSA/IHJlc3VsdC5kYXRhLnJlZ2lvblswXSA6ICcnLFxuICAgICAgICAgIHdvcmtDaXR5OiByZXN1bHQuZGF0YS5yZWdpb24gJiYgcmVzdWx0LmRhdGEucmVnaW9uWzBdID8gcmVzdWx0LmRhdGEucmVnaW9uWzBdIDogJycsXG4gICAgICAgICAgd29ya1JlZ2lvbjogcmVzdWx0LmRhdGEucmVnaW9uICYmIHJlc3VsdC5kYXRhLnJlZ2lvblswXSA/IHJlc3VsdC5kYXRhLnJlZ2lvblswXSA6ICcnLCAgICAgICAgXG4gICAgICAgICAgaXNNYXJyaWFnZTogcmVzdWx0LmRhdGEuaXNNYXJyaWFnZSwgICAgICAgICAgIC8vIOWpmuWnu+eKtuWGtVxuICAgICAgICAgIGVkdWNhdGlvbjogcmVzdWx0LmRhdGEuZWR1Y2F0aW9uLCAgICAgICAgICAgICAvLyDmlZnogrJcbiAgICAgICAgICBoYXNDaGlsZDogcmVzdWx0LmRhdGEuaGFzQ2hpbGQsXG4gICAgICAgICAgd2FudENoaWxkOiByZXN1bHQuZGF0YS53YW50Q2hpbGQsXG4gICAgICAgICAgam9iR2VuZXJhbDogcmVzdWx0LmRhdGEuam9iR2VuZXJhbCxcbiAgICAgICAgICBqb2JEZXRhaWw6IHJlc3VsdC5kYXRhLmpvYkRldGFpbCxcbiAgICAgICAgICBoYXZlSG91c2U6IHJlc3VsdC5kYXRhLmhhdmVIb3VzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdkYXRhJywgdGhpcy5kYXRhKTtcbiAgICAgIH1cbiAgICB9KVxuICB9LFxuXG4gIGdldFlNRChkYXRlU3RyOiBhbnkpIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cik7XG4gICAgY29uc3QgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICBsZXQgbW9udGggPSBkYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgIGxldCBtb250aFN0ciA9IG1vbnRoIDw9IDkgPyBgMCR7bW9udGh9YCA6IG1vbnRoO1xuICAgIGxldCBkYXkgPSBkYXRlLmdldERhdGUoKTtcbiAgICBsZXQgZGF5U3RyID0gZGF5IDw9IDkgPyBgMCR7ZGF5fWAgOiBkYXk7XG4gICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGhTdHJ9LSR7ZGF5U3RyfWBcbiAgfSxcblxuICAvKiog5YeG5aSH5o+Q5LqkICovXG4gIG9uU3VibWl0KGU6IGFueSk6IGFueSB7XG4gICAgbGV0IHRoYXQgPSB0aGlzO1xuICAgIGNvbnN0IHZhbHVlID0gZS5kZXRhaWwudmFsdWU7XG5cbiAgICBpZiAoIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUubmlja05hbWUsICfor7fovpPlhaXmmLXnp7AnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuZ2VuZGVyLCAn6K+36YCJ5oup5oCn5YirJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLmJpcnRoLCAn6K+36YCJ5oup55Sf5pelJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLmhlaWdodCwgJ+ivt+i+k+WFpei6q+mrmCcpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5zYWxhcnksICfor7fpgInmi6nmlLblhaUnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLnJlZ2lvblswXSwgJ+ivt+mAieaLqeW3peS9nOaJgOWcqOWcsCcpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuZWR1Y2F0aW9uLCAn6K+36YCJ5oup5a2m5Y6GJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5pc01hcnJpYWdlLCAn6K+36YCJ5oup5ama5ae754q25Ya1JykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5oYXNDaGlsZCwgJ+ivt+mAieaLqeaYr+WQpuacieWtqeWtkCcpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEud2FudENoaWxkLCAn6K+36YCJ5oup5piv5ZCm5oOz6KaB5a2p5a2QJykgfHxcbiAgICAgIC8vICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5qb2JHZW5lcmFsLCAn6K+36YCJ5oup6IGM5LiaJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5oYXZlSG91c2UsICfor7fpgInmi6nkubDmiL/mg4XlhrUnKSkge1xuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhhdC5kb1N1Ym1pdChlKTtcbiAgfSxcblxuICAvKiogdXBkYXRlICovXG4gIGRvU3VibWl0KGU6IGFueSkge1xuICAgIGNvbnN0IHBhcmFtcyA9IGUuZGV0YWlsLnZhbHVlO1xuICAgIGNvbnN0IHsgb3BlbmlkIH0gPSB0aGlzLmRhdGEudXNlcjtcbiAgICBjb25zdCBvcmlnaW4gPSB7XG4gICAgICB3b3JrUHJvdmluY2U6IHRoaXMuZGF0YS5yZWdpb25bMF0sXG4gICAgICB3b3JrQ2l0eTogdGhpcy5kYXRhLnJlZ2lvblsxXSxcbiAgICAgIHdvcmtSZWdpb246IHRoaXMuZGF0YS5yZWdpb25bMl0sXG4gICAgfVxuICAgIGNvbnN0IGpvYiA9IHt9O1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgc3VibWl0RGlzYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEFwaS51cGRhdGVVc2VyKE9iamVjdC5hc3NpZ24oeyBvcGVuaWQgfSwgcGFyYW1zLCBvcmlnaW4sIGpvYikpLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICB3eC5oaWRlTG9hZGluZygpOyBcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBzdWJtaXREaXNhYmxlOiB0cnVlXG4gICAgICB9KTsgICAgIFxuICAgICAgaWYgKHJlc3VsdC5jb2RlID09PSAyMDApIHtcbiAgICAgICAgdXRpbHMuc2hvd01vZGFsKCfmm7TmlrDmiJDlip8nKVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB3eC5zd2l0Y2hUYWIoe1xuICAgICAgICAgICAgdXJsOiBgLi4vbXlIb21lL215SG9tZWAsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sIDEwMDApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXRpbHMuc2hvd01vZGFsKCfns7vnu5/lvILluLjvvIzor7fnqI3lkI7lho3or5UnKTtcbiAgICAgIH1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDnlJ/ml6UgKi9cbiAgYmluZEJpcnRoQ2hhbmdlKGU6IGFueSkge1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgYmlydGg6IGUuZGV0YWlsLnZhbHVlXG4gICAgfSlcbiAgfSxcblxuICBiaW5kRWR1Y2F0aW9uQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgZWR1Y2F0aW9uQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgZWR1Y2F0aW9uOiBlZHVjYXRpb25BcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDlqZrlp7sgKi9cbiAgYmluZE1hcnJpYWdlQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgaXNNYXJyaWFnZUFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGlzTWFycmlhZ2U6IGlzTWFycmlhZ2VBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIGJpbmRIYXNDaGlsZENoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGhhc0NoaWxkQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgaGFzQ2hpbGQ6IGhhc0NoaWxkQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICBiaW5kV2FudENoaWxkQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgd2FudENoaWxkQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgd2FudENoaWxkOiB3YW50Q2hpbGRBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDkubDmiL8gKi9cbiAgYmluZEhhdmVIb3VzZUNoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGhhdmVIb3VzZUFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGhhdmVIb3VzZTogaGF2ZUhvdXNlQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICAvKiog5oCn5YirICovXG4gIGJpbmRHZW5kZXJDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgZ2VuZGVyOiBwYXJzZUludChlLmRldGFpbC52YWx1ZSkgKyAxXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coJ3BhcnNlSW50KGUuZGV0YWlsLnZhbHVlKScsIChwYXJzZUludChlLmRldGFpbC52YWx1ZSkgKyAxKSlcbiAgfSxcblxuICAvKiog5pyI5pS25YWlICovXG4gIGJpbmRTYWxhcnlDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBzYWxhcnlBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBzYWxhcnk6IHNhbGFyeUFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKiDlt6XkvZzlnLDljLogKi9cbiAgYmluZFJlZ2lvbkNoYW5nZTogZnVuY3Rpb24gKGU6YW55KSB7XG4gICAgY29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgcmVnaW9uOiBlLmRldGFpbC52YWx1ZSxcbiAgICB9KTtcbiAgfSxcblxuICBiaW5kTXVsdGlQaWNrZXJDaGFuZ2U6IGZ1bmN0aW9uIChlOiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZygncGlja2Vy5Y+R6YCB6YCJ5oup5pS55Y+Y77yM5pC65bim5YC85Li6JywgZS5kZXRhaWwudmFsdWUpXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBtdWx0aUluZGV4OiBlLmRldGFpbC52YWx1ZVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZE11bHRpUGlja2VyQ29sdW1uQ2hhbmdlOiBmdW5jdGlvbiAoZTogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ+S/ruaUueeahOWIl+S4uicsIGUuZGV0YWlsLmNvbHVtbiwgJ++8jOWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKTtcbiAgICBjb25zdCB7IG11bHRpQXJyYXksIG11bHRpSW5kZXggfSA9IHRoaXMuZGF0YTtcbiAgICBtdWx0aUluZGV4W2UuZGV0YWlsLmNvbHVtbl0gPSBlLmRldGFpbC52YWx1ZTtcbiAgICBpZiAoZS5kZXRhaWwuY29sdW1uID09PSAwKSB7XG4gICAgICBtdWx0aUFycmF5WzFdID0gW107XG4gICAgICBjb25zb2xlLmxvZyhqb2JKc29uLmRhdGFbbXVsdGlJbmRleFswXSB8fCAwXS5kYXRhKTtcbiAgICAgIGpvYkpzb24uZGF0YVttdWx0aUluZGV4WzBdIHx8IDBdLmRhdGEuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgIG11bHRpQXJyYXlbMV0ucHVzaChpdGVtLm5hbWUpO1xuICAgICAgICBjb25zb2xlLmxvZyhtdWx0aUFycmF5WzFdKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhtdWx0aUluZGV4KTtcbiAgICBjb25zb2xlLmxvZyhtdWx0aUFycmF5KTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIG11bHRpQXJyYXksXG4gICAgICBtdWx0aUluZGV4LFxuICAgIH0pO1xuICB9LFxuICBiaW5kRGF0ZUNoYW5nZTogZnVuY3Rpb24gKGU6YW55KSB7XG4gICAgY29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgZGF0ZTogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuIFxufSkiXX0=