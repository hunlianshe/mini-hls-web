"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Api = require("../../service/api.service");
const utils = require("../../utils/utils");
const jobJson_1 = require("../../public/json/jobJson");
Page({
    data: {
        user: { openid: '' },
        nickName: '',
        gender: '',
        birth: '',
        height: '',
        salary: '',
        region: [],
        isMarriage: '未婚',
        education: '',
        hasChild: '',
        wantChild: '',
        jobGeneral: '',
        haveHouse: '',
        genderIndex: 0,
        salaryIndex: 0,
        dateNow: '',
        submitDisable: false,
        isMarriageArray: ['未婚', '离异'],
        genderArray: ['男', '女'],
        salaryArray: [
            '5千以下', '5千～1万', '1万～2万', '2万～5万', '5万以上'
        ],
        educationArray: [
            '小学', '初中', '高中', '大专', '大学本科', '硕士', '博士'
        ],
        hasChildArray: ['是', '否'],
        wantChildArray: ['是', '否'],
        haveHouseArray: ['已买', '未买'],
        multiIndex: [0, 0],
        multiArray: [[], []],
        jobJson: jobJson_1.default,
    },
    onLoad: function () {
        let _this = this;
        wx.getStorage({
            key: 'user',
            success: function (res) {
                _this.setData({
                    user: res.data
                });
            },
        });
        const multiArray = [[], []];
        jobJson_1.default.data.forEach((item) => {
            multiArray[0].push(item.name);
        });
        jobJson_1.default.data[0].data.forEach((item) => {
            multiArray[1].push(item.name);
        });
        console.log(multiArray);
        this.setData({
            multiArray,
            dateNow: this.getYMD(new Date())
        });
    },
    getCarDetail(id) {
        Api.getUserDetail(id).then((result) => {
            if (result) {
                this.setData({
                    branickNamend: result.data.nickName,
                    gender: result.data.gender,
                    birth: this.getYMD(result.data.birth),
                    height: result.data.height,
                    salary: result.data.salary,
                    workProvince: result.data.region[0],
                    workCity: result.data.region[1],
                    workRegion: result.data.region[2],
                    isMarriage: result.data.isMarriage,
                    education: result.data.education,
                    hasChild: result.data.hasChild,
                    wantChild: result.data.wantChild,
                    jobGeneral: result.data.jobGeneral,
                    jobDetail: result.data.jobDetail,
                    haveHouse: result.data.haveHouse,
                });
            }
        });
    },
    getYMD(dateStr) {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        let month = date.getMonth() + 1;
        let monthStr = month <= 9 ? `0${month}` : month;
        let day = date.getDate();
        let dayStr = day <= 9 ? `0${day}` : day;
        return `${year}-${monthStr}-${dayStr}`;
    },
    onSubmit(e) {
        let that = this;
        const value = e.detail.value;
        if (!utils.validateEmpty(value.nickName, '请输入昵称') ||
            !utils.validateEmpty(value.gender, '请选择性别') ||
            !utils.validateEmpty(value.birth, '请选择生日') ||
            !utils.validateEmpty(value.height, '请输入身高') ||
            !utils.validateEmpty(value.salary, '请选择收入') ||
            !utils.validateEmpty(this.data.region[0], '请选择工作所在地') ||
            !utils.validateEmpty(this.data.education, '请选择学历') ||
            !utils.validateEmpty(this.data.isMarriage, '请选择婚姻状况') ||
            !utils.validateEmpty(this.data.hasChild, '请选择是否有孩子') ||
            !utils.validateEmpty(this.data.wantChild, '请选择是否想要孩子') ||
            !utils.validateEmpty(this.data.haveHouse, '请选择买房情况')) {
            return false;
        }
        that.doSubmit(e);
    },
    doSubmit(e) {
        const params = e.detail.value;
        const { openid } = this.data.user;
        const origin = {
            workProvince: this.data.region[0],
            workCity: this.data.region[1],
            workRegion: this.data.region[2],
        };
        const job = {};
        this.setData({
            submitDisable: true
        });
        Api.updateUser(Object.assign({ openid }, params, origin, job)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                utils.showModal('更新成功');
                setTimeout(() => {
                    wx.switchTab({
                        url: `../myHome/myHome`,
                    });
                }, 1000);
            }
            else {
                utils.showModal('系统异常，请稍后再试');
            }
        });
    },
    bindBirthChange(e) {
        this.setData({
            birth: e.detail.value
        });
    },
    bindEducationChange(e) {
        const { educationArray } = this.data;
        this.setData({
            education: educationArray[e.detail.value]
        });
    },
    bindMarriageChange(e) {
        const { isMarriageArray } = this.data;
        this.setData({
            isMarriage: isMarriageArray[e.detail.value]
        });
    },
    bindHasChildChange(e) {
        const { hasChildArray } = this.data;
        this.setData({
            hasChild: hasChildArray[e.detail.value]
        });
    },
    bindWantChildChange(e) {
        const { wantChildArray } = this.data;
        this.setData({
            wantChild: wantChildArray[e.detail.value]
        });
    },
    bindHaveHouseChange(e) {
        const { haveHouseArray } = this.data;
        this.setData({
            haveHouse: haveHouseArray[e.detail.value]
        });
    },
    bindGenderChange(e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            gender: parseInt(e.detail.value) + 1
        });
        console.log('parseInt(e.detail.value)', (parseInt(e.detail.value) + 1));
    },
    bindSalaryChange(e) {
        const { salaryArray } = this.data;
        this.setData({
            salary: salaryArray[e.detail.value]
        });
    },
    bindRegionChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            region: e.detail.value,
        });
    },
    bindMultiPickerChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            multiIndex: e.detail.value
        });
    },
    bindMultiPickerColumnChange: function (e) {
        console.log('修改的列为', e.detail.column, '，值为', e.detail.value);
        const { multiArray, multiIndex } = this.data;
        multiIndex[e.detail.column] = e.detail.value;
        multiArray[1] = [];
        if (e.detail.column === 0) {
            console.log(jobJson_1.default.data[multiIndex[0]].data);
            jobJson_1.default.data[multiIndex[0]].data.forEach((item) => {
                multiArray[1].push(item.name);
                console.log(multiArray[1]);
            });
        }
        console.log(multiIndex);
        console.log(multiArray);
        this.setData({
            multiArray,
            multiIndex,
        });
    },
    bindDateChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            date: e.detail.value
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLGlEQUFpRDtBQUNqRCwyQ0FBMkM7QUFDM0MsdURBQWdEO0FBRWhELElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7UUFDcEIsUUFBUSxFQUFFLEVBQUU7UUFDWixNQUFNLEVBQUUsRUFBRTtRQUNWLEtBQUssRUFBRSxFQUFFO1FBQ1QsTUFBTSxFQUFFLEVBQUU7UUFDVixNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxFQUFFO1FBQ1YsVUFBVSxFQUFFLElBQUk7UUFDaEIsU0FBUyxFQUFFLEVBQUU7UUFDYixRQUFRLEVBQUUsRUFBRTtRQUNaLFNBQVMsRUFBRSxFQUFFO1FBQ2IsVUFBVSxFQUFFLEVBQUU7UUFDZCxTQUFTLEVBQUUsRUFBRTtRQUNiLFdBQVcsRUFBRSxDQUFDO1FBQ2QsV0FBVyxFQUFFLENBQUM7UUFDZCxPQUFPLEVBQUUsRUFBRTtRQUNYLGFBQWEsRUFBRSxLQUFLO1FBQ3BCLGVBQWUsRUFBRSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDN0IsV0FBVyxFQUFFLENBQUMsR0FBRyxFQUFDLEdBQUcsQ0FBQztRQUN0QixXQUFXLEVBQUU7WUFDWCxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTTtTQUMxQztRQUNELGNBQWMsRUFBRTtZQUNkLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUk7U0FDM0M7UUFDRCxhQUFhLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ3pCLGNBQWMsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDMUIsY0FBYyxFQUFFLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztR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LENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUN6QixPQUFPLENBQUMsR0FBRyxDQUFDLGlCQUFPLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlDLGlCQUFPLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtnQkFDckQsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQzlCLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0IsQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osVUFBVTtZQUNWLFVBQVU7U0FDWCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0QsY0FBYyxFQUFFLFVBQVUsQ0FBSztRQUM3QixPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDaEQsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7U0FDckIsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUVGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0ICogYXMgQXBpIGZyb20gJy4uLy4uL3NlcnZpY2UvYXBpLnNlcnZpY2UnO1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IGpvYkpzb24gZnJvbSAnLi4vLi4vcHVibGljL2pzb24vam9iSnNvbic7XG5cblBhZ2Uoe1xuICBkYXRhOiB7XG4gICAgdXNlcjogeyBvcGVuaWQ6ICcnIH0sXG4gICAgbmlja05hbWU6ICcnLFxuICAgIGdlbmRlcjogJycsIFxuICAgIGJpcnRoOiAnJywgICAgICAgICAgICAvLyDnlJ/ml6VcbiAgICBoZWlnaHQ6ICcnLCAgICAgICAgICAgLy8g6Lqr6auYXG4gICAgc2FsYXJ5OiAnJywgXG4gICAgcmVnaW9uOiBbXSwgXG4gICAgaXNNYXJyaWFnZTogJ+acquWpmicsXG4gICAgZWR1Y2F0aW9uOiAnJywgXG4gICAgaGFzQ2hpbGQ6ICcnLCBcbiAgICB3YW50Q2hpbGQ6ICcnLCBcbiAgICBqb2JHZW5lcmFsOiAnJyxcbiAgICBoYXZlSG91c2U6ICcnLCAgIFxuICAgIGdlbmRlckluZGV4OiAwLFxuICAgIHNhbGFyeUluZGV4OiAwLFxuICAgIGRhdGVOb3c6ICcnLFxuICAgIHN1Ym1pdERpc2FibGU6IGZhbHNlLFxuICAgIGlzTWFycmlhZ2VBcnJheTogWyfmnKrlqZonLCAn56a75byCJ10sXG4gICAgZ2VuZGVyQXJyYXk6IFsn55S3Jywn5aWzJ10sXG4gICAgc2FsYXJ5QXJyYXk6IFtcbiAgICAgICc15Y2D5Lul5LiLJywgJzXljYPvvZ4x5LiHJywgJzHkuIfvvZ4y5LiHJywgJzLkuIfvvZ415LiHJywgJzXkuIfku6XkuIonXG4gICAgXSxcbiAgICBlZHVjYXRpb25BcnJheTogW1xuICAgICAgJ+Wwj+WtpicsICfliJ3kuK0nLCAn6auY5LitJywgJ+Wkp+S4kycsICflpKflrabmnKznp5EnLCAn56GV5aOrJywgJ+WNmuWjqydcbiAgICBdLFxuICAgIGhhc0NoaWxkQXJyYXk6IFsn5pivJywgJ+WQpiddLFxuICAgIHdhbnRDaGlsZEFycmF5OiBbJ+aYrycsICflkKYnXSxcbiAgICBoYXZlSG91c2VBcnJheTogWyflt7LkubAnLCAn5pyq5LmwJ10sXG4gICAgbXVsdGlJbmRleDogWzAsIDBdLFxuICAgIG11bHRpQXJyYXk6IFtbXSxbXV0gYXMgYW55LFxuICAgIGpvYkpzb246IGpvYkpzb24sXG4gIH0sXG5cbiAgLyoqXG4gICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliqDovb1cbiAgKi9cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICB3eC5nZXRTdG9yYWdlKHtcbiAgICAgIGtleTogJ3VzZXInLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICBfdGhpcy5zZXREYXRhISh7XG4gICAgICAgICAgdXNlcjogcmVzLmRhdGFcbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgfSk7ICBcbiAgICBjb25zdCBtdWx0aUFycmF5ID0gW1tdLCBbXV0gYXMgYW55O1xuICAgIGpvYkpzb24uZGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcbiAgICAgIG11bHRpQXJyYXlbMF0ucHVzaChpdGVtLm5hbWUpO1xuICAgIH0pO1xuICAgIGpvYkpzb24uZGF0YVswXS5kYXRhLmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xuICAgICAgbXVsdGlBcnJheVsxXS5wdXNoKGl0ZW0ubmFtZSk7XG4gICAgfSk7XG4gICAgY29uc29sZS5sb2cobXVsdGlBcnJheSk7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBtdWx0aUFycmF5LFxuICAgICAgZGF0ZU5vdzogdGhpcy5nZXRZTUQobmV3IERhdGUoKSlcbiAgICB9KVxuICB9LFxuXG4gIC8qKiDmsb3ovabor6bmg4UgKi9cbiAgZ2V0Q2FyRGV0YWlsKGlkOiBhbnkpIHtcbiAgICBBcGkuZ2V0VXNlckRldGFpbChpZCkudGhlbigocmVzdWx0OiBhbnkpID0+IHtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgICAgYnJhbmlja05hbWVuZDogcmVzdWx0LmRhdGEubmlja05hbWUsXG4gICAgICAgICAgZ2VuZGVyOiByZXN1bHQuZGF0YS5nZW5kZXIsXG4gICAgICAgICAgYmlydGg6IHRoaXMuZ2V0WU1EKHJlc3VsdC5kYXRhLmJpcnRoKSwgICAgICAgIC8vIOeUn+aXpVxuICAgICAgICAgIGhlaWdodDogcmVzdWx0LmRhdGEuaGVpZ2h0LCAgICAgICAgICAgICAgICAgICAvLyDouqvpq5hcbiAgICAgICAgICBzYWxhcnk6IHJlc3VsdC5kYXRhLnNhbGFyeSxcbiAgICAgICAgICB3b3JrUHJvdmluY2U6IHJlc3VsdC5kYXRhLnJlZ2lvblswXSxcbiAgICAgICAgICB3b3JrQ2l0eTogcmVzdWx0LmRhdGEucmVnaW9uWzFdLFxuICAgICAgICAgIHdvcmtSZWdpb246IHJlc3VsdC5kYXRhLnJlZ2lvblsyXSwgICAgICAgIFxuICAgICAgICAgIGlzTWFycmlhZ2U6IHJlc3VsdC5kYXRhLmlzTWFycmlhZ2UsICAgICAgICAgICAvLyDlqZrlp7vnirblhrVcbiAgICAgICAgICBlZHVjYXRpb246IHJlc3VsdC5kYXRhLmVkdWNhdGlvbiwgICAgICAgICAgICAgLy8g5pWZ6IKyXG4gICAgICAgICAgaGFzQ2hpbGQ6IHJlc3VsdC5kYXRhLmhhc0NoaWxkLFxuICAgICAgICAgIHdhbnRDaGlsZDogcmVzdWx0LmRhdGEud2FudENoaWxkLFxuICAgICAgICAgIGpvYkdlbmVyYWw6IHJlc3VsdC5kYXRhLmpvYkdlbmVyYWwsXG4gICAgICAgICAgam9iRGV0YWlsOiByZXN1bHQuZGF0YS5qb2JEZXRhaWwsXG4gICAgICAgICAgaGF2ZUhvdXNlOiByZXN1bHQuZGF0YS5oYXZlSG91c2UsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSxcblxuICBnZXRZTUQoZGF0ZVN0cjogYW55KSB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHIpO1xuICAgIGNvbnN0IHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgbGV0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcbiAgICBsZXQgbW9udGhTdHIgPSBtb250aCA8PSA5ID8gYDAke21vbnRofWAgOiBtb250aDtcbiAgICBsZXQgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG4gICAgbGV0IGRheVN0ciA9IGRheSA8PSA5ID8gYDAke2RheX1gIDogZGF5O1xuICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRoU3RyfS0ke2RheVN0cn1gXG4gIH0sXG5cbiAgLyoqIOWHhuWkh+aPkOS6pCAqL1xuICBvblN1Ym1pdChlOiBhbnkpOiBhbnkge1xuICAgIGxldCB0aGF0ID0gdGhpcztcbiAgICBjb25zdCB2YWx1ZSA9IGUuZGV0YWlsLnZhbHVlO1xuXG4gICAgaWYgKCF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLm5pY2tOYW1lLCAn6K+36L6T5YWl5pi156ewJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLmdlbmRlciwgJ+ivt+mAieaLqeaAp+WIqycpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5iaXJ0aCwgJ+ivt+mAieaLqeeUn+aXpScpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5oZWlnaHQsICfor7fovpPlhaXouqvpq5gnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuc2FsYXJ5LCAn6K+36YCJ5oup5pS25YWlJykgfHxcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5yZWdpb25bMF0sICfor7fpgInmi6nlt6XkvZzmiYDlnKjlnLAnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLmVkdWNhdGlvbiwgJ+ivt+mAieaLqeWtpuWOhicpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuaXNNYXJyaWFnZSwgJ+ivt+mAieaLqeWpmuWnu+eKtuWGtScpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuaGFzQ2hpbGQsICfor7fpgInmi6nmmK/lkKbmnInlranlrZAnKSB8fFxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLndhbnRDaGlsZCwgJ+ivt+mAieaLqeaYr+WQpuaDs+imgeWtqeWtkCcpIHx8XG4gICAgICAvLyAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuam9iR2VuZXJhbCwgJ+ivt+mAieaLqeiBjOS4micpIHx8XG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuaGF2ZUhvdXNlLCAn6K+36YCJ5oup5Lmw5oi/5oOF5Ya1JykpIHtcblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRoYXQuZG9TdWJtaXQoZSk7XG4gIH0sXG5cbiAgLyoqIHVwZGF0ZSAqL1xuICBkb1N1Ym1pdChlOiBhbnkpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBlLmRldGFpbC52YWx1ZTtcbiAgICBjb25zdCB7IG9wZW5pZCB9ID0gdGhpcy5kYXRhLnVzZXI7XG4gICAgY29uc3Qgb3JpZ2luID0ge1xuICAgICAgd29ya1Byb3ZpbmNlOiB0aGlzLmRhdGEucmVnaW9uWzBdLFxuICAgICAgd29ya0NpdHk6IHRoaXMuZGF0YS5yZWdpb25bMV0sXG4gICAgICB3b3JrUmVnaW9uOiB0aGlzLmRhdGEucmVnaW9uWzJdLFxuICAgIH1cbiAgICBjb25zdCBqb2IgPSB7fTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHN1Ym1pdERpc2FibGU6IHRydWVcbiAgICB9KTtcbiAgICBBcGkudXBkYXRlVXNlcihPYmplY3QuYXNzaWduKHsgb3BlbmlkIH0sIHBhcmFtcywgb3JpZ2luLCBqb2IpKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgd3guaGlkZUxvYWRpbmcoKTsgXG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgc3VibWl0RGlzYWJsZTogdHJ1ZVxuICAgICAgfSk7ICAgICBcbiAgICAgIGlmIChyZXN1bHQuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgIHV0aWxzLnNob3dNb2RhbCgn5pu05paw5oiQ5YqfJylcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgd3guc3dpdGNoVGFiKHtcbiAgICAgICAgICAgIHVybDogYC4uL215SG9tZS9teUhvbWVgLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHV0aWxzLnNob3dNb2RhbCgn57O757uf5byC5bi477yM6K+356iN5ZCO5YaN6K+VJyk7XG4gICAgICB9XG4gICAgfSlcbiAgfSxcblxuICAvKiog55Sf5pelICovXG4gIGJpbmRCaXJ0aENoYW5nZShlOiBhbnkpIHtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGJpcnRoOiBlLmRldGFpbC52YWx1ZVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZEVkdWNhdGlvbkNoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGVkdWNhdGlvbkFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGVkdWNhdGlvbjogZWR1Y2F0aW9uQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICAvKiog5ama5ae7ICovXG4gIGJpbmRNYXJyaWFnZUNoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGlzTWFycmlhZ2VBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBpc01hcnJpYWdlOiBpc01hcnJpYWdlQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICBiaW5kSGFzQ2hpbGRDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBoYXNDaGlsZEFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGhhc0NoaWxkOiBoYXNDaGlsZEFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZFdhbnRDaGlsZENoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IHdhbnRDaGlsZEFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHdhbnRDaGlsZDogd2FudENoaWxkQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICAvKiog5Lmw5oi/ICovXG4gIGJpbmRIYXZlSG91c2VDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBoYXZlSG91c2VBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBoYXZlSG91c2U6IGhhdmVIb3VzZUFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOaAp+WIqyAqL1xuICBiaW5kR2VuZGVyQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKCdwaWNrZXLlj5HpgIHpgInmi6nmlLnlj5jvvIzmkLrluKblgLzkuLonLCBlLmRldGFpbC52YWx1ZSlcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGdlbmRlcjogcGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpICsgMVxuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKCdwYXJzZUludChlLmRldGFpbC52YWx1ZSknLCAocGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpICsgMSkpXG4gIH0sXG5cbiAgLyoqIOaciOaUtuWFpSAqL1xuICBiaW5kU2FsYXJ5Q2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgc2FsYXJ5QXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgc2FsYXJ5OiBzYWxhcnlBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KTtcbiAgfSxcblxuICAvKiog5bel5L2c5Zyw5Yy6ICovXG4gIGJpbmRSZWdpb25DaGFuZ2U6IGZ1bmN0aW9uIChlOmFueSkge1xuICAgIGNvbnNvbGUubG9nKCdwaWNrZXLlj5HpgIHpgInmi6nmlLnlj5jvvIzmkLrluKblgLzkuLonLCBlLmRldGFpbC52YWx1ZSlcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHJlZ2lvbjogZS5kZXRhaWwudmFsdWUsXG4gICAgfSk7XG4gIH0sXG5cbiAgYmluZE11bHRpUGlja2VyQ2hhbmdlOiBmdW5jdGlvbiAoZTogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgbXVsdGlJbmRleDogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuXG4gIGJpbmRNdWx0aVBpY2tlckNvbHVtbkNoYW5nZTogZnVuY3Rpb24gKGU6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKCfkv67mlLnnmoTliJfkuLonLCBlLmRldGFpbC5jb2x1bW4sICfvvIzlgLzkuLonLCBlLmRldGFpbC52YWx1ZSk7XG4gICAgY29uc3QgeyBtdWx0aUFycmF5LCBtdWx0aUluZGV4IH0gPSB0aGlzLmRhdGE7XG4gICAgbXVsdGlJbmRleFtlLmRldGFpbC5jb2x1bW5dID0gZS5kZXRhaWwudmFsdWU7XG4gICAgbXVsdGlBcnJheVsxXSA9IFtdO1xuICAgIGlmIChlLmRldGFpbC5jb2x1bW4gPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKGpvYkpzb24uZGF0YVttdWx0aUluZGV4WzBdXS5kYXRhKTtcbiAgICAgIGpvYkpzb24uZGF0YVttdWx0aUluZGV4WzBdXS5kYXRhLmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xuICAgICAgICBtdWx0aUFycmF5WzFdLnB1c2goaXRlbS5uYW1lKTtcbiAgICAgICAgY29uc29sZS5sb2cobXVsdGlBcnJheVsxXSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc29sZS5sb2cobXVsdGlJbmRleCk7XG4gICAgY29uc29sZS5sb2cobXVsdGlBcnJheSk7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBtdWx0aUFycmF5LFxuICAgICAgbXVsdGlJbmRleCxcbiAgICB9KTtcbiAgfSxcbiAgYmluZERhdGVDaGFuZ2U6IGZ1bmN0aW9uIChlOmFueSkge1xuICAgIGNvbnNvbGUubG9nKCdwaWNrZXLlj5HpgIHpgInmi6nmlLnlj5jvvIzmkLrluKblgLzkuLonLCBlLmRldGFpbC52YWx1ZSlcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGRhdGU6IGUuZGV0YWlsLnZhbHVlXG4gICAgfSlcbiAgfSxcbiBcbn0pIl19