"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const apiServicePro = require("../../service/api.service");
const oss_1 = require("../../utils/oss");
const config_1 = require("../../config");
const utils = require("../../utils/utils");
Page({
    data: {
        user: { openid: '' },
        nickName: '',
        gender: '',
        birth: '',
        height: '',
        month_incomeRange: '',
        isMarriage: '未婚',
        education: '',
        hasChild: '',
        wantChild: '',
        job: '',
        house: '',
        genderIndex: 0,
        note: '',
        leftLenth: 300,
        indexImage: '',
        uploadIndexPath: '',
        oldImages: [],
        uploadImgs: [],
        count: 9,
        city: '',
        selectValue: '',
        cityList: [],
        hotCityList: [],
        popHidden: true,
        brandList: [],
        hotBrandList: [],
        dateNow: '',
        popHiddenBrand: true,
        submitDisable: false,
        isMarriageArray: ['未婚', '离异'],
        genderArray: ['男', '女'],
        monthIncomeArray: [
            '5千以下', '5千～1万', '1万～2万', '2万～5万', '5万以上'
        ],
        educationArray: [
            '小学', '初中', '高中', '大专', '大学本科', '硕士', '博士'
        ],
        hasChildArray: ['是', '否'],
        wantChildArray: ['是', '否'],
        houseArray: ['已买', '未买'],
    },
    onLoad: function () {
        let _this = this;
        wx.getStorage({
            key: 'user',
            success: function (res) {
                _this.setData({
                    user: res.data
                });
            },
        });
        this.setData({
            dateNow: this.getYMD(new Date())
        });
    },
    getCarDetail(id) {
        apiServicePro.getUserDetail(id).then((result) => {
            if (result) {
                this.setData({
                    brand: result.data.brand,
                    brandDetail: result.data.brandDetail,
                    city: result.data.city,
                    price: result.data.price,
                    birth: this.getYMD(result.data.birth),
                    height: result.data.height,
                    transfersNumber: result.data.transfersNumber,
                    isMarriage: result.data.isMarriage,
                    education: result.data.education,
                    gender: result.data.gender,
                    note: result.data.note,
                    indexImage: result.data.indexImage,
                    oldImages: result.data.images,
                });
            }
        });
    },
    getYMD(dateStr) {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        let month = date.getMonth() + 1;
        let monthStr = month <= 9 ? `0${month}` : month;
        let day = date.getDate();
        let dayStr = day <= 9 ? `0${day}` : day;
        return `${year}-${monthStr}-${dayStr}`;
    },
    onSubmit(e) {
        let that = this;
        const value = e.detail.value;
        const openid = this.data.user.openid;
        const aliyunServerURL = config_1.default.uploadImageUrl;
        if (!utils.validateEmpty(value.brand, '请选择品牌车系') ||
            !utils.validateEmpty(value.birth, '请选择上牌日期') ||
            !utils.validateEmpty(value.height, '请输入行驶里程') ||
            !utils.validateEmpty(value.city, '请输选择牌照所在地') ||
            !utils.validateEmpty(value.price, '请输入价格') ||
            !utils.validateEmpty(value.transfersNumber, '请输入过户次数') ||
            !utils.validateEmpty(value.gender, '请选择车况') ||
            !utils.validateEmpty(this.data.indexImage, '请上传汽车首页照片') ||
            !utils.validateImages(this.data.oldImages.concat(this.data.uploadImgs), '请上传汽车照片')) {
            return false;
        }
        let indexImage = this.data.indexImage;
        let uploadIndexPath = this.data.uploadIndexPath;
        if (uploadIndexPath !== '') {
            oss_1.default({
                filePath: indexImage,
                dir: `images/shop/${openid}/` + indexImage.replace('http://tmp/', ''),
                success: function (res) {
                    indexImage = `${aliyunServerURL}/${res}`;
                    that.uploadAndSubmit();
                },
                fail: function () {
                    that.uploadAndSubmit();
                }
            });
        }
        else {
            that.uploadAndSubmit();
        }
    },
    uploadAndSubmit() {
        const openid = this.data.user.openid;
        const aliyunServerURL = config_1.default.uploadImageUrl;
        let count = 0;
        let images = [];
        const uploadImgs = this.data.uploadImgs;
        wx.showLoading({
            title: '',
        });
        if (uploadImgs.length > 0) {
            for (let i = 0; i < uploadImgs.length; i++) {
                let filePath = uploadImgs[i];
                oss_1.default({
                    filePath: filePath,
                    dir: `images/shop/${openid}/` + filePath.replace('http://tmp/', ''),
                    success: function (res) {
                        count++;
                        images.push(`${aliyunServerURL}/${res}`);
                        if (count === uploadImgs.length) {
                        }
                        else {
                        }
                    },
                    fail: function () {
                        wx.hideLoading();
                    }
                });
            }
        }
        else {
            wx.hideLoading();
        }
    },
    doSubmit(e, indexImage, images) {
        const params = e.detail.value;
        this.setData({
            submitDisable: true
        });
        apiServicePro.register(Object.assign({ images, indexImage }, params)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                wx.navigateTo({
                    url: `../carDetail/carDetail?id=${result.data.id}&from=creatCarPage`,
                });
            }
            else if (result.code === 1202) {
                utils.showModal('信息校验不通过，请核对汽车信息');
            }
            else {
                utils.showModal();
            }
        });
    },
    updateCar(e, indexImage, images, carId) {
        const value = e.detail.value;
        const params = Object.assign(value, { 'id': carId });
        this.setData({
            submitDisable: true
        });
        apiServicePro.updateUser(Object.assign({ images, indexImage }, params)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                wx.navigateTo({
                    url: `../carDetail/carDetail?id=${result.data.id}&from=creatCarPage`,
                });
            }
            else if (result.code === 1202) {
                utils.showModal('信息校验不通过，请核对汽车信息');
            }
            else {
                utils.showModal();
            }
        });
    },
    delImage(e) {
        const array = e.currentTarget.dataset.array;
        const index = e.currentTarget.dataset.index;
        if (array === 'oldImages') {
            const oldImages = this.data.oldImages;
            oldImages.splice(index, 1);
            this.setData({
                oldImages
            });
        }
        else {
            const uploadImgs = this.data.uploadImgs;
            uploadImgs.splice(index, 1);
            this.setData({
                uploadImgs
            });
        }
    },
    chooseIndexImage() {
        this.chooseImage(1, 'one');
    },
    chooseOtherImage(e) {
        const selectPictureNum = e.target.dataset.num;
        let count = 99 - selectPictureNum;
        this.chooseImage(count, 'multi');
    },
    chooseImage(count, type) {
        const that = this;
        wx.chooseImage({
            count: count,
            sizeType: ['original', 'compressed'],
            sourceType: ['album', 'camera'],
            success: function (res) {
                let uploadImgs = that.data.uploadImgs;
                if (type === 'multi') {
                    that.setData({
                        uploadImgs: uploadImgs.concat(res.tempFilePaths),
                    });
                }
                else {
                    that.setData({
                        uploadIndexPath: res.tempFilePaths[0],
                        indexImage: res.tempFilePaths[0],
                    });
                }
            },
        });
    },
    popPicker() {
        let popHidden = this.data.popHidden;
        this.setData({
            popHidden: !popHidden,
        });
    },
    doSelect(e) {
        if (e.detail.name) {
            this.setData({
                popHidden: true,
                city: e.detail.name,
            });
            wx.setStorage({
                key: 'city',
                data: e.detail.name,
            });
        }
        else {
            this.setData({
                popHidden: true,
            });
        }
    },
    popBrand() {
        let popHiddenBrand = this.data.popHiddenBrand;
        this.setData({
            popHiddenBrand: !popHiddenBrand,
        });
    },
    doSelectBrand(e) {
        if (e.detail.brand) {
            this.setData({
                popHiddenBrand: true,
                brand: e.detail.brand,
                brandDetail: e.detail.brandDetail,
            });
            wx.setStorage({
                key: 'brand',
                data: e.detail.brand,
            });
        }
        else {
            this.setData({
                popHiddenBrand: true,
            });
        }
    },
    bindBirthChange(e) {
        this.setData({
            birth: e.detail.value
        });
    },
    bindEducationChange(e) {
        const { educationArray } = this.data;
        this.setData({
            education: educationArray[e.detail.value]
        });
    },
    bindMarriageChange(e) {
        const { isMarriageArray } = this.data;
        this.setData({
            isMarriage: isMarriageArray[e.detail.value]
        });
    },
    bindHasChildChange(e) {
        const { hasChildArray } = this.data;
        this.setData({
            hasChild: hasChildArray[e.detail.value]
        });
    },
    bindWantChildChange(e) {
        const { wantChildArray } = this.data;
        this.setData({
            hasChild: wantChildArray[e.detail.value]
        });
    },
    bindHouseChange(e) {
        const { houseArray } = this.data;
        this.setData({
            house: houseArray[e.detail.value]
        });
    },
    bindGenderChange(e) {
        const { genderArray } = this.data;
        this.setData({
            gender: genderArray[e.detail.value]
        });
    },
    bindMonthIncomeChange(e) {
        const { monthIncomeArray } = this.data;
        this.setData({
            month_incomeRange: monthIncomeArray[e.detail.value]
        });
    },
    inputNote(e) {
        const leftLenth = (300 - e.detail.value.length);
        this.setData({
            leftLenth: leftLenth > 0 ? leftLenth : 0
        });
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDJEQUEyRDtBQUMzRCx5Q0FBMkM7QUFDM0MseUNBQStCO0FBQy9CLDJDQUEyQztBQUUzQyxJQUFJLENBQUM7SUFDSCxJQUFJLEVBQUU7UUFDSixJQUFJLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO1FBQ3BCLFFBQVEsRUFBRSxFQUFFO1FBQ1osTUFBTSxFQUFFLEVBQUU7UUFDVixLQUFLLEVBQUUsRUFBRTtRQUNULE1BQU0sRUFBRSxFQUFFO1FBQ1YsaUJBQWlCLEVBQUUsRUFBRTtRQUNyQixVQUFVLEVBQUUsSUFBSTtRQUNoQixTQUFTLEVBQUUsRUFBRTtRQUNiLFFBQVEsRUFBRSxFQUFFO1FBQ1osU0FBUyxFQUFFLEVBQUU7UUFDYixHQUFHLEVBQUUsRUFBRTtRQUNQLEtBQUssRUFBRSxFQUFFO1FBQ1QsV0FBVyxFQUFFLENBQUM7UUFDZCxJQUFJLEVBQUUsRUFBRTtRQUNSLFNBQVMsRUFBRSxHQUFHO1FBQ2QsVUFBVSxFQUFFLEVBQUU7UUFDZCxlQUFlLEVBQUUsRUFBRTtRQUNuQixTQUFTLEVBQUUsRUFBRTtRQUNiLFVBQVUsRUFBRSxFQUFFO1FBQ2QsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLEVBQUUsRUFBRTtRQUVSLFdBQVcsRUFBRSxFQUFFO1FBQ2YsUUFBUSxFQUFFLEVBQUU7UUFDWixXQUFXLEVBQUUsRUFBRTtRQUNmLFNBQVMsRUFBRSxJQUFJO1FBQ2YsU0FBUyxFQUFFLEVBQUU7UUFDYixZQUFZLEVBQUUsRUFBRTtRQUNoQixPQUFPLEVBQUUsRUFBRTtRQUNYLGNBQWMsRUFBRSxJQUFJO1FBQ3BCLGFBQWEsRUFBRSxLQUFLO1FBQ3BCLGVBQWUsRUFBRSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDN0IsV0FBVyxFQUFFLENBQUMsR0FBRyxFQUFDLEdBQUcsQ0FBQztRQUN0QixnQkFBZ0IsRUFBRTtZQUNoQixNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTTtTQUMxQztRQUNELGNBQWMsRUFBRTtZQUNkLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUk7U0FDM0M7UUFDRCxhQUFhLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ3pCLGNBQWMsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDMUIsVUFBVSxFQUFFLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztLQUN6QjtJQUtELE1BQU0sRUFBRTtRQUNOLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQztRQUNqQixFQUFFLENBQUMsVUFBVSxDQUFDO1lBQ1osR0FBRyxFQUFFLE1BQU07WUFDWCxPQUFPLEVBQUUsVUFBVSxHQUFHO2dCQUNwQixLQUFLLENBQUMsT0FBUSxDQUFDO29CQUNiLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSTtpQkFDZixDQUFDLENBQUE7WUFDSixDQUFDO1NBQ0YsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLE9BQU8sRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUM7U0FDakMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUdELFlBQVksQ0FBQyxFQUFPO1FBQ2xCLGFBQWEsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBVyxFQUFFLEVBQUU7WUFDbkQsSUFBSSxNQUFNLEVBQUU7Z0JBQ1YsSUFBSSxDQUFDLE9BQVEsQ0FBQztvQkFDWixLQUFLLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLO29CQUN4QixXQUFXLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXO29CQUNwQyxJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJO29CQUN0QixLQUFLLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLO29CQUN4QixLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztvQkFDckMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTTtvQkFDMUIsZUFBZSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZTtvQkFDNUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVTtvQkFDbEMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUztvQkFDaEMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTTtvQkFDMUIsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSTtvQkFDdEIsVUFBVSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVTtvQkFDbEMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTTtpQkFDOUIsQ0FBQyxDQUFBO2FBQ0g7UUFDSCxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxNQUFNLENBQUMsT0FBWTtRQUNqQixNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMvQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEMsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNoQyxJQUFJLFFBQVEsR0FBRyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFDaEQsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ3pCLElBQUksTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUN4QyxPQUFPLEdBQUcsSUFBSSxJQUFJLFFBQVEsSUFBSSxNQUFNLEVBQUUsQ0FBQTtJQUN4QyxDQUFDO0lBR0QsUUFBUSxDQUFDLENBQU07UUFDYixJQUFJLElBQUksR0FBRyxJQUFJLENBQUM7UUFDaEIsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDN0IsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQ3JDLE1BQU0sZUFBZSxHQUFHLGdCQUFHLENBQUMsY0FBYyxDQUFDO1FBRTNDLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDO1lBQzVDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLFNBQVMsQ0FBQztZQUM1QyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUM7WUFDN0MsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDO1lBQzdDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQztZQUMxQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLGVBQWUsRUFBRSxTQUFTLENBQUM7WUFDdEQsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDO1lBQzNDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxXQUFXLENBQUM7WUFDdkQsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxFQUFFO1lBQ3RGLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7UUFFRCxJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUN0QyxJQUFJLGVBQWUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQztRQUNoRCxJQUFJLGVBQWUsS0FBSyxFQUFFLEVBQUU7WUFDMUIsYUFBVyxDQUFDO2dCQUNWLFFBQVEsRUFBRSxVQUFVO2dCQUNwQixHQUFHLEVBQUUsZUFBZSxNQUFNLEdBQUcsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUM7Z0JBQ3JFLE9BQU8sRUFBRSxVQUFVLEdBQVE7b0JBQ3pCLFVBQVUsR0FBRyxHQUFHLGVBQWUsSUFBSSxHQUFHLEVBQUUsQ0FBQztvQkFDekMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUN6QixDQUFDO2dCQUNELElBQUksRUFBRTtvQkFDSixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7Z0JBQ3pCLENBQUM7YUFDRixDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1NBQ3hCO0lBQ0gsQ0FBQztJQUVELGVBQWU7UUFDYixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDckMsTUFBTSxlQUFlLEdBQUcsZ0JBQUcsQ0FBQyxjQUFjLENBQUM7UUFDM0MsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsSUFBSSxNQUFNLEdBQVUsRUFBRSxDQUFDO1FBQ3ZCLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQ3hDLEVBQUUsQ0FBQyxXQUFXLENBQUM7WUFDYixLQUFLLEVBQUUsRUFBRTtTQUNWLENBQUMsQ0FBQTtRQUNGLElBQUksVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDekIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQzFDLElBQUksUUFBUSxHQUFRLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbEMsYUFBVyxDQUFDO29CQUNWLFFBQVEsRUFBRSxRQUFRO29CQUNsQixHQUFHLEVBQUUsZUFBZSxNQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUM7b0JBQ25FLE9BQU8sRUFBRSxVQUFVLEdBQVE7d0JBQ3pCLEtBQUssRUFBRSxDQUFDO3dCQUNSLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxlQUFlLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQzt3QkFDekMsSUFBSSxLQUFLLEtBQUssVUFBVSxDQUFDLE1BQU0sRUFBRTt5QkFPaEM7NkJBQU07eUJBRU47b0JBQ0gsQ0FBQztvQkFDRCxJQUFJLEVBQUU7d0JBQ0osRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO29CQUNuQixDQUFDO2lCQUNGLENBQUMsQ0FBQzthQUNKO1NBQ0Y7YUFBTTtZQU9MLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNsQjtJQUNILENBQUM7SUFHRCxRQUFRLENBQUMsQ0FBTSxFQUFFLFVBQWUsRUFBRSxNQUFXO1FBQzNDLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQzlCLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixhQUFhLEVBQUUsSUFBSTtTQUNwQixDQUFDLENBQUM7UUFDSCxhQUFhLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFXLEVBQUUsRUFBRTtZQUN6RixFQUFFLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDakIsSUFBSSxDQUFDLE9BQVEsQ0FBQztnQkFDWixhQUFhLEVBQUUsSUFBSTthQUNwQixDQUFDLENBQUM7WUFDSCxJQUFJLE1BQU0sQ0FBQyxJQUFJLEtBQUssR0FBRyxFQUFFO2dCQUN2QixFQUFFLENBQUMsVUFBVSxDQUFDO29CQUNaLEdBQUcsRUFBRSw2QkFBNkIsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLG9CQUFvQjtpQkFDckUsQ0FBQyxDQUFDO2FBQ0o7aUJBQU0sSUFBSSxNQUFNLENBQUMsSUFBSSxLQUFLLElBQUksRUFBRTtnQkFDL0IsS0FBSyxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO2FBQ3BDO2lCQUFNO2dCQUNMLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQzthQUNuQjtRQUNILENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUdELFNBQVMsQ0FBQyxDQUFNLEVBQUUsVUFBZSxFQUFFLE1BQVcsRUFBRSxLQUFVO1FBQ3hELE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQzdCLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7UUFDbkQsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLGFBQWEsRUFBRSxJQUFJO1NBQ3BCLENBQUMsQ0FBQztRQUNILGFBQWEsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQVUsRUFBRSxFQUFFO1lBQzFGLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNqQixJQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNaLGFBQWEsRUFBRSxJQUFJO2FBQ3BCLENBQUMsQ0FBQztZQUNILElBQUksTUFBTSxDQUFDLElBQUksS0FBSyxHQUFHLEVBQUU7Z0JBQ3ZCLEVBQUUsQ0FBQyxVQUFVLENBQUM7b0JBQ1osR0FBRyxFQUFFLDZCQUE2QixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsb0JBQW9CO2lCQUNyRSxDQUFDLENBQUM7YUFDSjtpQkFBTSxJQUFJLE1BQU0sQ0FBQyxJQUFJLEtBQUssSUFBSSxFQUFFO2dCQUMvQixLQUFLLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLENBQUM7YUFDcEM7aUJBQU07Z0JBQ0wsS0FBSyxDQUFDLFNBQVMsRUFBRSxDQUFDO2FBQ25CO1FBQ0gsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBR0QsUUFBUSxDQUFDLENBQU07UUFDYixNQUFNLEtBQUssR0FBRyxDQUFDLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFDNUMsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDO1FBQzVDLElBQUksS0FBSyxLQUFLLFdBQVcsRUFBRTtZQUN6QixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUN0QyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztZQUMzQixJQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNaLFNBQVM7YUFDVixDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUM7WUFDeEMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDNUIsSUFBSSxDQUFDLE9BQVEsQ0FBQztnQkFDWixVQUFVO2FBQ1gsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBRUQsZ0JBQWdCO1FBQ2QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVELGdCQUFnQixDQUFDLENBQU07UUFDckIsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDOUMsSUFBSSxLQUFLLEdBQUcsRUFBRSxHQUFHLGdCQUFnQixDQUFBO1FBQ2pDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFLRCxXQUFXLENBQUMsS0FBVSxFQUFFLElBQVM7UUFDL0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLEVBQUUsQ0FBQyxXQUFXLENBQUM7WUFDYixLQUFLLEVBQUUsS0FBSztZQUNaLFFBQVEsRUFBRSxDQUFDLFVBQVUsRUFBRSxZQUFZLENBQUM7WUFDcEMsVUFBVSxFQUFFLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQztZQUMvQixPQUFPLEVBQUUsVUFBVSxHQUFRO2dCQUN6QixJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQztnQkFDdEMsSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO29CQUNwQixJQUFJLENBQUMsT0FBUSxDQUFDO3dCQUNaLFVBQVUsRUFBRSxVQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUM7cUJBQ2pELENBQUMsQ0FBQztpQkFDSjtxQkFBTTtvQkFDTCxJQUFJLENBQUMsT0FBUSxDQUFDO3dCQUNaLGVBQWUsRUFBRSxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQzt3QkFDckMsVUFBVSxFQUFFLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO3FCQUNqQyxDQUFDLENBQUM7aUJBQ0o7WUFDSCxDQUFDO1NBQ0YsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUdELFNBQVM7UUFDUCxJQUFJLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUNwQyxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osU0FBUyxFQUFFLENBQUMsU0FBUztTQUN0QixDQUFDLENBQUE7SUFDSixDQUFDO0lBR0QsUUFBUSxDQUFDLENBQU07UUFDYixJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO1lBRWpCLElBQUksQ0FBQyxPQUFRLENBQUM7Z0JBQ1osU0FBUyxFQUFFLElBQUk7Z0JBQ2YsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSTthQUVwQixDQUFDLENBQUE7WUFDRixFQUFFLENBQUMsVUFBVSxDQUFDO2dCQUNaLEdBQUcsRUFBRSxNQUFNO2dCQUNYLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUk7YUFDcEIsQ0FBQyxDQUFDO1NBQ0o7YUFBTTtZQUNMLElBQUksQ0FBQyxPQUFRLENBQUM7Z0JBQ1osU0FBUyxFQUFFLElBQUk7YUFDaEIsQ0FBQyxDQUFBO1NBQ0g7SUFDSCxDQUFDO0lBSUQsUUFBUTtRQUNOLElBQUksY0FBYyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDO1FBQzlDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixjQUFjLEVBQUUsQ0FBQyxjQUFjO1NBQ2hDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFHRCxhQUFhLENBQUMsQ0FBTTtRQUNsQixJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxPQUFRLENBQUM7Z0JBQ1osY0FBYyxFQUFFLElBQUk7Z0JBQ3BCLEtBQUssRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUs7Z0JBQ3JCLFdBQVcsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQVc7YUFDbEMsQ0FBQyxDQUFDO1lBQ0gsRUFBRSxDQUFDLFVBQVUsQ0FBQztnQkFDWixHQUFHLEVBQUUsT0FBTztnQkFDWixJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO2FBQ3JCLENBQUMsQ0FBQztTQUNKO2FBQU07WUFDTCxJQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNaLGNBQWMsRUFBRSxJQUFJO2FBQ3JCLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQztJQUdELGVBQWUsQ0FBQyxDQUFNO1FBQ3BCLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixLQUFLLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ3RCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxtQkFBbUIsQ0FBQyxDQUFNO1FBQ3hCLE1BQU0sRUFBRSxjQUFjLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFBO1FBQ3BDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixTQUFTLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1NBQzFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFHRCxrQkFBa0IsQ0FBQyxDQUFNO1FBQ3ZCLE1BQU0sRUFBRSxlQUFlLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFBO1FBQ3JDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixVQUFVLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1NBQzVDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxrQkFBa0IsQ0FBQyxDQUFNO1FBQ3ZCLE1BQU0sRUFBRSxhQUFhLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFBO1FBQ25DLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1NBQ3hDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxtQkFBbUIsQ0FBQyxDQUFNO1FBQ3hCLE1BQU0sRUFBRSxjQUFjLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFBO1FBQ3BDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1NBQ3pDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxlQUFlLENBQUMsQ0FBTTtRQUNwQixNQUFNLEVBQUUsVUFBVSxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQTtRQUNoQyxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUNsQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBR0QsZ0JBQWdCLENBQUMsQ0FBTTtRQUNyQixNQUFNLEVBQUUsV0FBVyxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQTtRQUNqQyxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUNwQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQscUJBQXFCLENBQUMsQ0FBTTtRQUMxQixNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFBO1FBQ3RDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixpQkFBaUIsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUNwRCxDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsU0FBUyxDQUFDLENBQU07UUFDZCxNQUFNLFNBQVMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNoRCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osU0FBUyxFQUFFLFNBQVMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN6QyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBS0QsT0FBTyxFQUFFO0lBRVQsQ0FBQztJQUtELE1BQU0sRUFBRTtJQUNSLENBQUM7SUFLRCxNQUFNLEVBQUU7SUFFUixDQUFDO0lBS0QsUUFBUSxFQUFFO0lBRVYsQ0FBQztJQUtELGlCQUFpQixFQUFFO0lBRW5CLENBQUM7SUFLRCxhQUFhLEVBQUU7SUFFZixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvY3JlYXRlQ2FyL2NyZWF0ZUNhci5qc1xuaW1wb3J0ICogYXMgYXBpU2VydmljZVBybyBmcm9tICcuLi8uLi9zZXJ2aWNlL2FwaS5zZXJ2aWNlJztcbmltcG9ydCB1cGxvYWRJbWFnZSAgZnJvbSAnLi4vLi4vdXRpbHMvb3NzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICB1c2VyOiB7IG9wZW5pZDogJycgfSxcbiAgICBuaWNrTmFtZTogJycsXG4gICAgZ2VuZGVyOiAnJywgXG4gICAgYmlydGg6ICcnLCAgICAgICAgICAgIC8vIOeUn+aXpVxuICAgIGhlaWdodDogJycsICAgICAgICAgICAvLyDouqvpq5hcbiAgICBtb250aF9pbmNvbWVSYW5nZTogJycsICBcbiAgICBpc01hcnJpYWdlOiAn5pyq5amaJyxcbiAgICBlZHVjYXRpb246ICcnLCBcbiAgICBoYXNDaGlsZDogJycsIFxuICAgIHdhbnRDaGlsZDogJycsIFxuICAgIGpvYjogJycsXG4gICAgaG91c2U6ICcnLCAgIFxuICAgIGdlbmRlckluZGV4OiAwLFxuICAgIG5vdGU6ICcnLFxuICAgIGxlZnRMZW50aDogMzAwLFxuICAgIGluZGV4SW1hZ2U6ICcnLFxuICAgIHVwbG9hZEluZGV4UGF0aDogJycsXG4gICAgb2xkSW1hZ2VzOiBbXSwgICAgICAgIC8vIOabtOaWsOaxvei9puWbvueJh1xuICAgIHVwbG9hZEltZ3M6IFtdLCAgICAgICAvLyDlm77niYdcbiAgICBjb3VudDogOSxcbiAgICBjaXR5OiAnJywgICAgICAgICAgICAgLy8g5LiK54mM5Zyw54K5XG4gICAgLy8gY2l0eUlkOiAnJyxcbiAgICBzZWxlY3RWYWx1ZTogJycsXG4gICAgY2l0eUxpc3Q6IFtdLFxuICAgIGhvdENpdHlMaXN0OiBbXSxcbiAgICBwb3BIaWRkZW46IHRydWUsXG4gICAgYnJhbmRMaXN0OiBbXSxcbiAgICBob3RCcmFuZExpc3Q6IFtdLFxuICAgIGRhdGVOb3c6ICcnLFxuICAgIHBvcEhpZGRlbkJyYW5kOiB0cnVlLFxuICAgIHN1Ym1pdERpc2FibGU6IGZhbHNlLFxuICAgIGlzTWFycmlhZ2VBcnJheTogWyfmnKrlqZonLCAn56a75byCJ10sXG4gICAgZ2VuZGVyQXJyYXk6IFsn55S3Jywn5aWzJ10sXG4gICAgbW9udGhJbmNvbWVBcnJheTogW1xuICAgICAgJzXljYPku6XkuIsnLCAnNeWNg++9njHkuIcnLCAnMeS4h++9njLkuIcnLCAnMuS4h++9njXkuIcnLCAnNeS4h+S7peS4iidcbiAgICBdLFxuICAgIGVkdWNhdGlvbkFycmF5OiBbXG4gICAgICAn5bCP5a2mJywgJ+WIneS4rScsICfpq5jkuK0nLCAn5aSn5LiTJywgJ+Wkp+WtpuacrOenkScsICfnoZXlo6snLCAn5Y2a5aOrJ1xuICAgIF0sXG4gICAgaGFzQ2hpbGRBcnJheTogWyfmmK8nLCAn5ZCmJ10sXG4gICAgd2FudENoaWxkQXJyYXk6IFsn5pivJywgJ+WQpiddLFxuICAgIGhvdXNlQXJyYXk6IFsn5bey5LmwJywgJ+acquS5sCddLFxuICB9LFxuXG4gIC8qKlxuICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yqg6L29XG4gICovXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgd3guZ2V0U3RvcmFnZSh7XG4gICAgICBrZXk6ICd1c2VyJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgX3RoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIHVzZXI6IHJlcy5kYXRhXG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgIH0pOyAgXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBkYXRlTm93OiB0aGlzLmdldFlNRChuZXcgRGF0ZSgpKVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKiDmsb3ovabor6bmg4UgKi9cbiAgZ2V0Q2FyRGV0YWlsKGlkOiBhbnkpIHtcbiAgICBhcGlTZXJ2aWNlUHJvLmdldFVzZXJEZXRhaWwoaWQpLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIGJyYW5kOiByZXN1bHQuZGF0YS5icmFuZCxcbiAgICAgICAgICBicmFuZERldGFpbDogcmVzdWx0LmRhdGEuYnJhbmREZXRhaWwsICAgICAgICAgLy8g5LqM57qn6L2m57O7XG4gICAgICAgICAgY2l0eTogcmVzdWx0LmRhdGEuY2l0eSxcbiAgICAgICAgICBwcmljZTogcmVzdWx0LmRhdGEucHJpY2UsICAgICAgICAgICAgICAgICAgICAgLy8g5Lu35qC8XG4gICAgICAgICAgYmlydGg6IHRoaXMuZ2V0WU1EKHJlc3VsdC5kYXRhLmJpcnRoKSwgIC8vIOeUn+aXpVxuICAgICAgICAgIGhlaWdodDogcmVzdWx0LmRhdGEuaGVpZ2h0LCAgICAgICAgICAgICAgICAgICAvLyDouqvpq5hcbiAgICAgICAgICB0cmFuc2ZlcnNOdW1iZXI6IHJlc3VsdC5kYXRhLnRyYW5zZmVyc051bWJlciwgLy8g6L+H5oi35qyh5pWwXG4gICAgICAgICAgaXNNYXJyaWFnZTogcmVzdWx0LmRhdGEuaXNNYXJyaWFnZSwgICAgICAgICAgIC8vIOWpmuWnu+eKtuWGtVxuICAgICAgICAgIGVkdWNhdGlvbjogcmVzdWx0LmRhdGEuZWR1Y2F0aW9uLCAgICAgICAgICAgICAvLyDmlZnogrJcbiAgICAgICAgICBnZW5kZXI6IHJlc3VsdC5kYXRhLmdlbmRlciwgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5oCn5YirXG4gICAgICAgICAgbm90ZTogcmVzdWx0LmRhdGEubm90ZSwgICAgICAgICAgICAgICAgICAgICAgIC8vIOihpeWFhVxuICAgICAgICAgIGluZGV4SW1hZ2U6IHJlc3VsdC5kYXRhLmluZGV4SW1hZ2UsXG4gICAgICAgICAgb2xkSW1hZ2VzOiByZXN1bHQuZGF0YS5pbWFnZXMsICAgICAgICAgICAgICAgIC8vIOWbvueJh1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH0sXG5cbiAgZ2V0WU1EKGRhdGVTdHI6IGFueSkge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyKTtcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgIGxldCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgbGV0IG1vbnRoU3RyID0gbW9udGggPD0gOSA/IGAwJHttb250aH1gIDogbW9udGg7XG4gICAgbGV0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIGxldCBkYXlTdHIgPSBkYXkgPD0gOSA/IGAwJHtkYXl9YCA6IGRheTtcbiAgICByZXR1cm4gYCR7eWVhcn0tJHttb250aFN0cn0tJHtkYXlTdHJ9YFxuICB9LFxuXG4gIC8qKiDlh4blpIfmj5DkuqQgKi9cbiAgb25TdWJtaXQoZTogYW55KTogYW55IHtcbiAgICBsZXQgdGhhdCA9IHRoaXM7XG4gICAgY29uc3QgdmFsdWUgPSBlLmRldGFpbC52YWx1ZTtcbiAgICBjb25zdCBvcGVuaWQgPSB0aGlzLmRhdGEudXNlci5vcGVuaWQ7XG4gICAgY29uc3QgYWxpeXVuU2VydmVyVVJMID0gZW52LnVwbG9hZEltYWdlVXJsO1xuXG4gICAgaWYgKCF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLmJyYW5kLCAn6K+36YCJ5oup5ZOB54mM6L2m57O7JykgfHxcbiAgICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuYmlydGgsICfor7fpgInmi6nkuIrniYzml6XmnJ8nKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5oZWlnaHQsICfor7fovpPlhaXooYzpqbbph4znqIsnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5jaXR5LCAn6K+36L6T6YCJ5oup54mM54Wn5omA5Zyo5ZywJykgfHxcbiAgICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUucHJpY2UsICfor7fovpPlhaXku7fmoLwnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS50cmFuc2ZlcnNOdW1iZXIsICfor7fovpPlhaXov4fmiLfmrKHmlbAnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5nZW5kZXIsICfor7fpgInmi6novablhrUnKSB8fFxuICAgICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEuaW5kZXhJbWFnZSwgJ+ivt+S4iuS8oOaxvei9pummlumhteeFp+eJhycpIHx8XG4gICAgICAgICF1dGlscy52YWxpZGF0ZUltYWdlcyh0aGlzLmRhdGEub2xkSW1hZ2VzLmNvbmNhdCh0aGlzLmRhdGEudXBsb2FkSW1ncyksICfor7fkuIrkvKDmsb3ovabnhafniYcnKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBpbmRleEltYWdlID0gdGhpcy5kYXRhLmluZGV4SW1hZ2U7XG4gICAgbGV0IHVwbG9hZEluZGV4UGF0aCA9IHRoaXMuZGF0YS51cGxvYWRJbmRleFBhdGg7XG4gICAgaWYgKHVwbG9hZEluZGV4UGF0aCAhPT0gJycpIHtcbiAgICAgIHVwbG9hZEltYWdlKHtcbiAgICAgICAgZmlsZVBhdGg6IGluZGV4SW1hZ2UsXG4gICAgICAgIGRpcjogYGltYWdlcy9zaG9wLyR7b3BlbmlkfS9gICsgaW5kZXhJbWFnZS5yZXBsYWNlKCdodHRwOi8vdG1wLycsICcnKSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlczogYW55KSB7XG4gICAgICAgICAgaW5kZXhJbWFnZSA9IGAke2FsaXl1blNlcnZlclVSTH0vJHtyZXN9YDtcbiAgICAgICAgICB0aGF0LnVwbG9hZEFuZFN1Ym1pdCgpO1xuICAgICAgICB9LFxuICAgICAgICBmYWlsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhhdC51cGxvYWRBbmRTdWJtaXQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoYXQudXBsb2FkQW5kU3VibWl0KCk7XG4gICAgfVxuICB9LFxuXG4gIHVwbG9hZEFuZFN1Ym1pdCgpIHtcbiAgICBjb25zdCBvcGVuaWQgPSB0aGlzLmRhdGEudXNlci5vcGVuaWQ7XG4gICAgY29uc3QgYWxpeXVuU2VydmVyVVJMID0gZW52LnVwbG9hZEltYWdlVXJsO1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgbGV0IGltYWdlczogYW55W10gPSBbXTtcbiAgICBjb25zdCB1cGxvYWRJbWdzID0gdGhpcy5kYXRhLnVwbG9hZEltZ3M7XG4gICAgd3guc2hvd0xvYWRpbmcoe1xuICAgICAgdGl0bGU6ICcnLFxuICAgIH0pXG4gICAgaWYgKHVwbG9hZEltZ3MubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1cGxvYWRJbWdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBmaWxlUGF0aDogYW55ID0gdXBsb2FkSW1nc1tpXTtcbiAgICAgICAgdXBsb2FkSW1hZ2Uoe1xuICAgICAgICAgIGZpbGVQYXRoOiBmaWxlUGF0aCxcbiAgICAgICAgICBkaXI6IGBpbWFnZXMvc2hvcC8ke29wZW5pZH0vYCArIGZpbGVQYXRoLnJlcGxhY2UoJ2h0dHA6Ly90bXAvJywgJycpLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXM6IGFueSkge1xuICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgIGltYWdlcy5wdXNoKGAke2FsaXl1blNlcnZlclVSTH0vJHtyZXN9YCk7XG4gICAgICAgICAgICBpZiAoY291bnQgPT09IHVwbG9hZEltZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIC8vIGlmICh0aGF0LmRhdGEuY2FySWQgIT09ICcnKSB7XG4gICAgICAgICAgICAgIC8vICAgaW1hZ2VzID0gaW1hZ2VzLmNvbmNhdCh0aGF0LmRhdGEub2xkSW1hZ2VzKTtcbiAgICAgICAgICAgICAgLy8gICB0aGF0LnVwZGF0ZUNhcihlLCBpbmRleEltYWdlLCBpbWFnZXMsIHRoYXQuZGF0YS5jYXJJZCk7XG4gICAgICAgICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vICAgdGhhdC5kb1N1Ym1pdChlLCBpbmRleEltYWdlLCBpbWFnZXMpO1xuICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyB3eC5oaWRlTG9hZGluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmFpbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd3guaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBpZiAodGhhdC5kYXRhLmNhcklkICE9PSAnJykge1xuICAgICAgLy8gICBpbWFnZXMgPSBpbWFnZXMuY29uY2F0KHRoYXQuZGF0YS5vbGRJbWFnZXMpOyAgLy8g5ZCI5bm257yW6L6R5LmL5YmN55qE5rG96L2m5Zu+54mHXG4gICAgICAvLyAgIHRoYXQudXBkYXRlQ2FyKGUsIGluZGV4SW1hZ2UsIGltYWdlcywgdGhhdC5kYXRhLmNhcklkKTtcbiAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAvLyAgIHRoYXQuZG9TdWJtaXQoZSwgaW5kZXhJbWFnZSwgaW1hZ2VzKTtcbiAgICAgIC8vIH1cbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgfVxuICB9LFxuXG4gIC8qKiDliJvlu7rmsb3ovaYgKi9cbiAgZG9TdWJtaXQoZTogYW55LCBpbmRleEltYWdlOiBhbnksIGltYWdlczogYW55KSB7XG4gICAgY29uc3QgcGFyYW1zID0gZS5kZXRhaWwudmFsdWU7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBzdWJtaXREaXNhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgYXBpU2VydmljZVByby5yZWdpc3RlcihPYmplY3QuYXNzaWduKHsgaW1hZ2VzLCBpbmRleEltYWdlIH0sIHBhcmFtcykpLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICB3eC5oaWRlTG9hZGluZygpOyBcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBzdWJtaXREaXNhYmxlOiB0cnVlXG4gICAgICB9KTsgICAgIFxuICAgICAgaWYgKHJlc3VsdC5jb2RlID09PSAyMDApIHtcbiAgICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgdXJsOiBgLi4vY2FyRGV0YWlsL2NhckRldGFpbD9pZD0ke3Jlc3VsdC5kYXRhLmlkfSZmcm9tPWNyZWF0Q2FyUGFnZWAsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChyZXN1bHQuY29kZSA9PT0gMTIwMikge1xuICAgICAgICB1dGlscy5zaG93TW9kYWwoJ+S/oeaBr+agoemqjOS4jemAmui/h++8jOivt+aguOWvueaxvei9puS/oeaBrycpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXRpbHMuc2hvd01vZGFsKCk7XG4gICAgICB9XG4gICAgfSlcbiAgfSxcblxuICAvKiog5pu05paw5rG96L2mICovXG4gIHVwZGF0ZUNhcihlOiBhbnksIGluZGV4SW1hZ2U6IGFueSwgaW1hZ2VzOiBhbnksIGNhcklkOiBhbnkpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGUuZGV0YWlsLnZhbHVlO1xuICAgIGNvbnN0IHBhcmFtcyA9IE9iamVjdC5hc3NpZ24odmFsdWUsIHsnaWQnOiBjYXJJZH0pO1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgc3VibWl0RGlzYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIGFwaVNlcnZpY2VQcm8udXBkYXRlVXNlcihPYmplY3QuYXNzaWduKHsgaW1hZ2VzLCBpbmRleEltYWdlIH0sIHBhcmFtcykpLnRoZW4oKHJlc3VsdDphbnkpID0+IHtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKCk7XG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgc3VibWl0RGlzYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBpZiAocmVzdWx0LmNvZGUgPT09IDIwMCkge1xuICAgICAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgICAgICB1cmw6IGAuLi9jYXJEZXRhaWwvY2FyRGV0YWlsP2lkPSR7cmVzdWx0LmRhdGEuaWR9JmZyb209Y3JlYXRDYXJQYWdlYCxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHJlc3VsdC5jb2RlID09PSAxMjAyKSB7XG4gICAgICAgIHV0aWxzLnNob3dNb2RhbCgn5L+h5oGv5qCh6aqM5LiN6YCa6L+H77yM6K+35qC45a+55rG96L2m5L+h5oGvJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1dGlscy5zaG93TW9kYWwoKTtcbiAgICAgIH1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDliKDpmaTkuIrkvKDnhafniYcgKi9cbiAgZGVsSW1hZ2UoZTogYW55KSB7XG4gICAgY29uc3QgYXJyYXkgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5hcnJheTtcbiAgICBjb25zdCBpbmRleCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmluZGV4O1xuICAgIGlmIChhcnJheSA9PT0gJ29sZEltYWdlcycpIHtcbiAgICAgIGNvbnN0IG9sZEltYWdlcyA9IHRoaXMuZGF0YS5vbGRJbWFnZXM7XG4gICAgICBvbGRJbWFnZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBvbGRJbWFnZXNcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB1cGxvYWRJbWdzID0gdGhpcy5kYXRhLnVwbG9hZEltZ3M7XG4gICAgICB1cGxvYWRJbWdzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgdXBsb2FkSW1nc1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIGNob29zZUluZGV4SW1hZ2UoKSB7XG4gICAgdGhpcy5jaG9vc2VJbWFnZSgxLCAnb25lJyk7XG4gIH0sXG5cbiAgY2hvb3NlT3RoZXJJbWFnZShlOiBhbnkpIHtcbiAgICBjb25zdCBzZWxlY3RQaWN0dXJlTnVtID0gZS50YXJnZXQuZGF0YXNldC5udW07XG4gICAgbGV0IGNvdW50ID0gOTkgLSBzZWxlY3RQaWN0dXJlTnVtXG4gICAgdGhpcy5jaG9vc2VJbWFnZShjb3VudCwgJ211bHRpJyk7XG4gIH0sXG5cbiAgLyoqIOmAieaLqeWbvueJh1xuICAgKiAgQHR5cGUgbXVsdGkt5aSa5byg5Zu+54mHIG9uZS3kuIDlvKDlm77niYdcbiAgICovXG4gIGNob29zZUltYWdlKGNvdW50OiBhbnksIHR5cGU6IGFueSkge1xuICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuICAgIHd4LmNob29zZUltYWdlKHtcbiAgICAgIGNvdW50OiBjb3VudCxcbiAgICAgIHNpemVUeXBlOiBbJ29yaWdpbmFsJywgJ2NvbXByZXNzZWQnXSwgLy8g5Y+v5Lul5oyH5a6a5piv5Y6f5Zu+6L+Y5piv5Y6L57yp5Zu+77yM6buY6K6k5LqM6ICF6YO95pyJXG4gICAgICBzb3VyY2VUeXBlOiBbJ2FsYnVtJywgJ2NhbWVyYSddLCAvLyDlj6/ku6XmjIflrprmnaXmupDmmK/nm7jlhozov5jmmK/nm7jmnLrvvIzpu5jorqTkuozogIXpg73mnIlcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXM6IGFueSkge1xuICAgICAgICBsZXQgdXBsb2FkSW1ncyA9IHRoYXQuZGF0YS51cGxvYWRJbWdzO1xuICAgICAgICBpZiAodHlwZSA9PT0gJ211bHRpJykge1xuICAgICAgICAgIHRoYXQuc2V0RGF0YSEoe1xuICAgICAgICAgICAgdXBsb2FkSW1nczogdXBsb2FkSW1ncy5jb25jYXQocmVzLnRlbXBGaWxlUGF0aHMpLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoYXQuc2V0RGF0YSEoe1xuICAgICAgICAgICAgdXBsb2FkSW5kZXhQYXRoOiByZXMudGVtcEZpbGVQYXRoc1swXSxcbiAgICAgICAgICAgIGluZGV4SW1hZ2U6IHJlcy50ZW1wRmlsZVBhdGhzWzBdLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOaOp+WItnBpY2tlckNpdHkgKi9cbiAgcG9wUGlja2VyKCkge1xuICAgIGxldCBwb3BIaWRkZW4gPSB0aGlzLmRhdGEucG9wSGlkZGVuO1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgcG9wSGlkZGVuOiAhcG9wSGlkZGVuLFxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOmAieaLqeWfjuW4giAqL1xuICBkb1NlbGVjdChlOiBhbnkpIHtcbiAgICBpZiAoZS5kZXRhaWwubmFtZSkge1xuICAgICAgLy8gY29uc3QgY2l0eUlkID0gdGhpcy5nZXRDaXR5SWQoZS5kZXRhaWwubmFtZSk7XG4gICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgcG9wSGlkZGVuOiB0cnVlLFxuICAgICAgICBjaXR5OiBlLmRldGFpbC5uYW1lLFxuICAgICAgICAvLyBjaXR5SWQsXG4gICAgICB9KVxuICAgICAgd3guc2V0U3RvcmFnZSh7XG4gICAgICAgIGtleTogJ2NpdHknLFxuICAgICAgICBkYXRhOiBlLmRldGFpbC5uYW1lLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHsgIC8vIOWPlua2iOaMiemSrlxuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIHBvcEhpZGRlbjogdHJ1ZSxcbiAgICAgIH0pXG4gICAgfVxuICB9LFxuXG5cbiAgLyoqIOaOp+WItnBpY2tCcmFuZCAqL1xuICBwb3BCcmFuZCgpIHtcbiAgICBsZXQgcG9wSGlkZGVuQnJhbmQgPSB0aGlzLmRhdGEucG9wSGlkZGVuQnJhbmQ7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBwb3BIaWRkZW5CcmFuZDogIXBvcEhpZGRlbkJyYW5kLFxuICAgIH0pO1xuICB9LFxuXG4gIC8qKiDpgInmi6nln47luIIgKi9cbiAgZG9TZWxlY3RCcmFuZChlOiBhbnkpIHtcbiAgICBpZiAoZS5kZXRhaWwuYnJhbmQpIHtcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICBwb3BIaWRkZW5CcmFuZDogdHJ1ZSxcbiAgICAgICAgYnJhbmQ6IGUuZGV0YWlsLmJyYW5kLFxuICAgICAgICBicmFuZERldGFpbDogZS5kZXRhaWwuYnJhbmREZXRhaWwsXG4gICAgICB9KTtcbiAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgICAgICBrZXk6ICdicmFuZCcsXG4gICAgICAgIGRhdGE6IGUuZGV0YWlsLmJyYW5kLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHsgIC8vIOWPlua2iOaMiemSrlxuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIHBvcEhpZGRlbkJyYW5kOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKiDnlJ/ml6UgKi9cbiAgYmluZEJpcnRoQ2hhbmdlKGU6IGFueSkge1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgYmlydGg6IGUuZGV0YWlsLnZhbHVlXG4gICAgfSlcbiAgfSxcblxuICBiaW5kRWR1Y2F0aW9uQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgZWR1Y2F0aW9uQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgZWR1Y2F0aW9uOiBlZHVjYXRpb25BcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDlqZrlp7sgKi9cbiAgYmluZE1hcnJpYWdlQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgaXNNYXJyaWFnZUFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGlzTWFycmlhZ2U6IGlzTWFycmlhZ2VBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIGJpbmRIYXNDaGlsZENoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGhhc0NoaWxkQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgaGFzQ2hpbGQ6IGhhc0NoaWxkQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcblxuICBiaW5kV2FudENoaWxkQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgd2FudENoaWxkQXJyYXkgfSA9IHRoaXMuZGF0YVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgaGFzQ2hpbGQ6IHdhbnRDaGlsZEFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgYmluZEhvdXNlQ2hhbmdlKGU6IGFueSkge1xuICAgIGNvbnN0IHsgaG91c2VBcnJheSB9ID0gdGhpcy5kYXRhXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBob3VzZTogaG91c2VBcnJheVtlLmRldGFpbC52YWx1ZV1cbiAgICB9KVxuICB9LFxuXG4gIC8qKiDmgKfliKsgKi9cbiAgYmluZEdlbmRlckNoYW5nZShlOiBhbnkpIHtcbiAgICBjb25zdCB7IGdlbmRlckFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGdlbmRlcjogZ2VuZGVyQXJyYXlbZS5kZXRhaWwudmFsdWVdXG4gICAgfSlcbiAgfSxcbiAgLyoqIOaciOaUtuWFpSAqL1xuICBiaW5kTW9udGhJbmNvbWVDaGFuZ2UoZTogYW55KSB7XG4gICAgY29uc3QgeyBtb250aEluY29tZUFycmF5IH0gPSB0aGlzLmRhdGFcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIG1vbnRoX2luY29tZVJhbmdlOiBtb250aEluY29tZUFycmF5W2UuZGV0YWlsLnZhbHVlXVxuICAgIH0pXG4gIH0sXG5cbiAgaW5wdXROb3RlKGU6IGFueSkge1xuICAgIGNvbnN0IGxlZnRMZW50aCA9ICgzMDAgLSBlLmRldGFpbC52YWx1ZS5sZW5ndGgpO1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgbGVmdExlbnRoOiBsZWZ0TGVudGggPiAwID8gbGVmdExlbnRoIDogMFxuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWIneasoea4suafk+WujOaIkFxuICAgKi9cbiAgb25SZWFkeTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5pi+56S6XG4gICAqL1xuICBvblNob3c6IGZ1bmN0aW9uICgpIHtcbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLpmpDol49cbiAgICovXG4gIG9uSGlkZTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Y246L29XG4gICAqL1xuICBvblVubG9hZDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOmhtemdouebuOWFs+S6i+S7tuWkhOeQhuWHveaVsC0t55uR5ZCs55So5oi35LiL5ouJ5Yqo5L2cXG4gICAqL1xuICBvblB1bGxEb3duUmVmcmVzaDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOmhtemdouS4iuaLieinpuW6leS6i+S7tueahOWkhOeQhuWHveaVsFxuICAgKi9cbiAgb25SZWFjaEJvdHRvbTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG59KSJdfQ==