"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Api = require("../../service/api.service");
const utils = require("../../utils/utils");
const jobJson_1 = require("../../public/json/jobJson");
const app = getApp();
Page({
    data: {
        userInfo: { openid: '' },
        nickName: '',
        weChatId: '',
        gender: '',
        birth: '',
        height: '',
        salary: '',
        region: [],
        workCity: '',
        workProvince: '',
        workRegion: '',
        isMarriage: '',
        education: '',
        hasChild: '',
        wantChild: '',
        jobGeneral: '',
        jobDetail: '',
        haveHouse: '',
        genderIndex: 0,
        salaryIndex: 0,
        dateNow: '',
        submitDisable: false,
        isMarriageArray: ['未婚', '离婚'],
        genderArray: ['男', '女'],
        salaryArray: [
            '5千以下', '5千～1万', '1万～2万', '2万～5万', '5万以上'
        ],
        educationArray: [
            '小学', '初中', '高中', '大专', '大学本科', '硕士', '博士'
        ],
        hasChildArray: ['否', '是'],
        wantChildArray: ['是', '否'],
        haveHouseArray: ['已买房', '未买房'],
        multiIndex: [,],
        multiArray: [[], []],
        jobJson: jobJson_1.default,
    },
    onLoad: function () {
        const multiArray = [[], []];
        jobJson_1.default.data.forEach((item) => {
            multiArray[0].push(item.name);
        });
        jobJson_1.default.data[0].data.forEach((item) => {
            multiArray[1].push(item.name);
        });
        console.log(multiArray);
        this.setData({
            multiArray,
            dateNow: this.getYMD(new Date())
        });
        this.getUserInfo();
    },
    getUserInfo() {
        const openid = app.globalData.userInfo.openid;
        Api.getUserInfo(openid || '').then((result) => {
            if (result) {
                this.setData({
                    userInfo: result.data,
                    nickName: result.data.nickName,
                    weChatId: result.data.weChatId,
                    gender: result.data.gender,
                    birth: result.data.birth ? this.getYMD(result.data.birth) : '',
                    height: result.data.height,
                    salary: result.data.salary,
                    workProvince: result.data.workProvince,
                    workCity: result.data.workCity,
                    workRegion: result.data.workRegion,
                    isMarriage: result.data.isMarriage,
                    education: result.data.education,
                    hasChild: result.data.hasChild,
                    wantChild: result.data.wantChild,
                    jobGeneral: result.data.jobGeneral,
                    jobDetail: result.data.jobDetail,
                    haveHouse: result.data.haveHouse,
                });
                console.log('data', this.data);
            }
        });
    },
    getYMD(dateStr) {
        const date = new Date(dateStr);
        const year = date.getFullYear();
        let month = date.getMonth() + 1;
        let monthStr = month <= 9 ? `0${month}` : month;
        let day = date.getDate();
        let dayStr = day <= 9 ? `0${day}` : day;
        return `${year}-${monthStr}-${dayStr}`;
    },
    onSubmit(e) {
        let that = this;
        const value = e.detail.value;
        if (!utils.validateEmpty(value.nickName, '请输入昵称') ||
            (!utils.validateEmpty(value.weChatId, '请输入微信号') ||
                !utils.validateEmpty(value.gender, '请选择性别') ||
                !utils.validateEmpty(value.birth, '请选择生日') ||
                !utils.validateEmpty(value.height, '请输入身高') ||
                !utils.validateEmpty(value.salary, '请选择收入') ||
                !utils.validateEmpty(this.data.workProvince, '请选择工作所在地') ||
                !utils.validateEmpty(this.data.education, '请选择学历') ||
                !utils.validateEmpty(this.data.isMarriage, '请选择婚姻状况') ||
                !utils.validateEmpty(this.data.hasChild, '请选择是否有孩子') ||
                !utils.validateEmpty(this.data.wantChild, '请选择是否想要孩子') ||
                !utils.validateEmpty(this.data.haveHouse, '请选择买房情况'))) {
            return false;
        }
        that.doSubmit(e);
    },
    doSubmit(e) {
        const params = e.detail.value;
        console.log(e.detail.value);
        const { userInfo } = this.data;
        const dataParams = {
            workProvince: this.data.workProvince,
            workCity: this.data.workCity,
            workRegion: this.data.workRegion,
            jobGeneral: this.data.jobGeneral,
            jobDetail: this.data.jobDetail,
        };
        this.setData({
            submitDisable: true
        });
        console.log(Object.assign(userInfo, params, dataParams));
        Api.updateUser(Object.assign(userInfo, params, dataParams)).then((result) => {
            wx.hideLoading();
            this.setData({
                submitDisable: true
            });
            if (result.code === 200) {
                wx.showToast({
                    title: '更新成功',
                    icon: 'success',
                    duration: 1000,
                    mask: true
                });
                setTimeout(() => {
                    wx.switchTab({
                        url: `../myHome/myHome`,
                    });
                }, 1000);
            }
            else {
                utils.showModal('系统异常，请稍后再试');
            }
        });
    },
    bindBirthChange(e) {
        this.setData({
            birth: e.detail.value
        });
    },
    bindEducationChange(e) {
        const { educationArray } = this.data;
        this.setData({
            education: educationArray[e.detail.value]
        });
    },
    bindMarriageChange(e) {
        const { isMarriageArray } = this.data;
        this.setData({
            isMarriage: isMarriageArray[e.detail.value]
        });
    },
    bindHasChildChange(e) {
        const { hasChildArray } = this.data;
        this.setData({
            hasChild: hasChildArray[e.detail.value]
        });
    },
    bindWantChildChange(e) {
        const { wantChildArray } = this.data;
        this.setData({
            wantChild: wantChildArray[e.detail.value]
        });
    },
    bindHaveHouseChange(e) {
        const { haveHouseArray } = this.data;
        this.setData({
            haveHouse: haveHouseArray[e.detail.value]
        });
    },
    bindGenderChange(e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            gender: parseInt(e.detail.value) + 1
        });
        console.log('parseInt(e.detail.value)', (parseInt(e.detail.value) + 1));
    },
    bindSalaryChange(e) {
        const { salaryArray } = this.data;
        this.setData({
            salary: salaryArray[e.detail.value]
        });
    },
    bindRegionChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        let region = e.detail.value;
        this.setData({
            region,
            workProvince: region[0],
            workCity: region[1],
            workRegion: region[2],
        });
    },
    bindMultiPickerChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        const { multiArray } = this.data;
        let multiIndex = e.detail.value;
        this.setData({
            multiIndex,
            jobGeneral: multiArray[0][multiIndex[0]],
            jobDetail: multiArray[1][multiIndex[1]],
        });
    },
    bindMultiPickerColumnChange: function (e) {
        console.log('修改的列为', e.detail.column, '，值为', e.detail.value);
        const { multiArray, multiIndex } = this.data;
        multiIndex[e.detail.column] = e.detail.value;
        if (e.detail.column === 0) {
            multiArray[1] = [];
            console.log(jobJson_1.default.data[multiIndex[0] || 0].data);
            jobJson_1.default.data[multiIndex[0] || 0].data.forEach((item) => {
                multiArray[1].push(item.name);
            });
        }
        this.setData({
            multiArray,
        });
    },
    bindDateChange: function (e) {
        console.log('picker发送选择改变，携带值为', e.detail.value);
        this.setData({
            date: e.detail.value
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLGlEQUFpRDtBQUNqRCwyQ0FBMkM7QUFDM0MsdURBQWdEO0FBRWhELE1BQU0sR0FBRyxHQUFHLE1BQU0sRUFBVSxDQUFDO0FBRTdCLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7UUFDeEIsUUFBUSxFQUFFLEVBQUU7UUFDWixRQUFRLEVBQUUsRUFBRTtRQUNaLE1BQU0sRUFBRSxFQUFFO1FBQ1YsS0FBSyxFQUFFLEVBQUU7UUFDVCxNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxFQUFFO1FBQ1YsTUFBTSxFQUFFLEVBQUU7UUFDVixRQUFRLEVBQUUsRUFBRTtRQUNaLFlBQVksRUFBRSxFQUFFO1FBQ2hCLFVBQVUsRUFBRSxFQUFFO1FBQ2QsVUFBVSxFQUFFLEVBQUU7UUFDZCxTQUFTLEVBQUUsRUFBRTtRQUNiLFFBQVEsRUFBRSxFQUFFO1FBQ1osU0FBUyxFQUFFLEVBQUU7UUFDYixVQUFVLEVBQUUsRUFBRTtRQUNkLFNBQVMsRUFBRSxFQUFFO1FBQ2IsU0FBUyxFQUFFLEVBQUU7UUFDYixXQUFXLEVBQUUsQ0FBQztRQUNkLFdBQVcsRUFBRSxDQUFDO1FBQ2QsT0FBTyxFQUFFLEVBQUU7UUFDWCxhQUFhLEVBQUUsS0FBSztRQUNwQixlQUFlLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQzdCLFdBQVcsRUFBRSxDQUFDLEdBQUcsRUFBQyxHQUFHLENBQUM7UUFDdEIsV0FBVyxFQUFFO1lBQ1gsTUFBTSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU07U0FDMUM7UUFDRCxjQUFjLEVBQUU7WUFDZCxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFB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SSxDQUFDLENBQUM7WUFDbkQsaUJBQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtnQkFDMUQsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDaEMsQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUNELElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixVQUFVO1NBRVgsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNELGNBQWMsRUFBRSxVQUFVLENBQUs7UUFDN0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ2hELElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQ3JCLENBQUMsQ0FBQTtJQUNKLENBQUM7Q0FFRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0ICogYXMgQXBpIGZyb20gJy4uLy4uL3NlcnZpY2UvYXBpLnNlcnZpY2UnO1xyXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBqb2JKc29uIGZyb20gJy4uLy4uL3B1YmxpYy9qc29uL2pvYkpzb24nO1xyXG5pbXBvcnQgeyBJTXlBcHAgfSBmcm9tICcuLi8uLi9hcHAnO1xyXG5jb25zdCBhcHAgPSBnZXRBcHA8SU15QXBwPigpO1xyXG5cclxuUGFnZSh7XHJcbiAgZGF0YToge1xyXG4gICAgdXNlckluZm86IHsgb3BlbmlkOiAnJyB9LFxyXG4gICAgbmlja05hbWU6ICcnLFxyXG4gICAgd2VDaGF0SWQ6ICcnLCAvLyDlvq7kv6Hlj7dcclxuICAgIGdlbmRlcjogJycsIFxyXG4gICAgYmlydGg6ICcnLCAgICAvLyDnlJ/ml6VcclxuICAgIGhlaWdodDogJycsICAgLy8g6Lqr6auYXHJcbiAgICBzYWxhcnk6ICcnLCBcclxuICAgIHJlZ2lvbjogW10sXHJcbiAgICB3b3JrQ2l0eTogJycsXHJcbiAgICB3b3JrUHJvdmluY2U6ICcnLFxyXG4gICAgd29ya1JlZ2lvbjogJycsXHJcbiAgICBpc01hcnJpYWdlOiAnJyxcclxuICAgIGVkdWNhdGlvbjogJycsIFxyXG4gICAgaGFzQ2hpbGQ6ICcnLCBcclxuICAgIHdhbnRDaGlsZDogJycsIFxyXG4gICAgam9iR2VuZXJhbDogJycsXHJcbiAgICBqb2JEZXRhaWw6ICcnLFxyXG4gICAgaGF2ZUhvdXNlOiAnJywgICBcclxuICAgIGdlbmRlckluZGV4OiAwLFxyXG4gICAgc2FsYXJ5SW5kZXg6IDAsXHJcbiAgICBkYXRlTm93OiAnJyxcclxuICAgIHN1Ym1pdERpc2FibGU6IGZhbHNlLFxyXG4gICAgaXNNYXJyaWFnZUFycmF5OiBbJ+acquWpmicsICfnprvlqZonXSxcclxuICAgIGdlbmRlckFycmF5OiBbJ+eUtycsJ+WlsyddLFxyXG4gICAgc2FsYXJ5QXJyYXk6IFtcclxuICAgICAgJzXljYPku6XkuIsnLCAnNeWNg++9njHkuIcnLCAnMeS4h++9njLkuIcnLCAnMuS4h++9njXkuIcnLCAnNeS4h+S7peS4iidcclxuICAgIF0sXHJcbiAgICBlZHVjYXRpb25BcnJheTogW1xyXG4gICAgICAn5bCP5a2mJywgJ+WIneS4rScsICfpq5jkuK0nLCAn5aSn5LiTJywgJ+Wkp+WtpuacrOenkScsICfnoZXlo6snLCAn5Y2a5aOrJ1xyXG4gICAgXSxcclxuICAgIGhhc0NoaWxkQXJyYXk6IFsn5ZCmJywgJ+aYryddLFxyXG4gICAgd2FudENoaWxkQXJyYXk6IFsn5pivJywgJ+WQpiddLFxyXG4gICAgaGF2ZUhvdXNlQXJyYXk6IFsn5bey5Lmw5oi/JywgJ+acquS5sOaIvyddLFxyXG4gICAgbXVsdGlJbmRleDogWywgXSxcclxuICAgIG11bHRpQXJyYXk6IFtbXSxbXV0gYXMgYW55LFxyXG4gICAgam9iSnNvbjogam9iSnNvbixcclxuICB9LFxyXG5cclxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIGNvbnN0IG11bHRpQXJyYXkgPSBbW10sIFtdXSBhcyBhbnk7XHJcbiAgICBqb2JKc29uLmRhdGEuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgIG11bHRpQXJyYXlbMF0ucHVzaChpdGVtLm5hbWUpO1xyXG4gICAgfSk7XHJcbiAgICBqb2JKc29uLmRhdGFbMF0uZGF0YS5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgbXVsdGlBcnJheVsxXS5wdXNoKGl0ZW0ubmFtZSk7XHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKG11bHRpQXJyYXkpO1xyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIG11bHRpQXJyYXksXHJcbiAgICAgIGRhdGVOb3c6IHRoaXMuZ2V0WU1EKG5ldyBEYXRlKCkpXHJcbiAgICB9KTtcclxuICAgIHRoaXMuZ2V0VXNlckluZm8oKTtcclxuICB9LFxyXG5cclxuICAvKiog55So5oi36K+m5oOFICovXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCBvcGVuaWQgPSBhcHAuZ2xvYmFsRGF0YS51c2VySW5mby5vcGVuaWQ7XHJcbiAgICBBcGkuZ2V0VXNlckluZm8ob3BlbmlkIHx8ICcnKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xyXG4gICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgICAgICB1c2VySW5mbzogcmVzdWx0LmRhdGEsXHJcbiAgICAgICAgICBuaWNrTmFtZTogcmVzdWx0LmRhdGEubmlja05hbWUsXHJcbiAgICAgICAgICB3ZUNoYXRJZDogcmVzdWx0LmRhdGEud2VDaGF0SWQsXHJcbiAgICAgICAgICBnZW5kZXI6IHJlc3VsdC5kYXRhLmdlbmRlcixcclxuICAgICAgICAgIGJpcnRoOiByZXN1bHQuZGF0YS5iaXJ0aD90aGlzLmdldFlNRChyZXN1bHQuZGF0YS5iaXJ0aCk6JycsICAgICAgICAvLyDnlJ/ml6VcclxuICAgICAgICAgIGhlaWdodDogcmVzdWx0LmRhdGEuaGVpZ2h0LCAgICAgICAgICAgICAgICAgICAvLyDouqvpq5hcclxuICAgICAgICAgIHNhbGFyeTogcmVzdWx0LmRhdGEuc2FsYXJ5LFxyXG4gICAgICAgICAgd29ya1Byb3ZpbmNlOiByZXN1bHQuZGF0YS53b3JrUHJvdmluY2UsXHJcbiAgICAgICAgICB3b3JrQ2l0eTogcmVzdWx0LmRhdGEud29ya0NpdHksXHJcbiAgICAgICAgICB3b3JrUmVnaW9uOiByZXN1bHQuZGF0YS53b3JrUmVnaW9uLCAgICAgICAgXHJcbiAgICAgICAgICBpc01hcnJpYWdlOiByZXN1bHQuZGF0YS5pc01hcnJpYWdlLCAgICAgICAgICAgLy8g5ama5ae754q25Ya1XHJcbiAgICAgICAgICBlZHVjYXRpb246IHJlc3VsdC5kYXRhLmVkdWNhdGlvbiwgICAgICAgICAgICAgLy8g5pWZ6IKyXHJcbiAgICAgICAgICBoYXNDaGlsZDogcmVzdWx0LmRhdGEuaGFzQ2hpbGQsXHJcbiAgICAgICAgICB3YW50Q2hpbGQ6IHJlc3VsdC5kYXRhLndhbnRDaGlsZCxcclxuICAgICAgICAgIGpvYkdlbmVyYWw6IHJlc3VsdC5kYXRhLmpvYkdlbmVyYWwsXHJcbiAgICAgICAgICBqb2JEZXRhaWw6IHJlc3VsdC5kYXRhLmpvYkRldGFpbCxcclxuICAgICAgICAgIGhhdmVIb3VzZTogcmVzdWx0LmRhdGEuaGF2ZUhvdXNlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdkYXRhJywgdGhpcy5kYXRhKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9LFxyXG5cclxuICBnZXRZTUQoZGF0ZVN0cjogYW55KSB7XHJcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cik7XHJcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgbGV0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcclxuICAgIGxldCBtb250aFN0ciA9IG1vbnRoIDw9IDkgPyBgMCR7bW9udGh9YCA6IG1vbnRoO1xyXG4gICAgbGV0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xyXG4gICAgbGV0IGRheVN0ciA9IGRheSA8PSA5ID8gYDAke2RheX1gIDogZGF5O1xyXG4gICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGhTdHJ9LSR7ZGF5U3RyfWBcclxuICB9LFxyXG5cclxuICAvKiog5YeG5aSH5o+Q5LqkICovXHJcbiAgb25TdWJtaXQoZTogYW55KTogYW55IHtcclxuICAgIGxldCB0aGF0ID0gdGhpcztcclxuICAgIGNvbnN0IHZhbHVlID0gZS5kZXRhaWwudmFsdWU7XHJcblxyXG4gICAgaWYgKCF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLm5pY2tOYW1lLCAn6K+36L6T5YWl5pi156ewJykgfHxcclxuICAgICAgKCF1dGlscy52YWxpZGF0ZUVtcHR5KHZhbHVlLndlQ2hhdElkLCAn6K+36L6T5YWl5b6u5L+h5Y+3JykgfHxcclxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuZ2VuZGVyLCAn6K+36YCJ5oup5oCn5YirJykgfHxcclxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodmFsdWUuYmlydGgsICfor7fpgInmi6nnlJ/ml6UnKSB8fFxyXG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5oZWlnaHQsICfor7fovpPlhaXouqvpq5gnKSB8fFxyXG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh2YWx1ZS5zYWxhcnksICfor7fpgInmi6nmlLblhaUnKSB8fFxyXG4gICAgICAhdXRpbHMudmFsaWRhdGVFbXB0eSh0aGlzLmRhdGEud29ya1Byb3ZpbmNlLCAn6K+36YCJ5oup5bel5L2c5omA5Zyo5ZywJykgfHxcclxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLmVkdWNhdGlvbiwgJ+ivt+mAieaLqeWtpuWOhicpIHx8XHJcbiAgICAgICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5pc01hcnJpYWdlLCAn6K+36YCJ5oup5ama5ae754q25Ya1JykgfHxcclxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLmhhc0NoaWxkLCAn6K+36YCJ5oup5piv5ZCm5pyJ5a2p5a2QJykgfHxcclxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLndhbnRDaGlsZCwgJ+ivt+mAieaLqeaYr+WQpuaDs+imgeWtqeWtkCcpIHx8XHJcbiAgICAgIC8vICF1dGlscy52YWxpZGF0ZUVtcHR5KHRoaXMuZGF0YS5qb2JHZW5lcmFsLCAn6K+36YCJ5oup6IGM5LiaJykgfHxcclxuICAgICAgIXV0aWxzLnZhbGlkYXRlRW1wdHkodGhpcy5kYXRhLmhhdmVIb3VzZSwgJ+ivt+mAieaLqeS5sOaIv+aDheWGtScpKSkge1xyXG5cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRoYXQuZG9TdWJtaXQoZSk7XHJcbiAgfSxcclxuXHJcbiAgLyoqIHVwZGF0ZSAqL1xyXG4gIGRvU3VibWl0KGU6IGFueSkge1xyXG4gICAgY29uc3QgcGFyYW1zID0gZS5kZXRhaWwudmFsdWU7XHJcbiAgICBjb25zb2xlLmxvZyhlLmRldGFpbC52YWx1ZSk7XHJcbiAgICBjb25zdCB7IHVzZXJJbmZvIH0gPSB0aGlzLmRhdGE7XHJcbiAgICBjb25zdCBkYXRhUGFyYW1zID0ge1xyXG4gICAgICB3b3JrUHJvdmluY2U6IHRoaXMuZGF0YS53b3JrUHJvdmluY2UsXHJcbiAgICAgIHdvcmtDaXR5OiB0aGlzLmRhdGEud29ya0NpdHksXHJcbiAgICAgIHdvcmtSZWdpb246IHRoaXMuZGF0YS53b3JrUmVnaW9uLFxyXG4gICAgICBqb2JHZW5lcmFsOiB0aGlzLmRhdGEuam9iR2VuZXJhbCxcclxuICAgICAgam9iRGV0YWlsOiB0aGlzLmRhdGEuam9iRGV0YWlsLFxyXG4gICAgfVxyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIHN1Ym1pdERpc2FibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coT2JqZWN0LmFzc2lnbih1c2VySW5mbywgcGFyYW1zLCBkYXRhUGFyYW1zKSk7XHJcbiAgICBBcGkudXBkYXRlVXNlcihPYmplY3QuYXNzaWduKHVzZXJJbmZvLCBwYXJhbXMsIGRhdGFQYXJhbXMpKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xyXG4gICAgICB3eC5oaWRlTG9hZGluZygpOyBcclxuICAgICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgICAgc3VibWl0RGlzYWJsZTogdHJ1ZVxyXG4gICAgICB9KTsgICAgIFxyXG4gICAgICBpZiAocmVzdWx0LmNvZGUgPT09IDIwMCkge1xyXG4gICAgICAgIHd4LnNob3dUb2FzdCh7XHJcbiAgICAgICAgICB0aXRsZTogJ+abtOaWsOaIkOWKnycsXHJcbiAgICAgICAgICBpY29uOiAnc3VjY2VzcycsXHJcbiAgICAgICAgICBkdXJhdGlvbjogMTAwMCxcclxuICAgICAgICAgIG1hc2s6IHRydWVcclxuICAgICAgICB9KVxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgd3guc3dpdGNoVGFiKHtcclxuICAgICAgICAgICAgdXJsOiBgLi4vbXlIb21lL215SG9tZWAsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB1dGlscy5zaG93TW9kYWwoJ+ezu+e7n+W8guW4uO+8jOivt+eojeWQjuWGjeivlScpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIC8qKiDnlJ/ml6UgKi9cclxuICBiaW5kQmlydGhDaGFuZ2UoZTogYW55KSB7XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgYmlydGg6IGUuZGV0YWlsLnZhbHVlXHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIGJpbmRFZHVjYXRpb25DaGFuZ2UoZTogYW55KSB7XHJcbiAgICBjb25zdCB7IGVkdWNhdGlvbkFycmF5IH0gPSB0aGlzLmRhdGFcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBlZHVjYXRpb246IGVkdWNhdGlvbkFycmF5W2UuZGV0YWlsLnZhbHVlXVxyXG4gICAgfSlcclxuICB9LFxyXG5cclxuICAvKiog5ama5ae7ICovXHJcbiAgYmluZE1hcnJpYWdlQ2hhbmdlKGU6IGFueSkge1xyXG4gICAgY29uc3QgeyBpc01hcnJpYWdlQXJyYXkgfSA9IHRoaXMuZGF0YVxyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIGlzTWFycmlhZ2U6IGlzTWFycmlhZ2VBcnJheVtlLmRldGFpbC52YWx1ZV1cclxuICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgYmluZEhhc0NoaWxkQ2hhbmdlKGU6IGFueSkge1xyXG4gICAgY29uc3QgeyBoYXNDaGlsZEFycmF5IH0gPSB0aGlzLmRhdGFcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBoYXNDaGlsZDogaGFzQ2hpbGRBcnJheVtlLmRldGFpbC52YWx1ZV1cclxuICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgYmluZFdhbnRDaGlsZENoYW5nZShlOiBhbnkpIHtcclxuICAgIGNvbnN0IHsgd2FudENoaWxkQXJyYXkgfSA9IHRoaXMuZGF0YVxyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIHdhbnRDaGlsZDogd2FudENoaWxkQXJyYXlbZS5kZXRhaWwudmFsdWVdXHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIC8qKiDkubDmiL8gKi9cclxuICBiaW5kSGF2ZUhvdXNlQ2hhbmdlKGU6IGFueSkge1xyXG4gICAgY29uc3QgeyBoYXZlSG91c2VBcnJheSB9ID0gdGhpcy5kYXRhXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgaGF2ZUhvdXNlOiBoYXZlSG91c2VBcnJheVtlLmRldGFpbC52YWx1ZV1cclxuICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgLyoqIOaAp+WIqyAqL1xyXG4gIGJpbmRHZW5kZXJDaGFuZ2UoZTogYW55KSB7XHJcbiAgICBjb25zb2xlLmxvZygncGlja2Vy5Y+R6YCB6YCJ5oup5pS55Y+Y77yM5pC65bim5YC85Li6JywgZS5kZXRhaWwudmFsdWUpXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgZ2VuZGVyOiBwYXJzZUludChlLmRldGFpbC52YWx1ZSkgKyAxXHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKCdwYXJzZUludChlLmRldGFpbC52YWx1ZSknLCAocGFyc2VJbnQoZS5kZXRhaWwudmFsdWUpICsgMSkpXHJcbiAgfSxcclxuXHJcbiAgLyoqIOaciOaUtuWFpSAqL1xyXG4gIGJpbmRTYWxhcnlDaGFuZ2UoZTogYW55KSB7XHJcbiAgICBjb25zdCB7IHNhbGFyeUFycmF5IH0gPSB0aGlzLmRhdGFcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBzYWxhcnk6IHNhbGFyeUFycmF5W2UuZGV0YWlsLnZhbHVlXVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgLyoqIOW3peS9nOWcsOWMuiAqL1xyXG4gIGJpbmRSZWdpb25DaGFuZ2U6IGZ1bmN0aW9uIChlOmFueSkge1xyXG4gICAgY29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKVxyXG4gICAgbGV0IHJlZ2lvbiA9IGUuZGV0YWlsLnZhbHVlO1xyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIHJlZ2lvbixcclxuICAgICAgd29ya1Byb3ZpbmNlOiByZWdpb25bMF0sXHJcbiAgICAgIHdvcmtDaXR5OiByZWdpb25bMV0sXHJcbiAgICAgIHdvcmtSZWdpb246IHJlZ2lvblsyXSxcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGJpbmRNdWx0aVBpY2tlckNoYW5nZTogZnVuY3Rpb24gKGU6IGFueSkge1xyXG4gICAgY29uc29sZS5sb2coJ3BpY2tlcuWPkemAgemAieaLqeaUueWPmO+8jOaQuuW4puWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKTtcclxuICAgIGNvbnN0IHsgbXVsdGlBcnJheSB9ID0gdGhpcy5kYXRhO1xyXG4gICAgbGV0IG11bHRpSW5kZXggPSBlLmRldGFpbC52YWx1ZTtcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBtdWx0aUluZGV4LFxyXG4gICAgICBqb2JHZW5lcmFsOiBtdWx0aUFycmF5WzBdW211bHRpSW5kZXhbMF1dLFxyXG4gICAgICBqb2JEZXRhaWw6IG11bHRpQXJyYXlbMV1bbXVsdGlJbmRleFsxXV0sXHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIGJpbmRNdWx0aVBpY2tlckNvbHVtbkNoYW5nZTogZnVuY3Rpb24gKGU6IGFueSkge1xyXG4gICAgY29uc29sZS5sb2coJ+S/ruaUueeahOWIl+S4uicsIGUuZGV0YWlsLmNvbHVtbiwgJ++8jOWAvOS4uicsIGUuZGV0YWlsLnZhbHVlKTtcclxuICAgIGNvbnN0IHsgbXVsdGlBcnJheSwgbXVsdGlJbmRleCB9ID0gdGhpcy5kYXRhO1xyXG4gICAgbXVsdGlJbmRleFtlLmRldGFpbC5jb2x1bW5dID0gZS5kZXRhaWwudmFsdWU7XHJcbiAgICBpZiAoZS5kZXRhaWwuY29sdW1uID09PSAwKSB7XHJcbiAgICAgIG11bHRpQXJyYXlbMV0gPSBbXTtcclxuICAgICAgY29uc29sZS5sb2coam9iSnNvbi5kYXRhW211bHRpSW5kZXhbMF0gfHwgMF0uZGF0YSk7XHJcbiAgICAgIGpvYkpzb24uZGF0YVttdWx0aUluZGV4WzBdIHx8IDBdLmRhdGEuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgICAgbXVsdGlBcnJheVsxXS5wdXNoKGl0ZW0ubmFtZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIG11bHRpQXJyYXksXHJcbiAgICAgIC8vIG11bHRpSW5kZXgsXHJcbiAgICB9KTtcclxuICB9LFxyXG4gIGJpbmREYXRlQ2hhbmdlOiBmdW5jdGlvbiAoZTphbnkpIHtcclxuICAgIGNvbnNvbGUubG9nKCdwaWNrZXLlj5HpgIHpgInmi6nmlLnlj5jvvIzmkLrluKblgLzkuLonLCBlLmRldGFpbC52YWx1ZSlcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBkYXRlOiBlLmRldGFpbC52YWx1ZVxyXG4gICAgfSlcclxuICB9LFxyXG4gXHJcbn0pIl19