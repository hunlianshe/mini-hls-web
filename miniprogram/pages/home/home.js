"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Api = require("../../service/api.service");
const app = getApp();
Page({
    data: {
        userInfo: { constellation: '' },
        psyTest: [],
        currShopList: [],
        dataAlready: false,
        currentCity: '',
        selectValue: '',
        currentQrcode: '',
        currentPhone: '',
        phone: '',
        popHidden: true,
        pageLoaded: false,
        popWechat: false,
        currentPage: 1,
        pageSize: 10,
        totalCount: 0,
        pullDown: false,
        pullUp: false,
        horoscopeData: {},
    },
    onLoad() {
        let _this = this;
        wx.getStorage({
            key: 'user',
            success: function (res) {
                _this.setData({
                    userInfo: res.data,
                });
                _this.getUserInfo();
                _this.getPsyList();
            },
        });
        this.getRightConfig();
    },
    getRightConfig() {
        const rightConfig = [
            {
                name: '无会员',
                horoscope: 99999,
                yearPrice: 0,
                seasonPrice: 0,
                monthPrice: 0,
                psychologicalTest: 99999,
                constellationMatching: 99999,
                fateMatch: 3,
                fateWatch: 20,
                fateChat: 3,
                whoLikeMe: 0,
                likeEach: 0,
            },
            {
                name: '黄铜会员',
                yearPrice: 120,
                seasonPrice: 30,
                monthPrice: 10,
                horoscope: 99999,
                psychologicalTest: 99999,
                constellationMatching: 99999,
                fateMatch: 99999,
                fateWatch: 99999,
                fateChat: 20,
                whoLikeMe: 99999,
                likeEach: 99999,
            },
            {
                name: '白金会员',
                yearPrice: 240,
                seasonPrice: 60,
                monthPrice: 20,
                horoscope: 99999,
                psychologicalTest: 99999,
                constellationMatching: 99999,
                fateMatch: 99999,
                fateWatch: 99999,
                fateChat: 9999,
                whoLikeMe: 99999,
                likeEach: 99999,
            },
        ];
        wx.setStorage({ key: 'rightConfig', data: rightConfig });
    },
    goXzys() {
        wx.navigateTo({
            url: `../xzys/xzys`,
        });
    },
    goXlcsList() {
        wx.navigateTo({
            url: `../xlcsList/xlcsList`,
        });
    },
    doTest(e) {
        const { id, type, } = e.currentTarget.dataset;
        if (type === '3') {
            wx.navigateTo({
                url: `../qsqy/qsqy?id=${id}`,
            });
        }
        else {
            wx.navigateTo({
                url: `../xlcsDetail/xlcsDetail?id=${id}`,
            });
        }
    },
    goMatch() {
        wx.navigateTo({
            url: `../matcheXz/matcheXz`,
        });
    },
    getPsyList() {
        Api.getPsyList().then((result) => {
            this.setData({
                psyTest: result.data,
            });
        });
    },
    getHoroscopet(e) {
        const consName = this.data.userInfo.constellation ? this.data.userInfo.constellation : '白羊座';
        const { type } = e.currentTarget.dataset;
        wx.navigateTo({
            url: '../realXzysDetail/realXzysDetail?consName=' + consName + '&type=' + type
        });
    },
    getUserInfo() {
        const { openid } = this.data.userInfo;
        Api.getUserInfo(openid || '').then((result) => {
            if (result) {
                const userInfo = result.data;
                app.globalData.userInfo = result.data;
                wx.setStorage({
                    key: 'userInfo',
                    data: Object.assign({ openid }, result.data),
                });
                this.setData({
                    userInfo,
                    pageLoaded: true,
                });
            }
        });
    },
    topInfo() {
        wx.navigateTo({
            url: '../bar/index'
        });
    },
    onReady: function () {
    },
    onShow: function () {
        const _this = this;
        wx.getStorage({
            key: 'user',
            success: function (res) {
                _this.setData({
                    userInfo: res.data,
                });
                _this.getUserInfo();
                _this.getPsyList();
            },
        });
        _this.getPsyList();
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
        this.setData({
            pullDown: true,
            pullUp: false
        });
        wx.stopPullDownRefresh();
    },
    onReachBottom: function () {
        this.setData({
            pullDown: false,
            pullUp: true
        });
    },
    onShareAppMessage: function (options) {
        console.log('onShareAppMessage options', options);
        return {};
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaG9tZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhvbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBaUQ7QUFFakQsTUFBTSxHQUFHLEdBQUcsTUFBTSxFQUFVLENBQUM7QUFLN0IsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osUUFBUSxFQUFFLEVBQUUsYUFBYSxFQUFFLEVBQUUsRUFBVTtRQUN2QyxPQUFPLEVBQUUsRUFBRTtRQUNYLFlBQVksRUFBRSxFQUFFO1FBQ2hCLFdBQVcsRUFBRSxLQUFLO1FBQ2xCLFdBQVcsRUFBRSxFQUFFO1FBQ2YsV0FBVyxFQUFFLEVBQUU7UUFDZixhQUFhLEVBQUUsRUFBRTtRQUNqQixZQUFZLEVBQUUsRUFBRTtRQUNoQixLQUFLLEVBQUUsRUFBRTtRQUNULFNBQVMsRUFBRSxJQUFJO1FBQ2YsVUFBVSxFQUFFLEtBQUs7UUFDakIsU0FBUyxFQUFFLEtBQUs7UUFDaEIsV0FBVyxFQUFFLENBQUM7UUFDZCxRQUFRLEVBQUUsRUFBRTtRQUNaLFVBQVUsRUFBRSxDQUFDO1FBQ2IsUUFBUSxFQUFFLEtBQUs7UUFDZixNQUFNLEVBQUUsS0FBSztRQUNiLGFBQWEsRUFBRSxFQUFlO0tBQy9CO0lBRUQsTUFBTTtRQUNKLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQztRQUNqQixFQUFFLENBQUMsVUFBVSxDQUFDO1lBQ1osR0FBRyxFQUFFLE1BQU07WUFDWCxPQUFPLEVBQUUsVUFBUyxHQUFHO2dCQUNuQixLQUFLLENBQUMsT0FBUSxDQUFDO29CQUNiLFFBQVEsRUFBRSxHQUFHLENBQUMsSUFBSTtpQkFDbkIsQ0FBQyxDQUFDO2dCQUNILEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDcEIsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ3JCLENBQUM7U0FDRixDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUdELGNBQWM7UUFRWixNQUFN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RztnQkFDbEIsS0FBSyxDQUFDLE9BQVEsQ0FBQztvQkFDWCxRQUFRLEVBQUUsR0FBRyxDQUFDLElBQUk7aUJBQ3JCLENBQUMsQ0FBQztnQkFDSCxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ3BCLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUN2QixDQUFDO1NBQ0osQ0FBQyxDQUFDO1FBQ0gsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ3JCLENBQUM7SUFLRCxNQUFNLEVBQUU7SUFFUixDQUFDO0lBS0QsUUFBUSxFQUFFO0lBRVYsQ0FBQztJQUtELGlCQUFpQixFQUFFO1FBQ2pCLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsSUFBSTtZQUNkLE1BQU0sRUFBRSxLQUFLO1NBQ2QsQ0FBQyxDQUFDO1FBQ0gsRUFBRSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDM0IsQ0FBQztJQUtELGFBQWEsRUFBRTtRQUNiLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsS0FBSztZQUNmLE1BQU0sRUFBRSxJQUFJO1NBQ2IsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUtELGlCQUFpQixFQUFFLFVBQVUsT0FBaUQ7UUFDNUUsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNsRCxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7Q0FDRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBBcGkgZnJvbSAnLi4vLi4vc2VydmljZS9hcGkuc2VydmljZSc7XG5pbXBvcnQgeyBJTXlBcHAgfSBmcm9tICcuLi8uLi9hcHAnO1xuY29uc3QgYXBwID0gZ2V0QXBwPElNeUFwcD4oKTtcblxuaW1wb3J0IEhvcm9zY29wZSBmcm9tICcuLi8uLi9pbnRlcmZhY2UvaG9yb3Njb3BlJztcbmltcG9ydCBVc2VyIGZyb20gJy4uLy4uL2ludGVyZmFjZS91c2VyJztcblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICB1c2VySW5mbzogeyBjb25zdGVsbGF0aW9uOiAnJyB9IGFzIFVzZXIsXG4gICAgcHN5VGVzdDogW10sXG4gICAgY3VyclNob3BMaXN0OiBbXSxcbiAgICBkYXRhQWxyZWFkeTogZmFsc2UsXG4gICAgY3VycmVudENpdHk6ICcnLFxuICAgIHNlbGVjdFZhbHVlOiAnJyxcbiAgICBjdXJyZW50UXJjb2RlOiAnJyxcbiAgICBjdXJyZW50UGhvbmU6ICcnLFxuICAgIHBob25lOiAnJyxcbiAgICBwb3BIaWRkZW46IHRydWUsXG4gICAgcGFnZUxvYWRlZDogZmFsc2UsXG4gICAgcG9wV2VjaGF0OiBmYWxzZSxcbiAgICBjdXJyZW50UGFnZTogMSxcbiAgICBwYWdlU2l6ZTogMTAsXG4gICAgdG90YWxDb3VudDogMCxcbiAgICBwdWxsRG93bjogZmFsc2UsXG4gICAgcHVsbFVwOiBmYWxzZSxcbiAgICBob3Jvc2NvcGVEYXRhOiB7fSBhcyBIb3Jvc2NvcGUsXG4gIH0sXG5cbiAgb25Mb2FkICgpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHd4LmdldFN0b3JhZ2Uoe1xuICAgICAga2V5OiAndXNlcicsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgX3RoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIHVzZXJJbmZvOiByZXMuZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzLmdldFVzZXJJbmZvKCk7XG4gICAgICAgIF90aGlzLmdldFBzeUxpc3QoKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgdGhpcy5nZXRSaWdodENvbmZpZygpO1xuICB9LFxuICBcbiAgLyoqIOiOt+WPluS8muWRmOadg+ebiumFjee9riAqL1xuICBnZXRSaWdodENvbmZpZygpIHtcbiAgICAvLyBBcGkuZ2V0UmlnaHRDb25maWcoKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgIC8vICAgY29uc3QgcmlnaHRDb25maWcgPSByZXN1bHQuZGF0YTtcbiAgICAvLyAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgIC8vICAgICBrZXk6ICdyaWdodENvbmZpZycsXG4gICAgLy8gICAgIGRhdGE6IHJpZ2h0Q29uZmlnLFxuICAgIC8vICAgfSk7XG4gICAgLy8gfSk7XG4gICAgY29uc3QgcmlnaHRDb25maWc6IGFueSA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ+aXoOS8muWRmCcsXG4gICAgICAgIC8vIOaYn+W6p+i/kOWKv1xuICAgICAgICBob3Jvc2NvcGU6IDk5OTk5LFxuICAgICAgICB5ZWFyUHJpY2U6IDAsXG4gICAgICAgIHNlYXNvblByaWNlOiAwLFxuICAgICAgICBtb250aFByaWNlOiAwLFxuICAgICAgICBwc3ljaG9sb2dpY2FsVGVzdDogOTk5OTksXG4gICAgICAgIGNvbnN0ZWxsYXRpb25NYXRjaGluZzogOTk5OTksXG4gICAgICAgIGZhdGVNYXRjaDogMyxcbiAgICAgICAgZmF0ZVdhdGNoOiAyMCxcbiAgICAgICAgZmF0ZUNoYXQ6IDMsXG4gICAgICAgIHdob0xpa2VNZTogMCxcbiAgICAgICAgbGlrZUVhY2g6IDAsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn6buE6ZOc5Lya5ZGYJyxcbiAgICAgICAgeWVhclByaWNlOiAxMjAsXG4gICAgICAgIHNlYXNvblByaWNlOiAzMCxcbiAgICAgICAgbW9udGhQcmljZTogMTAsXG4gICAgICAgIGhvcm9zY29wZTogOTk5OTksXG4gICAgICAgIHBzeWNob2xvZ2ljYWxUZXN0OiA5OTk5OSxcbiAgICAgICAgY29uc3RlbGxhdGlvbk1hdGNoaW5nOiA5OTk5OSxcbiAgICAgICAgZmF0ZU1hdGNoOiA5OTk5OSwgLy8g57yY5YiG5Yy56YWNXG4gICAgICAgIGZhdGVXYXRjaDogOTk5OTksXG4gICAgICAgIGZhdGVDaGF0OiAyMCxcbiAgICAgICAgd2hvTGlrZU1lOiA5OTk5OSxcbiAgICAgICAgbGlrZUVhY2g6IDk5OTk5LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ+eZvemHkeS8muWRmCcsXG4gICAgICAgIHllYXJQcmljZTogMjQwLFxuICAgICAgICBzZWFzb25QcmljZTogNjAsXG4gICAgICAgIG1vbnRoUHJpY2U6IDIwLFxuICAgICAgICBob3Jvc2NvcGU6IDk5OTk5LFxuICAgICAgICBwc3ljaG9sb2dpY2FsVGVzdDogOTk5OTksXG4gICAgICAgIGNvbnN0ZWxsYXRpb25NYXRjaGluZzogOTk5OTksXG4gICAgICAgIGZhdGVNYXRjaDogOTk5OTksXG4gICAgICAgIGZhdGVXYXRjaDogOTk5OTksXG4gICAgICAgIGZhdGVDaGF0OiA5OTk5LFxuICAgICAgICB3aG9MaWtlTWU6IDk5OTk5LFxuICAgICAgICBsaWtlRWFjaDogOTk5OTksXG4gICAgICB9LFxuICAgIF07XG4gICAgd3guc2V0U3RvcmFnZSh7IGtleTogJ3JpZ2h0Q29uZmlnJywgZGF0YTogcmlnaHRDb25maWd9KTtcbiAgfSxcbiAgXG4gIC8qKiDmmJ/luqfov5Dlir8gKi9cbiAgZ29YenlzKCkge1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOiBgLi4veHp5cy94enlzYCxcbiAgICB9KVxuICB9LFxuXG4gIC8qKiDlv4PnkIbmtYvor5XliJfooaggKi9cbiAgZ29YbGNzTGlzdCgpIHtcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDogYC4uL3hsY3NMaXN0L3hsY3NMaXN0YCxcbiAgICB9KTtcbiAgfSxcbiAgXG4gIC8qKiDlv4PnkIbmtYvor5UgKi9cbiAgZG9UZXN0KGU6IGFueSkge1xuICAgIGNvbnN0IHtcbiAgICAgIGlkLFxuICAgICAgdHlwZSxcbiAgICB9ID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQ7XG4gICAgaWYgKHR5cGUgPT09ICczJykge1xuICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgIHVybDogYC4uL3FzcXkvcXNxeT9pZD0ke2lkfWAsXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgIHVybDogYC4uL3hsY3NEZXRhaWwveGxjc0RldGFpbD9pZD0ke2lkfWAsXG4gICAgICB9KVxuICAgIH1cbiAgfSxcblxuICAvKiog5pif5bqn5Yy56YWNICovXG4gIGdvTWF0Y2goKSB7XG4gICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICB1cmw6IGAuLi9tYXRjaGVYei9tYXRjaGVYemAsXG4gICAgfSlcbiAgfSxcblxuICAvKiog6I635Y+W5b+D55CG5rWL6K+VICovXG4gIGdldFBzeUxpc3QoKSB7XG4gICAgQXBpLmdldFBzeUxpc3QoKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgICAgIHBzeVRlc3Q6IHJlc3VsdC5kYXRhLFxuICAgICAgfSlcbiAgICB9KVxuICB9LFxuXG4gIC8qKiDov5Dlir/liIbmnpAgICovXG4gIGdldEhvcm9zY29wZXQoZTogYW55KSB7XG4gICAgY29uc3QgY29uc05hbWUgPSB0aGlzLmRhdGEudXNlckluZm8uY29uc3RlbGxhdGlvbiA/IHRoaXMuZGF0YS51c2VySW5mby5jb25zdGVsbGF0aW9uIDogJ+eZvee+iuW6pyc7XG4gICAgY29uc3QgeyB0eXBlIH0gPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldDtcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDogJy4uL3JlYWxYenlzRGV0YWlsL3JlYWxYenlzRGV0YWlsP2NvbnNOYW1lPScrY29uc05hbWUrJyZ0eXBlPScrdHlwZVxuICAgIH0pXG4gIH0sXG5cbiAgLyoqIOiOt+WPlueUqOaIt+ivpue7huS/oeaBryAqL1xuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB7IG9wZW5pZCB9ID0gdGhpcy5kYXRhLnVzZXJJbmZvO1xuICAgIEFwaS5nZXRVc2VySW5mbyhvcGVuaWQgfHwgJycpLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IHVzZXJJbmZvID0gcmVzdWx0LmRhdGE7XG4gICAgICAgIGFwcC5nbG9iYWxEYXRhLnVzZXJJbmZvID0gcmVzdWx0LmRhdGE7XG4gICAgICAgIHd4LnNldFN0b3JhZ2Uoe1xuICAgICAgICAgIGtleTogJ3VzZXJJbmZvJyxcbiAgICAgICAgICBkYXRhOiBPYmplY3QuYXNzaWduKHtvcGVuaWR9LCByZXN1bHQuZGF0YSksXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgICAgICB1c2VySW5mbyxcbiAgICAgICAgICBwYWdlTG9hZGVkOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICB0b3BJbmZvKCkge1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOiAnLi4vYmFyL2luZGV4J1xuICAgIH0pXG4gIH0sXG5cbiAgb25SZWFkeTogZnVuY3Rpb24gKCkge1xuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouaYvuekulxuICAgKi9cbiAgb25TaG93OiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gaWYgKHRoaXMuZGF0YS5wYWdlTG9hZGVkID09PSB0cnVlKSB7XG4gICAgLy8gICB0aGlzLmdldFVzZXJJbmZvKCk7XG4gICAgLy8gfVxuICAgIGNvbnN0IF90aGlzID0gdGhpcztcbiAgICB3eC5nZXRTdG9yYWdlKHtcbiAgICAgICAga2V5OiAndXNlcicsXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIF90aGlzLnNldERhdGEhKHtcbiAgICAgICAgICAgICAgICB1c2VySW5mbzogcmVzLmRhdGEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICBfdGhpcy5nZXRQc3lMaXN0KCk7XG4gICAgICAgIH0sXG4gICAgfSk7XG4gICAgX3RoaXMuZ2V0UHN5TGlzdCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdoumakOiXj1xuICAgKi9cbiAgb25IaWRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLljbjovb1cbiAgICovXG4gIG9uVW5sb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog5LiL5ouJ5Yi35pawXG4gICAqL1xuICBvblB1bGxEb3duUmVmcmVzaDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgcHVsbERvd246IHRydWUsXG4gICAgICBwdWxsVXA6IGZhbHNlXG4gICAgfSk7XG4gICAgd3guc3RvcFB1bGxEb3duUmVmcmVzaCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcbiAgICovXG4gIG9uUmVhY2hCb3R0b206IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHB1bGxEb3duOiBmYWxzZSxcbiAgICAgIHB1bGxVcDogdHJ1ZVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiDnlKjmiLfngrnlh7vlj7PkuIrop5LliIbkuqtcbiAgICovXG4gIG9uU2hhcmVBcHBNZXNzYWdlOiBmdW5jdGlvbiAob3B0aW9ucz86IFBhZ2UuSVNoYXJlQXBwTWVzc2FnZU9wdGlvbiB8IHVuZGVmaW5lZCk6IFBhZ2UuSUN1c3RvbVNoYXJlQ29udGVudCB7XG4gICAgY29uc29sZS5sb2coJ29uU2hhcmVBcHBNZXNzYWdlIG9wdGlvbnMnLCBvcHRpb25zKTtcbiAgICByZXR1cm4ge307XG4gIH1cbn0pIl19