"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Api = require("../../service/api.service");
const utils_1 = require("../../utils/utils");
Page({
    data: {
        openid: '',
        userInfo: {},
        message: '',
        messageList: [],
    },
    onLoad: function () {
        this.getUserInfo();
        this.getMessageList();
    },
    getOpenid() {
        let openid = '';
        const user = wx.getStorageSync('user');
        openid = user.openid || '';
        return openid;
    },
    getUserInfo() {
        const openid = this.getOpenid();
        Api.getUserInfo(openid).then((result) => {
            if (result) {
                const userInfo = result.data;
                console.log('userInfo:', userInfo);
                this.setData({
                    userInfo
                });
            }
            else {
                throw new Error("获取用户信息失败");
            }
        });
    },
    sendTap() {
        console.log('send message:', this.data.message);
    },
    inputTap(e) {
        console.log('input message:', e);
        this.setData({
            message: e.detail.detail.value
        });
    },
    getMessageList() {
        const messageList = [
            {
                "_id": "5f66e2f82735248c31b97bd8",
                "type": 1,
                "cid": "5f66e025bb97350949c52a97",
                "msg": "hello lisa",
                "status": [
                    {
                        "msgUnRead": false,
                        "_id": "5f66e2f82735248c31b97bda",
                        "openid": "oHgB55LJ1wGo2QqEYxgo8tLMxL4A"
                    },
                    {
                        "msgUnRead": true,
                        "_id": "5f66e2f82735248c31b97bd9",
                        "openid": "oHgB55AlhKqR7azr85YYBwfIE9EQ"
                    }
                ],
                "from": "oHgB55LJ1wGo2QqEYxgo8tLMxL4A",
                "updatedAt": "2020-09-20T05:04:56.688Z",
                "createdAt": "2020-09-20T05:04:56.688Z"
            },
            {
                "_id": "5f66e2f82735248c31b97bd8",
                "type": 1,
                "cid": "5f66e025bb97350949c52a97",
                "msg": "吃饭了吗",
                "status": [
                    {
                        "msgUnRead": false,
                        "_id": "5f66e2f82735248c31b97bda",
                        "openid": "oHgB55LJ1wGo2QqEYxgo8tLMxL4A"
                    },
                    {
                        "msgUnRead": true,
                        "_id": "5f66e2f82735248c31b97bd9",
                        "openid": "oHgB55AlhKqR7azr85YYBwfIE9EQ"
                    }
                ],
                "from": "oHgB55AlhKqR7azr85YYBwfIE9EQ",
                "updatedAt": "2020-09-20T05:04:56.688Z",
                "createdAt": "2020-09-20T05:04:56.688Z"
            },
        ];
        const dateAry = [];
        messageList.map((item) => {
            const date = utils_1.getDate(item.createdAt);
            if (dateAry.indexOf(date) == -1) {
                item.date = date;
                dateAry.push(date);
            }
            else {
                item.date = '';
            }
            item.time = utils_1.getTime(item.createdAt);
            return item;
        });
        this.setData({
            messageList,
        });
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNoYXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBaUQ7QUFDakQsNkNBQXFEO0FBRXJELElBQUksQ0FBQztJQUVILElBQUksRUFBRTtRQUNKLE1BQU0sRUFBRSxFQUFFO1FBQ1YsUUFBUSxFQUFFLEVBQUU7UUFDWixPQUFPLEVBQUUsRUFBRTtRQUNYLFdBQVcsRUFBRSxFQUFFO0tBQ2hCO0lBRUQsTUFBTSxFQUFFO1FBQ04sSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ25CLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBRUQsU0FBUztRQUNQLElBQUksTUFBTSxHQUFXLEVBQUUsQ0FBQztRQUN4QixNQUFNLElBQUksR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQztRQUMzQixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUQsV0FBVztRQUNULE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNoQyxHQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQVcsRUFBRSxFQUFFO1lBQzNDLElBQUksTUFBTSxFQUFFO2dCQUNWLE1BQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQzdCLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxDQUFBO2dCQUNsQyxJQUFJLENBQUMsT0FBUSxDQUFDO29CQUNaLFFBQVE7aUJBQ1QsQ0FBQyxDQUFDO2FBQ0o7aUJBQU07Z0JBQ0wsTUFBTSxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQzthQUM3QjtRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUdELE9BQU87UUFFTCxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFHRCxRQUFRLENBQUMsQ0FBTTtRQUNiLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDakMsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLE9BQU8sRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLO1NBQy9CLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxjQUFjO1FBQ1osTUFBTSxXQUFXLEdBQVE7WUFDdkI7Z0JBQ0UsS0FBSyxFQUFFLDBCQUEwQjtnQkFDakMsTUFBTSxFQUFFLENBQUM7Z0JBQ1QsS0FBSyxFQUFFLDBCQUEwQjtnQkFDakMsS0FBSyxFQUFFLFlBQVk7Z0JBQ25CLFFBQVEsRUFBRTtvQkFDUjt3QkFDRSxXQUFXLEVBQUUsS0FBSzt3QkFDbEIsS0FBSyxFQUFFLDBCQUEwQjt3QkFDakMsUUFBUSxFQUFFLDhCQUE4QjtxQkFDekM7b0JBQ0Q7d0JBQ0UsV0FBVyxFQUFFLElBQUk7d0JBQ2pCLEtBQUssRUFBRSwwQkFBMEI7d0JBQ2pDLFFBQVEsRUFBRSw4QkFBOEI7cUJBQ3pDO2lCQUNGO2dCQUNELE1BQU0sRUFBRSw4QkFBOEI7Z0JBQ3RDLFdBQVcsRUFBRSwwQkFBMEI7Z0JBQ3ZDLFdBQVcsRUFBRSwwQkFBMEI7YUFDeEM7WUFDRDtnQkFDRSxLQUFLLEVBQUUsMEJBQTBCO2dCQUNqQyxNQUFNLEVBQUUsQ0FBQztnQkFDVCxLQUFLLEVBQUUsMEJBQTBCO2dCQUNqQyxLQUFLLEVBQUUsTUFBTTtnQkFDYixRQUFRLEVBQUU7b0JBQ1I7d0JBQ0UsV0FBVyxFQUFFLEtBQUs7d0JBQ2xCLEtBQUssRUFBRSwwQkFBMEI7d0JBQ2pDLFFBQVEsRUFBRSw4QkFBOEI7cUJBQ3pDO29CQUNEO3dCQUNFLFdBQVcsRUFBRSxJQUFJO3dCQUNqQixLQUFLLEVBQUUsMEJBQTBCO3dCQUNqQyxRQUFRLEVBQUUsOEJBQThCO3FCQUN6QztpQkFDRjtnQkFDRCxNQUFNLEVBQUUsOEJBQThCO2dCQUN0QyxXQUFXLEVBQUUsMEJBQTBCO2dCQUN2QyxXQUFXLEVBQUUsMEJBQTBCO2FBQ3hDO1NBQ0YsQ0FBQztRQUNGLE1BQU0sT0FBTyxHQUFVLEVBQUUsQ0FBQztRQUMxQixXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBUyxFQUFFLEVBQUU7WUFDNUIsTUFBTSxJQUFJLEdBQUcsZUFBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNyQyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUU7Z0JBQy9CLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO2dCQUNqQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ3BCO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO2FBQ2hCO1lBQ0QsSUFBSSxDQUFDLElBQUksR0FBRyxlQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3BDLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osV0FBVztTQUNaLENBQUMsQ0FBQztJQUNMLENBQUM7SUFLRCxPQUFPLEVBQUU7SUFFVCxDQUFDO0lBS0QsTUFBTSxFQUFFO0lBRVIsQ0FBQztJQUtELE1BQU0sRUFBRTtJQUVSLENBQUM7SUFLRCxRQUFRLEVBQUU7SUFFVixDQUFDO0lBS0QsaUJBQWlCLEVBQUU7SUFFbkIsQ0FBQztJQUtELGFBQWEsRUFBRTtJQUVmLENBQUM7Q0FDRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBBcGkgZnJvbSAnLi4vLi4vc2VydmljZS9hcGkuc2VydmljZSc7XG5pbXBvcnQgeyBnZXREYXRlLCBnZXRUaW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG5QYWdlKHtcblxuICBkYXRhOiB7XG4gICAgb3BlbmlkOiAnJyxcbiAgICB1c2VySW5mbzoge30sIC8vIOeUqOaIt+S/oeaBr1xuICAgIG1lc3NhZ2U6ICcnLCAgLy8g55So5oi36L6T5YWl55qE5raI5oGvXG4gICAgbWVzc2FnZUxpc3Q6IFtdLFxuICB9LFxuXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ2V0VXNlckluZm8oKTtcbiAgICB0aGlzLmdldE1lc3NhZ2VMaXN0KCk7XG4gIH0sXG5cbiAgZ2V0T3BlbmlkKCkge1xuICAgIGxldCBvcGVuaWQ6IHN0cmluZyA9ICcnO1xuICAgIGNvbnN0IHVzZXIgPSB3eC5nZXRTdG9yYWdlU3luYygndXNlcicpO1xuICAgIG9wZW5pZCA9IHVzZXIub3BlbmlkIHx8ICcnO1xuICAgIHJldHVybiBvcGVuaWQ7XG4gIH0sXG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3Qgb3BlbmlkID0gdGhpcy5nZXRPcGVuaWQoKTtcbiAgICBBcGkuZ2V0VXNlckluZm8ob3BlbmlkKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBjb25zdCB1c2VySW5mbyA9IHJlc3VsdC5kYXRhO1xuICAgICAgICBjb25zb2xlLmxvZygndXNlckluZm86JywgdXNlckluZm8pXG4gICAgICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgIHVzZXJJbmZvXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwi6I635Y+W55So5oi35L+h5oGv5aSx6LSlXCIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKiDlj5HpgIHmtojmga/kuovku7YgKi9cbiAgc2VuZFRhcCgpIHtcbiAgICAvLyBUT0RPXG4gICAgY29uc29sZS5sb2coJ3NlbmQgbWVzc2FnZTonLCB0aGlzLmRhdGEubWVzc2FnZSk7XG4gIH0sXG5cbiAgLyoqIOi+k+WFpea2iOaBr+WGheWuuSAqL1xuICBpbnB1dFRhcChlOiBhbnkpIHtcbiAgICBjb25zb2xlLmxvZygnaW5wdXQgbWVzc2FnZTonLCBlKTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIG1lc3NhZ2U6IGUuZGV0YWlsLmRldGFpbC52YWx1ZSAvLyDojrflj5bovpPlhaXnmoTlgLxcbiAgICB9KVxuICB9LFxuXG4gIGdldE1lc3NhZ2VMaXN0KCkge1xuICAgIGNvbnN0IG1lc3NhZ2VMaXN0OiBhbnkgPSBbXG4gICAgICB7XG4gICAgICAgIFwiX2lkXCI6IFwiNWY2NmUyZjgyNzM1MjQ4YzMxYjk3YmQ4XCIsXG4gICAgICAgIFwidHlwZVwiOiAxLFxuICAgICAgICBcImNpZFwiOiBcIjVmNjZlMDI1YmI5NzM1MDk0OWM1MmE5N1wiLFxuICAgICAgICBcIm1zZ1wiOiBcImhlbGxvIGxpc2FcIixcbiAgICAgICAgXCJzdGF0dXNcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwibXNnVW5SZWFkXCI6IGZhbHNlLFxuICAgICAgICAgICAgXCJfaWRcIjogXCI1ZjY2ZTJmODI3MzUyNDhjMzFiOTdiZGFcIixcbiAgICAgICAgICAgIFwib3BlbmlkXCI6IFwib0hnQjU1TEoxd0dvMlFxRVl4Z284dExNeEw0QVwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBcIm1zZ1VuUmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgXCJfaWRcIjogXCI1ZjY2ZTJmODI3MzUyNDhjMzFiOTdiZDlcIixcbiAgICAgICAgICAgIFwib3BlbmlkXCI6IFwib0hnQjU1QWxoS3FSN2F6cjg1WVlCd2ZJRTlFUVwiXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcImZyb21cIjogXCJvSGdCNTVMSjF3R28yUXFFWXhnbzh0TE14TDRBXCIsXG4gICAgICAgIFwidXBkYXRlZEF0XCI6IFwiMjAyMC0wOS0yMFQwNTowNDo1Ni42ODhaXCIsXG4gICAgICAgIFwiY3JlYXRlZEF0XCI6IFwiMjAyMC0wOS0yMFQwNTowNDo1Ni42ODhaXCJcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIFwiX2lkXCI6IFwiNWY2NmUyZjgyNzM1MjQ4YzMxYjk3YmQ4XCIsXG4gICAgICAgIFwidHlwZVwiOiAxLFxuICAgICAgICBcImNpZFwiOiBcIjVmNjZlMDI1YmI5NzM1MDk0OWM1MmE5N1wiLFxuICAgICAgICBcIm1zZ1wiOiBcIuWQg+mlreS6huWQl1wiLFxuICAgICAgICBcInN0YXR1c1wiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJtc2dVblJlYWRcIjogZmFsc2UsXG4gICAgICAgICAgICBcIl9pZFwiOiBcIjVmNjZlMmY4MjczNTI0OGMzMWI5N2JkYVwiLFxuICAgICAgICAgICAgXCJvcGVuaWRcIjogXCJvSGdCNTVMSjF3R28yUXFFWXhnbzh0TE14TDRBXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwibXNnVW5SZWFkXCI6IHRydWUsXG4gICAgICAgICAgICBcIl9pZFwiOiBcIjVmNjZlMmY4MjczNTI0OGMzMWI5N2JkOVwiLFxuICAgICAgICAgICAgXCJvcGVuaWRcIjogXCJvSGdCNTVBbGhLcVI3YXpyODVZWUJ3ZklFOUVRXCJcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiZnJvbVwiOiBcIm9IZ0I1NUFsaEtxUjdhenI4NVlZQndmSUU5RVFcIixcbiAgICAgICAgXCJ1cGRhdGVkQXRcIjogXCIyMDIwLTA5LTIwVDA1OjA0OjU2LjY4OFpcIixcbiAgICAgICAgXCJjcmVhdGVkQXRcIjogXCIyMDIwLTA5LTIwVDA1OjA0OjU2LjY4OFpcIlxuICAgICAgfSxcbiAgICBdO1xuICAgIGNvbnN0IGRhdGVBcnk6IGFueVtdID0gW107XG4gICAgbWVzc2FnZUxpc3QubWFwKChpdGVtOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IGRhdGUgPSBnZXREYXRlKGl0ZW0uY3JlYXRlZEF0KTtcbiAgICAgIGlmIChkYXRlQXJ5LmluZGV4T2YoZGF0ZSkgPT0gLTEpIHtcbiAgICAgICAgaXRlbS5kYXRlID0gZGF0ZTtcbiAgICAgICAgZGF0ZUFyeS5wdXNoKGRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaXRlbS5kYXRlID0gJyc7XG4gICAgICB9XG4gICAgICBpdGVtLnRpbWUgPSBnZXRUaW1lKGl0ZW0uY3JlYXRlZEF0KTtcbiAgICAgIHJldHVybiBpdGVtO1xuICAgIH0pO1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgbWVzc2FnZUxpc3QsXG4gICAgfSk7XG4gIH0sXG4gIFxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLliJ3mrKHmuLLmn5PlrozmiJBcbiAgICovXG4gIG9uUmVhZHk6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouaYvuekulxuICAgKi9cbiAgb25TaG93OiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLpmpDol49cbiAgICovXG4gIG9uSGlkZTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Y246L29XG4gICAqL1xuICBvblVubG9hZDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOmhtemdouebuOWFs+S6i+S7tuWkhOeQhuWHveaVsC0t55uR5ZCs55So5oi35LiL5ouJ5Yqo5L2cXG4gICAqL1xuICBvblB1bGxEb3duUmVmcmVzaDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOmhtemdouS4iuaLieinpuW6leS6i+S7tueahOWkhOeQhuWHveaVsFxuICAgKi9cbiAgb25SZWFjaEJvdHRvbTogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG59KSJdfQ==