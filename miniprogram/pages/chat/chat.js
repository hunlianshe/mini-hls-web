"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const socket_service2_1 = require("../../service/socket.service2");
const utils_1 = require("../../utils/utils");
Page({
    data: {
        openid: '',
        userInfo: {},
        message: '',
        messageList: [],
    },
    onLoad: function () {
        this.getMessageList();
        this.receiveMessage();
    },
    getOpenid() {
        let openid = '';
        const user = wx.getStorageSync('user');
        openid = user.openid || '';
        return openid;
    },
    receiveMessage() {
        console.log("准备接收消息");
        let socket = socket_service2_1.getSocket();
        socket.on("privateChat", (msg) => {
            console.log("接收到的消息是", msg);
        });
    },
    getUserInfo() {
    },
    sendTap() {
        socket_service2_1.sendMessage({ cid: "oHgB55AlhKqR7azr85YYBwfIE9EQ", msg: this.data.message, type: 1 });
        console.log('send message:', this.data.message);
    },
    inputTap(e) {
        console.log('input message:', e);
        this.setData({
            message: e.detail.detail.value
        });
    },
    getMessageList() {
        const messageList = [
            {
                "_id": "5f66e2f82735248c31b97bd8",
                "type": 1,
                "cid": "5f66e025bb97350949c52a97",
                "msg": "hello lisa",
                "status": [
                    {
                        "msgUnRead": false,
                        "_id": "5f66e2f82735248c31b97bda",
                        "openid": "oHgB55LJ1wGo2QqEYxgo8tLMxL4A"
                    },
                    {
                        "msgUnRead": true,
                        "_id": "5f66e2f82735248c31b97bd9",
                        "openid": "oHgB55AlhKqR7azr85YYBwfIE9EQ"
                    }
                ],
                "from": "oHgB55LJ1wGo2QqEYxgo8tLMxL4A",
                "updatedAt": "2020-09-20T05:04:56.688Z",
                "createdAt": "2020-09-20T05:04:56.688Z"
            },
            {
                "_id": "5f66e2f82735248c31b97bd8",
                "type": 1,
                "cid": "5f66e025bb97350949c52a97",
                "msg": "吃饭了吗",
                "status": [
                    {
                        "msgUnRead": false,
                        "_id": "5f66e2f82735248c31b97bda",
                        "openid": "oHgB55LJ1wGo2QqEYxgo8tLMxL4A"
                    },
                    {
                        "msgUnRead": true,
                        "_id": "5f66e2f82735248c31b97bd9",
                        "openid": "oHgB55AlhKqR7azr85YYBwfIE9EQ"
                    }
                ],
                "from": "oHgB55AlhKqR7azr85YYBwfIE9EQ",
                "updatedAt": "2020-09-20T05:04:56.688Z",
                "createdAt": "2020-09-20T05:04:56.688Z"
            },
        ];
        const dateAry = [];
        messageList.map((item) => {
            const date = utils_1.getDate(item.createdAt);
            if (dateAry.indexOf(date) == -1) {
                item.date = date;
                dateAry.push(date);
            }
            else {
                item.date = '';
            }
            item.time = utils_1.getTime(item.createdAt);
            return item;
        });
        this.setData({
            messageList,
        });
    },
    onReady: function () {
    },
    onShow: function () {
    },
    onHide: function () {
    },
    onUnload: function () {
    },
    onPullDownRefresh: function () {
    },
    onReachBottom: function () {
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNoYXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtRUFBc0U7QUFDdEUsNkNBQXFEO0FBRXJELElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLE1BQU0sRUFBRSxFQUFFO1FBQ1YsUUFBUSxFQUFFLEVBQUU7UUFDWixPQUFPLEVBQUUsRUFBRTtRQUNYLFdBQVcsRUFBRSxFQUFFO0tBQ2hCO0lBRUQsTUFBTSxFQUFFO1FBRU4sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUd4QixDQUFDO0lBRUQsU0FBUztRQUNQLElBQUksTUFBTSxHQUFXLEVBQUUsQ0FBQztRQUN4QixNQUFNLElBQUksR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQztRQUMzQixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUQsY0FBYztRQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUE7UUFDdEIsSUFBSSxNQUFNLEdBQUcsMkJBQVMsRUFBRSxDQUFBO1FBQ3hCLE1BQU0sQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLENBQUMsR0FBTyxFQUFFLEVBQUU7WUFDbkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUMsR0FBRyxDQUFDLENBQUE7UUFDNUIsQ0FBQyxDQUFDLENBQUE7SUFFSCxDQUFDO0lBRUQsV0FBVztJQWFYLENBQUM7SUFHRCxPQUFPO1FBR0wsNkJBQVcsQ0FBQyxFQUFDLEdBQUcsRUFBRSw4QkFBOEIsRUFBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUE7UUFDbEYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBR0QsUUFBUSxDQUFDLENBQU07UUFDYixPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixPQUFPLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSztTQUMvQixDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsY0FBYztRQUNaLE1BQU0sV0FBVyxHQUFRO1lBQ3ZCO2dCQUNFLEtBQUssRUFBRSwwQkFBMEI7Z0JBQ2pDLE1BQU0sRUFBRSxDQUFDO2dCQUNULEtBQUssRUFBRSwwQkFBMEI7Z0JBQ2pDLEtBQUssRUFBRSxZQUFZO2dCQUNuQixRQUFRLEVBQUU7b0JBQ1I7d0JBQ0UsV0FBVyxFQUFFLEtBQUs7d0JBQ2xCLEtBQUssRUFBRSwwQkFBMEI7d0JBQ2pDLFFBQVEsRUFBRSw4QkFBOEI7cUJBQ3pDO29CQUNEO3dCQUNFLFdBQVcsRUFBRSxJQUFJO3dCQUNqQixLQUFLLEVBQUUsMEJBQTBCO3dCQUNqQyxRQUFRLEVBQUUsOEJBQThCO3FCQUN6QztpQkFDRjtnQkFDRCxNQUFNLEVBQUUsOEJBQThCO2dCQUN0QyxXQUFXLEVBQUUsMEJBQTBCO2dCQUN2QyxXQUFXLEVBQUUsMEJBQTBCO2FBQ3hDO1lBQ0Q7Z0JBQ0UsS0FBSyxFQUFFLDBCQUEwQjtnQkFDakMsTUFBTSxFQUFFLENBQUM7Z0JBQ1QsS0FBSyxFQUFFLDBCQUEwQjtnQkFDakMsS0FBSyxFQUFFLE1BQU07Z0JBQ2IsUUFBUSxFQUFFO29CQUNSO3dCQUNFLFdBQVcsRUFBRSxLQUFLO3dCQUNsQixLQUFLLEVBQUUsMEJBQTBCO3dCQUNqQyxRQUFRLEVBQUUsOEJBQThCO3FCQUN6QztvQkFDRDt3QkFDRSxXQUFXLEVBQUUsSUFBSTt3QkFDakIsS0FBSyxFQUFFLDBCQUEwQjt3QkFDakMsUUFBUSxFQUFFLDhCQUE4QjtxQkFDekM7aUJBQ0Y7Z0JBQ0QsTUFBTSxFQUFFLDhCQUE4QjtnQkFDdEMsV0FBVyxFQUFFLDBCQUEwQjtnQkFDdkMsV0FBVyxFQUFFLDBCQUEwQjthQUN4QztTQUNGLENBQUM7UUFDRixNQUFNLE9BQU8sR0FBVSxFQUFFLENBQUM7UUFDMUIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQVMsRUFBRSxFQUFFO1lBQzVCLE1BQU0sSUFBSSxHQUFHLGVBQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDckMsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFO2dCQUMvQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztnQkFDakIsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNwQjtpQkFBTTtnQkFDTCxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQzthQUNoQjtZQUNELElBQUksQ0FBQyxJQUFJLEdBQUcsZUFBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNwQyxPQUFPLElBQUksQ0FBQztRQUNkLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLFdBQVc7U0FDWixDQUFDLENBQUM7SUFDTCxDQUFDO0lBS0QsT0FBTyxFQUFFO0lBRVQsQ0FBQztJQUtELE1BQU0sRUFBRTtJQUVSLENBQUM7SUFLRCxNQUFNLEVBQUU7SUFFUixDQUFDO0lBS0QsUUFBUSxFQUFFO0lBRVYsQ0FBQztJQUtELGlCQUFpQixFQUFFO0lBRW5CLENBQUM7SUFLRCxhQUFhLEVBQUU7SUFFZixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtnZXRTb2NrZXQsIHNlbmRNZXNzYWdlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2NrZXQuc2VydmljZTInO1xuaW1wb3J0IHsgZ2V0RGF0ZSwgZ2V0VGltZSB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBvcGVuaWQ6ICcnLFxuICAgIHVzZXJJbmZvOiB7fSwgLy8g55So5oi35L+h5oGvXG4gICAgbWVzc2FnZTogJycsICAvLyDnlKjmiLfovpPlhaXnmoTmtojmga9cbiAgICBtZXNzYWdlTGlzdDogW10sXG4gIH0sXG5cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gdGhpcy5nZXRVc2VySW5mbygpO1xuICAgIHRoaXMuZ2V0TWVzc2FnZUxpc3QoKTtcbiAgICB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgXG5cbiAgfSxcblxuICBnZXRPcGVuaWQoKSB7XG4gICAgbGV0IG9wZW5pZDogc3RyaW5nID0gJyc7XG4gICAgY29uc3QgdXNlciA9IHd4LmdldFN0b3JhZ2VTeW5jKCd1c2VyJyk7XG4gICAgb3BlbmlkID0gdXNlci5vcGVuaWQgfHwgJyc7XG4gICAgcmV0dXJuIG9wZW5pZDtcbiAgfSxcblxuICByZWNlaXZlTWVzc2FnZSgpIHtcbiAgICBjb25zb2xlLmxvZyhcIuWHhuWkh+aOpeaUtua2iOaBr1wiKVxuICAgbGV0IHNvY2tldCA9IGdldFNvY2tldCgpXG4gICBzb2NrZXQub24oXCJwcml2YXRlQ2hhdFwiLCAobXNnOmFueSkgPT4ge1xuICAgICBjb25zb2xlLmxvZyhcIuaOpeaUtuWIsOeahOa2iOaBr+aYr1wiLG1zZylcbiAgIH0pXG5cbiAgfSxcblxuICBnZXRVc2VySW5mbygpIHtcbiAgICAvLyBjb25zdCBvcGVuaWQgPSB0aGlzLmdldE9wZW5pZCgpO1xuICAgIC8vIEFwaS5nZXRVc2VySW5mbyhvcGVuaWQpLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgLy8gICBpZiAocmVzdWx0KSB7XG4gICAgLy8gICAgIGNvbnN0IHVzZXJJbmZvID0gcmVzdWx0LmRhdGE7XG4gICAgLy8gICAgIGNvbnNvbGUubG9nKCd1c2VySW5mbzonLCB1c2VySW5mbylcbiAgICAvLyAgICAgdGhpcy5zZXREYXRhISh7XG4gICAgLy8gICAgICAgdXNlckluZm9cbiAgICAvLyAgICAgfSk7XG4gICAgLy8gICB9IGVsc2Uge1xuICAgIC8vICAgICB0aHJvdyBuZXcgRXJyb3IoXCLojrflj5bnlKjmiLfkv6Hmga/lpLHotKVcIik7XG4gICAgLy8gICB9XG4gICAgLy8gfSk7XG4gIH0sXG5cbiAgLyoqIOWPkemAgea2iOaBr+S6i+S7tiAqL1xuICBzZW5kVGFwKCkge1xuICAgIC8vIFRPRE9cbiAgICAvLyB0byBkb1xuICAgIHNlbmRNZXNzYWdlKHtjaWQ6IFwib0hnQjU1QWxoS3FSN2F6cjg1WVlCd2ZJRTlFUVwiLG1zZzogdGhpcy5kYXRhLm1lc3NhZ2UsIHR5cGU6IDF9KVxuICAgIGNvbnNvbGUubG9nKCdzZW5kIG1lc3NhZ2U6JywgdGhpcy5kYXRhLm1lc3NhZ2UpO1xuICB9LFxuXG4gIC8qKiDovpPlhaXmtojmga/lhoXlrrkgKi9cbiAgaW5wdXRUYXAoZTogYW55KSB7XG4gICAgY29uc29sZS5sb2coJ2lucHV0IG1lc3NhZ2U6JywgZSk7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBtZXNzYWdlOiBlLmRldGFpbC5kZXRhaWwudmFsdWUgLy8g6I635Y+W6L6T5YWl55qE5YC8XG4gICAgfSlcbiAgfSxcblxuICBnZXRNZXNzYWdlTGlzdCgpIHtcbiAgICBjb25zdCBtZXNzYWdlTGlzdDogYW55ID0gW1xuICAgICAge1xuICAgICAgICBcIl9pZFwiOiBcIjVmNjZlMmY4MjczNTI0OGMzMWI5N2JkOFwiLFxuICAgICAgICBcInR5cGVcIjogMSxcbiAgICAgICAgXCJjaWRcIjogXCI1ZjY2ZTAyNWJiOTczNTA5NDljNTJhOTdcIixcbiAgICAgICAgXCJtc2dcIjogXCJoZWxsbyBsaXNhXCIsXG4gICAgICAgIFwic3RhdHVzXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBcIm1zZ1VuUmVhZFwiOiBmYWxzZSxcbiAgICAgICAgICAgIFwiX2lkXCI6IFwiNWY2NmUyZjgyNzM1MjQ4YzMxYjk3YmRhXCIsXG4gICAgICAgICAgICBcIm9wZW5pZFwiOiBcIm9IZ0I1NUxKMXdHbzJRcUVZeGdvOHRMTXhMNEFcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJtc2dVblJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgIFwiX2lkXCI6IFwiNWY2NmUyZjgyNzM1MjQ4YzMxYjk3YmQ5XCIsXG4gICAgICAgICAgICBcIm9wZW5pZFwiOiBcIm9IZ0I1NUFsaEtxUjdhenI4NVlZQndmSUU5RVFcIlxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJmcm9tXCI6IFwib0hnQjU1TEoxd0dvMlFxRVl4Z284dExNeEw0QVwiLFxuICAgICAgICBcInVwZGF0ZWRBdFwiOiBcIjIwMjAtMDktMjBUMDU6MDQ6NTYuNjg4WlwiLFxuICAgICAgICBcImNyZWF0ZWRBdFwiOiBcIjIwMjAtMDktMjBUMDU6MDQ6NTYuNjg4WlwiXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBcIl9pZFwiOiBcIjVmNjZlMmY4MjczNTI0OGMzMWI5N2JkOFwiLFxuICAgICAgICBcInR5cGVcIjogMSxcbiAgICAgICAgXCJjaWRcIjogXCI1ZjY2ZTAyNWJiOTczNTA5NDljNTJhOTdcIixcbiAgICAgICAgXCJtc2dcIjogXCLlkIPppa3kuoblkJdcIixcbiAgICAgICAgXCJzdGF0dXNcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwibXNnVW5SZWFkXCI6IGZhbHNlLFxuICAgICAgICAgICAgXCJfaWRcIjogXCI1ZjY2ZTJmODI3MzUyNDhjMzFiOTdiZGFcIixcbiAgICAgICAgICAgIFwib3BlbmlkXCI6IFwib0hnQjU1TEoxd0dvMlFxRVl4Z284dExNeEw0QVwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBcIm1zZ1VuUmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgXCJfaWRcIjogXCI1ZjY2ZTJmODI3MzUyNDhjMzFiOTdiZDlcIixcbiAgICAgICAgICAgIFwib3BlbmlkXCI6IFwib0hnQjU1QWxoS3FSN2F6cjg1WVlCd2ZJRTlFUVwiXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcImZyb21cIjogXCJvSGdCNTVBbGhLcVI3YXpyODVZWUJ3ZklFOUVRXCIsXG4gICAgICAgIFwidXBkYXRlZEF0XCI6IFwiMjAyMC0wOS0yMFQwNTowNDo1Ni42ODhaXCIsXG4gICAgICAgIFwiY3JlYXRlZEF0XCI6IFwiMjAyMC0wOS0yMFQwNTowNDo1Ni42ODhaXCJcbiAgICAgIH0sXG4gICAgXTtcbiAgICBjb25zdCBkYXRlQXJ5OiBhbnlbXSA9IFtdO1xuICAgIG1lc3NhZ2VMaXN0Lm1hcCgoaXRlbTogYW55KSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gZ2V0RGF0ZShpdGVtLmNyZWF0ZWRBdCk7XG4gICAgICBpZiAoZGF0ZUFyeS5pbmRleE9mKGRhdGUpID09IC0xKSB7XG4gICAgICAgIGl0ZW0uZGF0ZSA9IGRhdGU7XG4gICAgICAgIGRhdGVBcnkucHVzaChkYXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW0uZGF0ZSA9ICcnO1xuICAgICAgfVxuICAgICAgaXRlbS50aW1lID0gZ2V0VGltZShpdGVtLmNyZWF0ZWRBdCk7XG4gICAgICByZXR1cm4gaXRlbTtcbiAgICB9KTtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIG1lc3NhZ2VMaXN0LFxuICAgIH0pO1xuICB9LFxuICBcbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yid5qyh5riy5p+T5a6M5oiQXG4gICAqL1xuICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICAvKipcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLmmL7npLpcbiAgICovXG4gIG9uU2hvdzogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgLyoqXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i6ZqQ6JePXG4gICAqL1xuICBvbkhpZGU6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdouWNuOi9vVxuICAgKi9cbiAgb25VbmxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLnm7jlhbPkuovku7blpITnkIblh73mlbAtLeebkeWQrOeUqOaIt+S4i+aLieWKqOS9nFxuICAgKi9cbiAgb25QdWxsRG93blJlZnJlc2g6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIC8qKlxuICAgKiDpobXpnaLkuIrmi4nop6blupXkuovku7bnmoTlpITnkIblh73mlbBcbiAgICovXG4gIG9uUmVhY2hCb3R0b206IGZ1bmN0aW9uICgpIHtcblxuICB9LFxufSkiXX0=